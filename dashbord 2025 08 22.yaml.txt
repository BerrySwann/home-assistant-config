streamline_templates:
  pm25:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      graph_span: 24h
      cache: true
      span:
        offset: +3m
      apex_config:
        chart:
          height: 300px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: Air Quality P.M. 2.5
        show_states: true
        colorize_states: true
      yaxis:
        - id: pm25
          min: ~0
          max: auto
          opposite: false
          decimals: 0
          apex_config:
            tickAmount: 4
      all_series_config:
        group_by:
          func: last
          duration: 1s
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
        apex_config: null
      series:
        - entity: '[[entity_sensor]]'
          name: P.M. 2.5
          yaxis_id: pm25
          color: green
          type: area
          fill_raw: last
          stroke_width: 2
          color_threshold:
            - value: 0
              color: green
            - value: 35
              color: orange
            - value: 120
              color: red
        - entity: '[[entity_sensor]]'
          yaxis_id: pm2.5
          type: line
          stroke_dash: 8
          color: red
          stroke_width: 2
          name: Avg(24hrs)
          group_by:
            func: avg
            duration: 24h
        - entity: '[[entity_sensor]]'
          color: green
          stroke_width: 2
          group_by:
            func: raw
            duration: 24h
          float_precision: 0
          show:
            in_brush: true
            in_chart: false
      card_mod:
        style: |
          ha-card {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
  cov:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      graph_span: 24h
      cache: true
      span:
        offset: +3m
      apex_config:
        chart:
          height: 300px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: Air Quality C.O.V.
        show_states: true
        colorize_states: true
      yaxis:
        - id: y_id
          min: ~0
          max: auto
          opposite: false
          decimals: 0
          apex_config:
            tickAmount: 4
      all_series_config:
        group_by:
          func: last
          duration: 1s
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
        apex_config: null
      series:
        - entity: '[[entity_sensor]]'
          name: Composés Organiques Volatils
          yaxis_id: y_id
          unit: '  PPB'
          color: green
          type: area
          fill_raw: last
          stroke_width: 2
          color_threshold:
            - value: 0
              color: green
            - value: 300
              color: orange
            - value: 750
              color: red
        - entity: '[[entity_sensor]]'
          yaxis_id: cov
          unit: '  PPB'
          type: line
          stroke_dash: 8
          color: red
          stroke_width: 2
          name: Avg(24hrs)
          group_by:
            func: avg
            duration: 24h
        - entity: '[[entity_sensor]]'
          color: green
          stroke_width: 2
          group_by:
            func: raw
            duration: 24h
          float_precision: 0
          show:
            in_brush: true
            in_chart: false
      card_mod:
        style: |
          ha-card {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
  temperature_humidite:
    card:
      type: custom:mod-card
      card_mod:
        style: |
          ha-card {
            background: transparent;
            box-shadow: transparent;
            border: transparent;
          }
      card:
        type: vertical-stack
        cards:
          - type: custom:apexcharts-card
            chart_type: radialBar
            series:
              - entity: '[[humidity_entity]]'
                max: 100
                color: rgb(19, 160, 255)
              - entity: '[[temperature_entity]]'
                max: 40
                color: '#ff9800'
            apex_config:
              plotOptions:
                radialBar:
                  hollow:
                    size: 40%
                    dropShadow:
                      enabled: true
                      top: 4
                      left: 0
                      blur: 4
                      opacity: 0.24
                  dataLabels:
                    name:
                      show: false
                    value:
                      show: false
                  track:
                    strokeWidth: 100%
                    margin: 10
              fill:
                type: gradient
              colors:
                - rgb(19, 160, 255)
                - '#ff9800'
              gradient:
                shadeIntensity: 1
                type: vertical
                opacityFrom: 1
                opacityTo: 0
                stops:
                  - offset: 0
                    color: rgb(19, 160, 255)
                    opacity: 1
                  - offset: 50
                    color: rgb(10, 80, 200)
                    opacity: 1
                  - offset: 100
                    color: '#ff9800'
                    opacity: 1
              legend:
                show: false
              chart:
                height: 270
            card_mod:
              style: |
                ha-card {
                  background: none;
                  box-shadow: none;
                  border: none;
                }
          - type: custom:button-card
            entity: '[[temperature_entity]]'
            size: 5%
            icon: '[[icon]]'
            show_state: false
            show_name: false
            label: '[[card_title]]'
            show_label: true
            styles:
              grid:
                - grid-template-areas: '"i" "l" "temp" "hum"'
            custom_fields:
              temp: >
                [[[ var temp = states['[[temperature_entity]]'].state; return
                `<ha-icon
                  icon="mdi:thermometer"
                  style="width: 15px; height: 15px; color: #ff9800; margin-right: 5px;">
                  </ha-icon><span style="font-size: 12px; font-weight: bold;">${temp}°C</span>`; ]]]
              hum: >
                [[[ var hum = states['[[humidity_entity]]'].state; return
                `<ha-icon
                  icon="mdi:water"
                  style="width: 15px; height: 15px; color: rgb(19, 160, 255); margin-right: 5px;">
                  </ha-icon><span style="font-size: 12px; font-weight: bold;">${hum}%</span>`; ]]]
            card_mod:
              style: |
                ha-card {
                  margin-top: -210px;
                  background: none;
                  box-shadow: none;
                  border: none;
                }
          - type: custom:apexcharts-card
            graph_span: 24h
            cache: true
            apex_config:
              chart:
                height: 250px
              legend:
                show: false
            header:
              show: true
              title: '[[card_title]]'
              show_states: true
              colorize_states: true
            yaxis:
              - id: first
                min: ~50
                max: ~70
                decimals: 0
                apex_config:
                  tickAmount: 10
              - id: second
                min: ~15
                max: ~25
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 30m
              show:
                legend_value: false
                extremas: true
            series:
              - entity: '[[temperature_entity]]'
                name: Température
                yaxis_id: second
                stroke_width: 2
                fill_raw: last
              - entity: '[[humidity_entity]]'
                name: Humidité
                yaxis_id: first
                color: rgb(19, 160, 255)
                type: column
            card_mod:
              style: |
                ha-card {
                  margin-top: -150px !important;
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
  conso_temps_reel_appareil:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      graph_span: 24h
      cache: true
      span:
        offset: '[[span_offset]]'
      apex_config:
        chart:
          height: 300px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: '[[card_title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: Watts
          min: ~0
          max: auto
          opposite: false
          decimals: 0
        - id: A
          min: ~0
          max: auto
          opposite: true
          decimals: 2
      all_series_config:
        group_by:
          func: last
          duration: '[[group_duration]]'
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 3h
        apex_config: null
      series:
        - entity: '[[energy_entity]]'
          name: Conso. Instantanée
          yaxis_id: Watts
          color: '[[energy_color]]'
          type: area
          stroke_width: 2
          fill_raw: last
        - entity: '[[current_entity]]'
          yaxis_id: A
          type: line
          stroke_dash: 2
          color: '[[current_color]]'
          unit: A
          stroke_width: 2
          name: Intensité
          group_by:
            func: raw
            duration: 24h
        - entity: '[[energy_entity]]'
          yaxis_id: Watts
          type: line
          stroke_dash: 8
          color: red
          unit: Wh
          stroke_width: 1
          name: Avg(24hrs)
          group_by:
            func: avg
            duration: 24h
        - entity: '[[energy_entity]]'
          color: '[[energy_color]]'
          stroke_width: 2
          group_by:
            func: raw
            duration: 24h
          float_precision: 0
          show:
            in_brush: true
            in_chart: false
      card_mod:
        style: |
          ha-card {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
  conso_mensuelle_appareil:
    card:
      type: custom:apexcharts-card
      graph_span: 730h
      cache: true
      span:
        end: day
      apex_config:
        chart:
          height: 250px
      header:
        show: true
        title: '[[title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: Watts
          min: ~0
          max: auto
          opposite: false
          decimals: 0
        - id: Avg
          min: ~0
          max: auto
          opposite: true
          decimals: 0
      all_series_config:
        group_by:
          func: diff
          duration: 24h
          start_with_last: true
        show:
          legend_value: true
          extremas: true
      series:
        - entity: '[[energy_entity]]'
          transform: return x * 1000;
          unit: Wh
          name: Conso. par jours
          yaxis_id: Watts
          color: '[[color]]'
          type: column
        - entity: '[[energy_entity]]'
          yaxis_id: Avg
          type: line
          stroke_dash: 8
          color: red
          unit: Wh
          stroke_width: 1
          name: Avg(730hrs)
          group_by:
            func: avg
            duration: 730h
      card_mod:
        style: |
          ha-card {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
  conso_mensuelle_clim:
    card:
      type: custom:apexcharts-card
      graph_span: 730h
      cache: true
      span:
        end: day
      apex_config:
        chart:
          height: 250px
      header:
        show: true
        title: '[[title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: Watts
          min: ~0
          max: auto
          opposite: false
          decimals: 0
          apex_config:
            tickAmount: 10
        - id: Avg
          min: ~0
          max: auto
          opposite: true
          decimals: 1
          apex_config:
            tickAmount: 10
      all_series_config:
        group_by:
          func: diff
          duration: 24h
        show:
          legend_value: true
          extremas: true
      series:
        - entity: '[[energy_entity]]'
          transform: return x * 1000;
          unit: W
          name: '[[energy_name]]'
          yaxis_id: Watts
          color: '[[energy_color]]'
          type: column
        - entity: '[[energy_entity]]'
          yaxis_id: Avg
          type: line
          stroke_dash: 8
          color: '[[avg_color]]'
          unit: Wh
          stroke_width: 1
          name: '[[avg_name]]'
          group_by:
            func: avg
            duration: 730h
        - entity: '[[temp_entity]]'
          yaxis_id: Avg
          type: line
          color: '[[temp_color]]'
          unit: '[[temp_unit]]'
          stroke_width: 3
          name: '[[temp_name]]'
          curve: stepline
          group_by:
            func: min
            duration: 24h
      card_mod:
        style: |
          ha-card {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
  conso_temps_reel_clim_rad:
    card:
      type: custom:apexcharts-card
      experimental:
        color_threshold: true
        brush: true
      graph_span: 24h
      cache: true
      span:
        offset: '[[span_offset]]'
      apex_config:
        chart:
          height: 300px
      now:
        show: true
        color: darkred
        label: Now
      header:
        show: true
        title: '[[card_title]]'
        show_states: true
        colorize_states: true
      yaxis:
        - id: Watts
          min: ~0
          max: auto
          opposite: false
          decimals: 0
          apex_config:
            tickAmount: 10
        - id: A
          min: ~0
          max: auto
          opposite: true
          decimals: 2
          apex_config:
            tickAmount: 10
      all_series_config:
        group_by:
          func: last
          duration: '[[group_duration]]'
        show:
          legend_value: false
          extremas: true
        curve: stepline
      brush:
        selection_span: 1h
        apex_config: null
      series:
        - entity: '[[energy_entity]]'
          name: Conso. Instantané
          yaxis_id: Watts
          color: '[[energy_color]]'
          type: area
          stroke_width: 2
          fill_raw: last
        - entity: '[[current_entity]]'
          yaxis_id: A
          type: line
          stroke_dash: 2
          color: '[[current_color]]'
          unit: A
          stroke_width: 2
          name: Intensité
          group_by:
            func: raw
            duration: 24h
        - entity: '[[power_entity_avg]]'
          yaxis_id: Watts
          type: line
          stroke_dash: 8
          color: red
          unit: Wh
          stroke_width: 1
          name: Avg(24hrs)
          group_by:
            func: avg
            duration: 24h
        - entity: '[[power_entity]]'
          color: '[[power_color]]'
          stroke_width: 2
          group_by:
            func: raw
            duration: 24h
          float_precision: 0
          show:
            in_brush: true
            in_chart: false
      card_mod:
        style: |
          ha-card {
            background: none !important;
            box-shadow: none !important;
            border: none !important;
          }
views:
  - title: Home
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: custom:meteofrance-weather-card
            entity: weather.vence
            animated_icons: true
            alert_forecast: true
            details: false
            current: true
            one_hour_forecast: true
            forecast: true
            rainChanceEntity: sensor.vence_rain_chance
            uvEntity: sensor.vence_uv
            cloudCoverEntity: sensor.vence_cloud_cover
            freezeChanceEntity: sensor.vence_freeze_chance
            snowChanceEntity: sensor.vence_snow_chance
            alertEntity: sensor.06_weather_alert
            name: Vence
            detailEntity: sensor.temperature_delta
            daily_forecast: false
            wind_forecast_icons: true
            humidity_forecast: true
            hourly_forecast: false
            rainForecastEntity: sensor.vence_next_rain
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: conditional
                conditions:
                  - condition: numeric_state
                    entity: sensor.blitzortung_lightning_counter
                    above: 0.99
                card:
                  type: custom:button-card
                  entity: sensor.blitzortung_lightning_counter
                  name: |
                    [[[
                      // Récupère la distance de l'impact de foudre
                      let distance = states['sensor.blitzortung_lightning_distance'] ? parseFloat(states['sensor.blitzortung_lightning_distance'].state) : 0;

                      // Récupère la localisation de l'impact, si disponible
                      let localisation = states['sensor.blitzortung_lightning_localisation'] ? states['sensor.blitzortung_lightning_localisation'].state : 0;

                      // Récupère l'azimut (direction) de l'impact, si disponible
                      let azimuth = states['sensor.blitzortung_lightning_azimuth'] ? parseFloat(states['sensor.blitzortung_lightning_azimuth'].state) : null;

                      // Récupère le nombre total d'impacts détectés
                      let impactCount = states['sensor.blitzortung_lightning_counter'] ? parseInt(states['sensor.blitzortung_lightning_counter'].state) : 0;

                      // Récupère le temps écoulé depuis le dernier impact de foudre
                      let timeSinceLastLightning = states['input_text.dernier_impact_de_foudre_temps_ecoule'] ? states['input_text.dernier_impact_de_foudre_temps_ecoule'].state : 'Inconnu';
                      // Initialise le message à afficher
                      let message = '';

                      // Vérifie si une distance est disponible
                      if (distance > 0) {
                        message = `Un éclair a été détecté à ${distance} Km de la maison`;

                        // Vérifie si une localisation (ville) est disponible et différente de 0
                        let city = null;
                        if (localisation && localisation !== 0) {
                          let location = states['sensor.blitzortung_lightning_localisation'].attributes.features;
                          if (location && location[0] && location[0].properties && location[0].properties.geocoding && location[0].properties.geocoding.city) {
                            city = location[0].properties.geocoding.city;
                            message += ` à ${city}.`;
                          }
                        }

                        // Vérifie l'azimut pour déterminer la direction seulement si la ville n'est pas disponible
                        if (city === null && azimuth !== null) {
                          if (azimuth >= 348.75 || azimuth < 11.25) {
                            message += ' au nord.';
                          } else if (azimuth >= 11.25 && azimuth < 33.75) {
                            message += ' au nord-nord-est.';
                          } else if (azimuth >= 33.75 && azimuth < 56.25) {
                            message += ' au nord-est.';
                          } else if (azimuth >= 56.25 && azimuth < 78.75) {
                            message += ' à l\'est-nord-est.';
                          } else if (azimuth >= 78.75 && azimuth < 101.25) {
                            message += ' à l\'est.';
                          } else if (azimuth >= 101.25 && azimuth < 123.75) {
                            message += ' à l\'est-sud-est.';
                          } else if (azimuth >= 123.75 && azimuth < 146.25) {
                            message += ' au sud-est.';
                          } else if (azimuth >= 146.25 && azimuth < 168.75) {
                            message += ' au sud-sud-est.';
                          } else if (azimuth >= 168.75 && azimuth < 191.25) {
                            message += ' au sud.';
                          } else if (azimuth >= 191.25 && azimuth < 213.75) {
                            message += ' au sud-sud-ouest.';
                          } else if (azimuth >= 213.75 && azimuth < 236.25) {
                            message += ' au sud-ouest.';
                          } else if (azimuth >= 236.25 && azimuth < 258.75) {
                            message += ' à l\'ouest-sud-ouest.';
                          } else if (azimuth >= 258.75 && azimuth < 281.25) {
                            message += ' à l\'ouest.';
                          } else if (azimuth >= 281.25 && azimuth < 303.75) {
                            message += ' à l\'ouest-nord-ouest.';
                          } else if (azimuth >= 303.75 && azimuth < 326.25) {
                            message += ' au nord-ouest.';
                          } else if (azimuth >= 326.25 && azimuth < 348.75) {
                            message += ' au nord-nord-ouest.';
                          }
                        }
                      } else {
                        message = 'Pas d\'impact de foudre détecté.';
                      }
                      // Ajoute le temps écoulé au message
                      message += `<br>${timeSinceLastLightning}.`;

                      // Retourne le message final avec le nombre total d'impacts, sauf si aucun impact n'est détecté
                      if (impactCount > 0) {
                        return `${message}<br><strong>${impactCount}</strong> impact(s) détecté(s)`;
                      } else {
                        return message;
                      }
                    ]]]
                  show_state: false
                  color_type: card
                  styles:
                    card:
                      - animation: blink 0s ease infinite
                    name:
                      - font-weight: bold
                      - font-size: 13px
                      - margin-top: 7px
                    icon:
                      - width: 50px
                      - height: 50px
                      - margin-top: '-4px'
                  color: rgb(255, 123, 0)
                  icon: mdi:weather-lightning
                  hide_state: false
                  vertical: false
                  show_entity_picture: false
                  tap_action:
                    action: navigate
                    navigation_path: meteo/#foudre
                  icon_tap_action:
                    action: navigate
                    navigation_path: meteo/#foudre
                  hold_action:
                    action: none
                  card_mod:
                    style: |
                      ha-card {
                        box-shadow: none !important;
                        
                        border: none !important;
                      }
            grid_options:
              columns: 12
              rows: 2
            visibility:
              - condition: numeric_state
                entity: sensor.blitzortung_lightning_counter
                above: 1
          - type: custom:bubble-card
            card_type: separator
            name: Personne(s)
            icon: mdi:account-group
            card_layout: normal
            rows: 1
            styles: |
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 0.8;
              }
              .bubble-sub-button {
                background-color: ${
                  hass.states['sensor.etat_wifi_maison'].state === '2'
                    ? 'darkgreen'
                    : (hass.states['sensor.etat_wifi_maison'].state === 'Eric' ||
                       hass.states['sensor.etat_wifi_maison'].state === 'Mamour')
                      ? 'rgb(255, 103, 0)'  /* orange */
                      : 'grey'               /* '0' ou autre */
                } !important;
                color: ginsboro !important;
              }

              ha-card {
                margin-top: 20px !important;
              }
            sub_button:
              - entity: sensor.etat_wifi_maison
                show_last_changed: false
                show_state: true
                show_icon: true
                icon: mdi:home
                show_attribute: false
                show_name: true
                name: Maison
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: person.eric
            show_name: true
            show_last_changed: true
            show_attribute: false
            card_layout: normal
            layout_options:
              grid_columns: 2
              grid_rows: 1
            show_state: false
            sub_button:
              - entity: person.eric
                show_state: false
                show_icon: true
                show_background: true
                show_attribute: false
                attribute: entity_picture
            styles: |
              .bubble-sub-button {
                background-color: black !important;
              }
              .bubble-icon {
                color: ${
                  hass.states['person.eric'].state === 'home'
                    ? 'gainsboro'
                    : hass.states['person.eric'].state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : 'grey'
                } !important;
              }
              ha-card {
                --bubble-icon-background-color: black !important;
              }
              .bubble-button-background {
                background-color: ${
                  hass.states['person.eric'].state === 'home'
                    ? 'green'
                    : hass.states['person.eric'].state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : 'grey'
                } !important;
              }
              .bubble-sub-button > ha-icon {
                color: ${
                  hass.states['person.eric'].state === 'home'
                    ? 'darkgreen'
                    : hass.states['person.eric'].state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : 'grey'
                } !important;
              }
              ${subButtonIcon[0].setAttribute("icon",
                hass.states['person.eric'].state === 'home'
                  ? 'mdi:home'
                  : hass.states['person.eric'].state === 'not_home'
                    ? 'mdi:home-off'
                    : 'mdi:crosshairs-question'
              )}
            button_action: {}
          - type: custom:bubble-card
            card_type: button
            button_type: state
            entity: person.mamour
            show_name: true
            show_last_changed: true
            show_attribute: false
            card_layout: normal
            layout_options:
              grid_columns: 2
              grid_rows: 1
            show_state: false
            sub_button:
              - entity: person.mamour
                show_state: false
                show_icon: true
                show_background: true
                show_attribute: false
                attribute: entity_picture
            styles: |
              .bubble-sub-button {
                background-color: black !important;
              }
              .bubble-icon {
                color: ${
                  hass.states['person.eric'].state === 'home'
                    ? 'gainsboro'
                    : hass.states['person.eric'].state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : 'grey'
                } !important;
              }
              ha-card {
                --bubble-icon-background-color: black !important;
              }
              .bubble-button-background {
                background-color: ${
                  hass.states['person.mamour'].state === 'home'
                    ? 'green'
                    : hass.states['person.mamour'].state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : 'grey'
                } !important;
              }
              .bubble-sub-button > ha-icon {
                color: ${
                  hass.states['person.mamour'].state === 'home'
                    ? 'darkgreen'
                    : hass.states['person.mamour'].state === 'not_home'
                      ? 'rgb(255, 103, 0)'
                      : 'grey'
                } !important;
              }
              ${subButtonIcon[0].setAttribute("icon",
                hass.states['person.mamour'].state === 'home'
                  ? 'mdi:home'
                  : hass.states['person.mamour'].state === 'not_home'
                    ? 'mdi:home-off'
                    : 'mdi:crosshairs-question'
              )}
            button_action: {}
          - type: custom:mushroom-entity-card
            entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
            name: Détecteur de fuite sous évier cuisine
            fill_container: true
            primary_info: name
            hold_action:
              action: none
            double_tap_action:
              action: none
            tap_action:
              action: none
            grid_options:
              columns: 12
              rows: 2
            visibility:
              - condition: state
                entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
                state: 'on'
              - condition: state
                entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
                state: unavailable
              - condition: state
                entity: binary_sensor.detecteur_de_fuite_ikea_water_leak
                state: unknown
            layout: vertical
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - square: false
            type: grid
            cards:
              - type: custom:button-card
                icon: mdi:weather-partly-cloudy
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/meteo
                name: Météo
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                  icon:
                    - transform: rotate(350deg)
                    - left: 20%
                    - top: 20%
                    - color: gold
                    - opacity: 1
                  name:
                    - color: white
                    - top: 12%
                    - left: 5%
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/temperatures
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre titre"
                        "piece temp espace humidite"
                    - grid-template-columns: 1fr 1fr 0.5fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    temp:
                      - justify-self: center
                      - margin-left: 35px
                      - text-align: center
                    espace:
                      - justify-self: center
                      - margin-left: 0px
                      - text-align: center
                    humidite:
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Courbes Température'
                    ]]]
                  piece: |
                    [[[
                      return '<span style="display: block; text-align: left; line-height: 1.2;">Balcon N.</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Salon</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Cellier</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Cuisine</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Bureau</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">SdB</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Chambre</span>';
                    ]]]
                  temp: |
                    [[[
                      var tempBalconN = parseFloat(states['sensor.th_balcon_nord_temperature'].state).toFixed(1);
                      var tempSalon = parseFloat(states['sensor.th_salon_temperature'].state).toFixed(1);
                      var tempCellier = parseFloat(states['sensor.th_cellier_temperature'].state).toFixed(1);
                      var tempCuisine = parseFloat(states['sensor.th_cuisine_temperature'].state).toFixed(1);
                      var tempBureau = parseFloat(states['sensor.th_bureau_temperature'].state).toFixed(1);
                      var tempSalleDeBain = parseFloat(states['sensor.th_salle_de_bain_temperature'].state).toFixed(1);
                      var tempChambre = parseFloat(states['sensor.th_chambre_temperature'].state).toFixed(1);

                      function getTemperatureColor(temp) {
                        if (temp > 40) return '#FF0000'; // Rouge
                        if (temp > 32) return '#FFA500'; // Orange
                        if (temp > 25) return '#FFD700'; // Or
                        if (temp < 25) return '#00FF00'; // Vert
                        if (temp < 19) return '#A1E3F9'; // bleu ciel
                        if (temp < 13) return '#578FCA'; // Light Blue
                        if (temp < 5) return '#3674B5'; // Bleu
                        return '#00FF00'; // Vert
                      }

                      return '<span style="display: block; text-align: center; line-height: 1.2; color: ' + getTemperatureColor(tempBalconN) + ';">' + tempBalconN + '°C</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">' + tempSalon + '°C</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">' + tempCellier + '°C</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">' + tempCuisine + '°C</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">' + tempBureau + '°C</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">' + tempSalleDeBain + '°C</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">' + tempChambre + '°C</span>';
                    ]]]
                  espace: |
                    [[[
                      return '<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>' +
                             '<span style="display: block; text-align: center; line-height: 1.2;">&nbsp;&nbsp;</span>';
                    ]]]
                  humidite: |
                    [[[
                      var humiditeBalconN = parseFloat(states['sensor.th_balcon_nord_humidity'].state).toFixed(1);
                      var humiditeSalon = parseFloat(states['sensor.th_salon_humidity'].state).toFixed(1);
                      var humiditeCellier = parseFloat(states['sensor.th_cellier_humidity'].state).toFixed(1);
                      var humiditeCuisine = parseFloat(states['sensor.th_cuisine_humidity'].state).toFixed(1);
                      var humiditeBureau = parseFloat(states['sensor.th_bureau_humidity'].state).toFixed(1);
                      var humiditeSalleDeBain = parseFloat(states['sensor.th_salle_de_bain_humidity'].state).toFixed(1);
                      var humiditeChambre = parseFloat(states['sensor.th_chambre_humidity'].state).toFixed(1);

                      function getHumidityColor(humidity) {
                        if (humidity > 75) return '#FF0000'; // Rouge
                        if (humidity > 55) return '#FFA500'; // Orange
                        return 'white'; // Blanc
                      }

                      return '<span style="color: ' + getHumidityColor(humiditeBalconN) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeBalconN + '%</span>' +
                             '<span style="color: ' + getHumidityColor(humiditeSalon) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeSalon + '%</span>' +
                             '<span style="color: ' + getHumidityColor(humiditeCellier) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeCellier + '%</span>' +
                             '<span style="color: ' + getHumidityColor(humiditeCuisine) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeCuisine + '%</span>' +
                             '<span style="color: ' + getHumidityColor(humiditeBureau) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeBureau + '%</span>' +
                             '<span style="color: ' + getHumidityColor(humiditeSalleDeBain) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeSalleDeBain + '%</span>' +
                             '<span style="color: ' + getHumidityColor(humiditeChambre) + '; display: block; text-align: right; line-height: 1.2;">' + humiditeChambre + '%</span>';
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/clim
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece mode consigne"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 3px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    mode:
                      - justify-self: start
                      - margin-left: 15px
                      - text-align: left
                    consigne:
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Commande Clim.'
                    ]]]
                  piece: |
                    [[[
                      function getColorForPowerStatus(powerStatus, mode) {
                        if (mode === 'Fan') return 'lime';
                        if (powerStatus === 'on') return 'lime';
                        if (powerStatus === 'off') return 'white';
                        return 'purple';
                      }
                      var modeSalon = states['sensor.clim_salon_etat'] ? states['sensor.clim_salon_etat'].state : 'Off';
                      var modeCuisine = states['sensor.radiateur_cuisine_etat'] ? states['sensor.radiateur_cuisine_etat'].state : 'Off';
                      var modeBureau = states['sensor.clim_bureau_etat'] ? states['sensor.clim_bureau_etat'].state : 'Off';
                      var modeSdB = states['sensor.radiateur_sdb_etat'] ? states['sensor.radiateur_sdb_etat'].state : 'Off';
                      var modeChambre = states['sensor.clim_chambre_etat'] ? states['sensor.clim_chambre_etat'].state : 'Off';

                      var salonPowerStatus = states['sensor.salon_power_status'] ? states['sensor.salon_power_status'].state : 'on';
                      var cuisinePowerStatus = states['sensor.cuisine_power_status'] ? states['sensor.cuisine_power_status'].state : 'on';
                      var bureauPowerStatus = states['sensor.bureau_power_status'] ? states['sensor.bureau_power_status'].state : 'on';
                      var sdBPowerStatus = states['sensor.sdb_power_status'] ? states['sensor.sdb_power_status'].state : 'on';
                      var chambrePowerStatus = states['sensor.chambre_power_status'] ? states['sensor.chambre_power_status'].state : 'on';

                      return '<span style="display: block; text-align: left; line-height: 1.2;">T̄ Appart. ------------</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2;">Mode -> </span>' + 
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForPowerStatus(salonPowerStatus, modeSalon) + ';">Salon</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForPowerStatus(cuisinePowerStatus, modeCuisine) + ';">Cuisine</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForPowerStatus(bureauPowerStatus, modeBureau) + ';">Bureau</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForPowerStatus(sdBPowerStatus, modeSdB) + ';">SdB</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForPowerStatus(chambrePowerStatus, modeChambre) + ';">Chambre</span>';
                    ]]]
                  mode: |
                    [[[
                      var modemode = states['sensor.mode_ete_hiver_etat'] ? states['sensor.mode_ete_hiver_etat'].state.trim().toLowerCase() : 'off';
                      var modeSalon = states['sensor.clim_salon_etat'] ? states['sensor.clim_salon_etat'].state.trim().toLowerCase() : 'off';
                      var modeCuisine = states['sensor.radiateur_cuisine_etat'] ? states['sensor.radiateur_cuisine_etat'].state.trim().toLowerCase() : 'off';
                      var modeBureau = states['sensor.clim_bureau_etat'] ? states['sensor.clim_bureau_etat'].state.trim().toLowerCase() : 'off';
                      var modeChambre = states['sensor.clim_chambre_etat'] ? states['sensor.clim_chambre_etat'].state.trim().toLowerCase() : 'off';

                      function getColorForMode(mode) {
                        if (mode === 'cool') return 'skyblue';
                        if (mode === 'heat') return 'crimson';
                        if (mode === 'fan') return 'turquoise';
                        if (mode === 'off') return 'red';
                        return 'purple'; 
                      }

                      function formatMode(mode) {
                        var color = getColorForMode(mode);
                        return '<span style="display: block; text-align: left; line-height: 1.2; color: ' + color + ';">' + mode.charAt(0).toUpperCase() + mode.slice(1) + '</span>';
                      }

                      return '<span style="display: block; text-align: left; line-height: 1.2; color: transparent;">.</span>' +
                             formatMode(modemode) +
                             formatMode(modeSalon) +
                             formatMode(modeCuisine) +
                             formatMode(modeBureau) +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: grey;">XXX</span>' +
                             formatMode(modeChambre);
                    ]]]
                  consigne: |
                    [[[
                      var tempMoyenne = states['sensor.temperature_moyenne_interieure'] ? parseFloat(states['sensor.temperature_moyenne_interieure'].state).toFixed(1) : 'N/A';
                      var consigneSalon = states['climate.clim'] ? states['climate.clim'].attributes.temperature : 'N/A';
                      var consigneCuisine = states['climate.radiateur_cuisine'] ? states['climate.radiateur_cuisine'].attributes.temperature : 'N/A';
                      var consigneBureau = states['climate.clim_du_bureau'] ? states['climate.clim_du_bureau'].attributes.temperature : 'N/A';
                      var consigneChambre = states['climate.clim_de_la_chambre'] ? states['climate.clim_de_la_chambre'].attributes.temperature : 'N/A';
                      return '<span style="display: block; text-align: right; line-height: 1.2; color: lightgreen;">' + tempMoyenne + '°C</span>' +
                               '<span style="display: block; text-align: right; line-height: 1.2;">'  + '.</span>' +
                             '<span style="display: block; text-align: right; line-height: 1.2;">' + consigneSalon + '°C</span>' +
                             '<span style="display: block; text-align: right; line-height: 1.2;">' + consigneCuisine + '°C</span>' +
                             '<span style="display: block; text-align: right; line-height: 1.2;">' + consigneBureau + '°C</span>' +
                             '<span style="display: block; text-align: right; line-height: 1.2; color: grey;">XX°C</span>' +
                             '<span style="display: block; text-align: right; line-height: 1.2;">' + consigneChambre + '°C</span>';
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre_1 titre_1 titre_1"
                        "mini realtime maxi"
                        "titre_2 titre_2 titre_2"
                        "toto hp hc"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto auto auto auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre_1:
                      - grid-area: titre_1
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    mini:
                      - grid-area: mini
                      - text-align: center
                    realtime:
                      - grid-area: realtime
                      - text-align: center
                    maxi:
                      - grid-area: maxi
                      - text-align: center
                    titre_2:
                      - grid-area: titre_2
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    toto:
                      - grid-area: toto
                      - margin-right: 7px
                      - font-weight: bold
                    hc:
                      - grid-area: hc
                      - margin-right: 7px
                      - font-weight: bold
                    hp:
                      - grid-area: hp
                      - margin-right: 7px
                      - font-weight: bold
                custom_fields:
                  titre_1: |
                    [[[
                      return 'Home Consumption<br><br>Mini -- Realtime -- Maxi';
                    ]]]
                  mini: |
                    [[[
                      const value = parseFloat(states['sensor.conso_mini']?.state || 0);
                      let color = 'white';
                      if (value > 75) { color = 'red'; }
                      else if (value > 50) { color = 'orange'; }
                      else if (value > 0) { color = 'white'; }
                      return `<span style='color:${color}; font-weight:bold;'>${value} W</span>`;
                    ]]]
                  realtime: |
                    [[[
                      const value = parseFloat(states['sensor.ecojoko_consommation_temps_reel']?.state || 0);
                      let color = 'white';
                      if (value > 4000) { color = 'red'; }
                      else if (value > 2000) { color = 'orange'; }
                      else if (value > 1000) { color = 'lime'; }
                      return `<span style='color:${color}; font-weight:bold;'>${value} W</span>`;
                    ]]]
                  maxi: |
                    [[[
                      const value = parseFloat(states['sensor.conso_maxi']?.state || 0);
                      let color = 'white';
                      if (value > 4000) { color = 'red'; }
                      else if (value > 2000) { color = 'orange'; }
                      else if (value > 0) { color = 'white'; }
                      return `<span style='color:${color}; font-weight:bold;'>${value} W</span>`;
                    ]]]
                  titre_2: |
                    [[[
                      return '__________________________<br><br>Coûts Total = H.P. + H.C.';
                    ]]]
                  toto: |
                    [[[
                      const hp = parseFloat(states['sensor.ecojoko_consommation_hp_reseau']?.state || 0);
                      const hc = parseFloat(states['sensor.ecojoko_consommation_hc_reseau']?.state || 0);
                      const tarif_hp = parseFloat(states['sensor.tarif_heures_pleines_ttc']?.state || 0);
                      const tarif_hc = parseFloat(states['sensor.tarif_heures_creuses_ttc']?.state || 0);
                      const total = (hp * tarif_hp) + (hc * tarif_hc);
                      return `<span style="display:block; text-align:right; line-height:1.2;">
                        ${total.toFixed(2)}<span style="font-size:9px;"> €</span>
                      </span>`;
                    ]]]
                  hc: |
                    [[[
                      const hc_value = parseFloat(states['sensor.ecojoko_consommation_hc_reseau']?.state || 0);
                      const tarif_hc = parseFloat(states['sensor.tarif_heures_creuses_ttc']?.state || 0);
                      const hc_total = hc_value * tarif_hc;

                      return `<span style="display:block; text-align:right; line-height:1.2;">
                        ${hc_total.toFixed(2)}<span style="font-size:9px;"> €</span>
                      </span>`;
                    ]]]
                  hp: |
                    [[[
                      const hp_value = parseFloat(states['sensor.ecojoko_consommation_hp_reseau']?.state || 0);
                      const tarif_hp = parseFloat(states['sensor.tarif_heures_pleines_ttc']?.state || 0);
                      const hp_total = hp_value * tarif_hp;

                      return `<span style="display:block; text-align:right; line-height:1.2;">
                        ${hp_total.toFixed(2)}<span style="font-size:9px;"> €</span>
                      </span>`;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie clim
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece quotidien mensuel"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    quotidien:
                      - justify-self: start
                      - margin-left: 12px
                      - text-align: left
                    mensuel:
                      - justify-self: end
                      - margin-right: 4px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Consommation CLIM';
                    ]]]
                  piece: |
                    [[[
                      
                      function getColorForStatus(powerStatus, mode) {
                        if (powerStatus === 'off' && mode === 'off') return 'red';
                        if (powerStatus === 'off') return 'white';
                        if (powerStatus === 'on' && mode === 'cool') return 'skyblue';
                        if (powerStatus === 'on' && mode === 'heat') return 'crimson';
                        return 'purple';
                      }
                      var salonPowerStatus = states['sensor.salon_power_status'].state || 'off';
                      var cuisinePowerStatus = states['sensor.cuisine_power_status'].state || 'off';
                      var bureauPowerStatus = states['sensor.bureau_power_status'].state || 'off';
                      var sdBPowerStatus = states['sensor.sdb_power_status'].state || 'off';
                      var chambrePowerStatus = states['sensor.chambre_power_status'].state || 'off';
                      var modeSalon = states['climate.clim'].state || 'off';
                      var modeCuisine = states['climate.radiateur_cuisine'].state || 'off';
                      var modeBureau = states['climate.clim_du_bureau'].state || 'off';
                      var modeChambre = states['climate.clim_de_la_chambre'].state || 'off';
                      return '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForStatus(salonPowerStatus, modeSalon) + ';">Salon</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForStatus(cuisinePowerStatus, modeCuisine) + ';">Cuisine</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForStatus(bureauPowerStatus, modeBureau) + ';">Bureau</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForStatus(sdBPowerStatus, 'XXX') + ';">SdB</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: ' + getColorForStatus(chambrePowerStatus, modeChambre) + ';">Chambre</span>' +
                             '<span style="display: block; text-align: left; line-height: 1.2; color: lightgreen;">TOTAL</span>';
                    ]]]
                  quotidien: |
                    [[[
                      
                      function safeState(entityId) {
                        var value = parseFloat(states[entityId].state || 0);
                        if (isNaN(value)) {
                          return '0 <span style="font-size: 5px;">Wh</span>';
                        }
                        if (value < 1) {
                          return (value * 1000).toFixed(0) + ' <span style="font-size: 5px;">Wh</span>';
                        } else {
                          return value.toFixed(2) + ' <span style="font-size: 5px;">kWh</span>';
                        }
                      }
                      
                      return `
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.clim_salon_quotidien')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.radiateur_elec_cuisine_quotidien')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.clim_du_bureau_quotidien')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.radiateur_sdb_quotidien')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.clim_chambre_quotidien')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2; color: lightgreen;">${safeState('sensor.conso_clim_rad_total_quotidien')}</span>
                      `;
                    ]]]
                  mensuel: |
                    [[[
                      
                      function safeState(entityId) {
                        var value = parseFloat(states[entityId].state || 0);
                        if (isNaN(value)) {
                          return '0 <span style="font-size: 5px;">Wh</span>';
                        }
                        if (value < 1) {
                          return (value * 1000).toFixed(0) + ' <span style="font-size: 5px;">Wh</span>';
                        } else {
                          return value.toFixed(2) + ' <span style="font-size: 5px;">kWh</span>';
                        }
                      }
                      
                      return `
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.clim_salon_mensuel')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.radiateur_elec_cuisine_mensuel')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.clim_du_bureau_mensuel')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.radiateur_sdb_mensuel')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.clim_chambre_mensuel')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2; color: lightgreen;">${safeState('sensor.conso_clim_rad_total_mensuel')}</span>
                      `;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie lampes
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece quotidien mensuel"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    quotidien:
                      - justify-self: start
                      - margin-left: 15px
                      - text-align: left
                    mensuel:
                      - justify-self: end
                      - margin-right: 10px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Consommation LAMPES'
                    ]]]
                  piece: |
                    [[[
                      return `
                        <span style="display: block; text-align: left; line-height: 1.2; color: ${states['sensor.lumiere_appartement_etat'].state !== 'Éteint' ? 'lightgreen' : 'white'};">Appart.</span>
                        <span style="display: block; text-align: left; line-height: 1.2; color: ${states['sensor.lumiere_salon_etat'].state !== 'Éteint' ? 'lightgreen' : 'white'};">Salon</span>
                        <span style="display: block; text-align: left; line-height: 1.2; color: ${states['sensor.lumiere_cuisine_etat'].state !== 'Éteint' ? 'lightgreen' : 'white'};">Cuisine</span>
                        <span style="display: block; text-align: left; line-height: 1.2; color: ${states['sensor.lumiere_bureau_etat'].state === 'Éco.' ? 'white' : states['sensor.lumiere_bureau_etat'].state !== 'Éteint' ? 'lightgreen' : 'white'};">Bureau</span>
                        <span style="display: block; text-align: left; line-height: 1.2; color: ${states['sensor.lumiere_salle_de_bain_etat'].state !== 'Éteint' ? 'lightgreen' : 'white'};">SdB</span>
                        <span style="display: block; text-align: left; line-height: 1.2; color: ${states['sensor.lumiere_chambre_etat'].state === 'Éco.' ? 'white' : states['sensor.lumiere_chambre_etat'].state !== 'Éteint' ? 'lightgreen' : 'white'};">Chambre</span>
                      `;
                    ]]]
                  quotidien: |
                    [[[
                      function safeState(entityId) {
                        var value = parseFloat(states[entityId].state || 0);
                        if (isNaN(value)) {
                          return '0 <span style="font-size: 5px;">Wh</span>';
                        }
                        if (value < 1) {
                          return (value * 1000).toFixed(0) + ' <span style="font-size: 5px;">Wh</span>';
                        } else {
                          return value.toFixed(2) + ' <span style="font-size: 5px;">kWh</span>';
                        }
                      }
                      return `
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_apparte_2_energy_daily')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_salon_5_energy_daily')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_cuisine_1_energy_daily')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_bureau_5_energy_daily')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_eclairage_salle_de_bain_2_quotidien')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_chambre_4_energy_daily')}</span>
                      `;
                    ]]]
                  mensuel: |
                    [[[
                      function safeState(entityId) {
                        var value = parseFloat(states[entityId].state || 0);
                        if (isNaN(value)) {
                          return '0 <span style="font-size: 5px;">Wh</span>';
                        }
                        if (value < 1) {
                          return (value * 1000).toFixed(0) + ' <span style="font-size: 5px;">Wh</span>';
                        } else {
                          return value.toFixed(2) + ' <span style="font-size: 5px;">kWh</span>';
                        }
                      }
                      return `
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_apparte_2_energy_monthly')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_salon_5_energy_monthly')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_cuisine_1_energy_monthly')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_bureau_5_energy_monthly')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_eclairage_salle_de_bain_2_mensuel')}</span>
                        <span style="display: block; text-align: right; line-height: 1.2;">${safeState('sensor.eclairage_chambre_4_energy_monthly')}</span>
                      `;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/lumieres
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "piece etat active"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - grid-area: piece
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    etat:
                      - grid-area: etat
                      - justify-self: end
                      - text-align: start
                      - margin-right: '-11px'
                    active:
                      - grid-area: active
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Commande LAMPES'
                    ]]]
                  piece: |
                    [[[
                      return `
                      <div>
                        <div>Appart.</div>
                        <div>Salon</div>
                        <div>Cuisine</div>
                        <div>Bureau</div>
                        <div>SdB</div>
                        <div>Chambre</div>
                      </div>
                      `;
                    ]]]
                  etat: |
                    [[[
                      function getColorForStatus(status) {
                        if (status === 'Allumé') return 'lime';
                        if (status === 'Éteint') return 'red';
                        if (status === 'Éco.') return 'orange';
                        if (status === 'erreur') return 'purple';

                        if (status === 'Entrée') return 'lightgreen';
                        if (status === 'Couloir') return 'lightgreen';

                        if (status === 'Salon') return 'lightgreen';
                        if (status === 'Table') return 'lightgreen';
                        if (status === 'Bureau') return 'lightgreen';
                        if (status === 'Écran') return 'lightgreen';
                        if (status === 'Chambre') return 'lightgreen';
                        if (status === 'Zone G.') return 'lightgreen';
                        if (status === 'Zone É.') return 'lightgreen';
                        if (status === 'Tête Lit') return 'lightgreen';
                        if (status === 'Ch.+zG') return 'lightgreen';
                        if (status === 'Ch.+zÉ') return 'lightgreen';
                      }

                      var appartementStatus = states['sensor.lumiere_appartement_etat'].state;
                      var salonStatus = states['sensor.lumiere_salon_etat'].state;
                      var cuisineStatus = states['sensor.lumiere_cuisine_etat'].state;
                      var bureauStatus = states['sensor.lumiere_bureau_etat'].state;
                      var sdbStatus = states['sensor.lumiere_salle_de_bain_etat'].state;
                      var chambreStatus = states['sensor.lumiere_chambre_etat'].state;

                      return `
                      <div>
                        <div style="color: ${getColorForStatus(appartementStatus)};">${appartementStatus}</div>
                        <div style="color: ${getColorForStatus(salonStatus)};">${salonStatus}</div>
                        <div style="color: ${getColorForStatus(cuisineStatus)};">${cuisineStatus}</div>
                        <div style="color: ${getColorForStatus(bureauStatus)};">${bureauStatus}</div>
                        <div style="color: ${getColorForStatus(sdbStatus)};">${sdbStatus}</div>
                        <div style="color: ${getColorForStatus(chambreStatus)};">${chambreStatus}</div>
                      </div>
                      `;
                    ]]]
                  active: |
                    [[[
                      function countActiveEntities(entities) {
                        return entities.filter(entity => states[entity] && states[entity].state === 'on').length;
                      }

                      function getColorForCount(activeCount, totalCount) {
                        if (activeCount === totalCount) return 'lightgreen';
                        if (activeCount === 0) return 'red';
                        return 'orange';
                      }

                      var appartement = {
                        activeCount: countActiveEntities(['light.entree', 'light.couloir']),
                        totalCount: 2,
                        color: getColorForCount(countActiveEntities(['light.entree', 'light.couloir']), 2)
                      };

                      var salon = {
                        activeCount: countActiveEntities(['light.salon', 'light.table']),
                        totalCount: 2,
                        color: getColorForCount(countActiveEntities(['light.salon', 'light.table']), 2)
                      };

                      var cuisine = {
                        activeCount: countActiveEntities(['light.cuisine']),
                        totalCount: 1,
                        color: getColorForCount(countActiveEntities(['light.cuisine']), 1)
                      };

                      var bureauEntities = ['light.bureau_z2m'];
                      if (states['switch.hue_smart_eco_pc_bureau'].state === 'on') {
                        bureauEntities.push('light.bureau');
                      }
                      var bureau = {
                        activeCount: countActiveEntities(bureauEntities),
                        totalCount: bureauEntities.length,
                        color: getColorForCount(countActiveEntities(bureauEntities), bureauEntities.length)
                      };

                      var sdb = {
                        activeCount: states['light.lampe_salle_de_bain_hue'].state === 'on' ? 1 : 0,
                        totalCount: 1,
                        color: getColorForCount(states['light.lampe_salle_de_bain_hue'].state === 'on' ? 1 : 0, 1)
                      };

                      var chambreEntities = ['light.chambre'];
                      if (states['switch.prise_tete_de_lit_chambre'].state === 'on') {
                        chambreEntities.push('light.hue_color_candle_chambre_gege');
                        chambreEntities.push('light.hue_color_candle_chambre_eric');
                      }
                      var chambre = {
                        activeCount: countActiveEntities(chambreEntities),
                        totalCount: chambreEntities.length,
                        color: getColorForCount(countActiveEntities(chambreEntities), chambreEntities.length)
                      };

                      return `
                      <div>
                        <div style="color: ${appartement.color};">${appartement.activeCount}/${appartement.totalCount}</div>
                        <div style="color: ${salon.color};">${salon.activeCount}/${salon.totalCount}</div>
                        <div style="color: ${cuisine.color};">${cuisine.activeCount}/${cuisine.totalCount}</div>
                        <div style="color: ${bureau.color};">${bureau.activeCount}/${bureau.totalCount}</div>
                        <div style="color: ${sdb.color};">${sdb.activeCount}/${sdb.totalCount}</div>
                        <div style="color: ${chambre.color};">${chambre.activeCount}/${chambre.totalCount}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/prises
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre"
                        "piece etat"
                    - grid-template-columns: 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: titre
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    piece:
                      - grid-area: piece
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    etat:
                      - grid-area: etat
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                custom_fields:
                  titre: |
                    [[[
                      return 'Commande éCO.'
                    ]]]
                  piece: |
                    [[[
                      return `
                      <div>
                        <div>Horloge</div>
                        <div>Salon</div>
                        <div>TV Salon</div>
                        <div>PC Bureau</div>
                        <div>TV Chambre</div>
                        <div>Tête de Lit</div>
                      </div>
                      `;
                    ]]]
                  etat: |
                    [[[
                      function getColorForStatus(powerStatus) {
                        if (powerStatus === 'unavailable') return 'purple';
                        return powerStatus === 'on' ? 'lightgreen' : 'red';
                      }

                      function getStatusText(powerStatus) {
                        if (powerStatus === 'unavailable') return 'Non trouvé';
                        return powerStatus === 'on' ? 'Allumé' : 'Éteint';
                      }

                      var horlogeStatus = states['switch.prise_horloge_ikea'] ? states['switch.prise_horloge_ikea'].state : 'unavailable';
                      var salonStatus = states['light.hue_smart_salon'] ? states['light.hue_smart_salon'].state : 'unavailable';
                      var tvSalonStatus = states['light.hue_smart_tv_salon'] ? states['light.hue_smart_tv_salon'].state : 'unavailable';
                      var pcBureauStatus = states['switch.hue_smart_eco_pc_bureau'] ? states['switch.hue_smart_eco_pc_bureau'].state : 'unavailable';
                      var tvChambreStatus = states['light.hue_smart_tv_chambre'] ? states['light.hue_smart_tv_chambre'].state : 'unavailable';
                      var teteDeLitStatus = states['switch.prise_tete_de_lit_chambre'] ? states['switch.prise_tete_de_lit_chambre'].state : 'unavailable';

                      return `
                      <div>
                        <div style="color: ${getColorForStatus(horlogeStatus)};">${getStatusText(horlogeStatus)}</div>
                        <div style="color: ${getColorForStatus(salonStatus)};">${getStatusText(salonStatus)}</div>
                        <div style="color: ${getColorForStatus(tvSalonStatus)};">${getStatusText(tvSalonStatus)}</div>
                        <div style="color: ${getColorForStatus(pcBureauStatus)};">${getStatusText(pcBureauStatus)}</div>
                        <div style="color: ${getColorForStatus(tvChambreStatus)};">${getStatusText(tvChambreStatus)}</div>
                        <div style="color: ${getColorForStatus(teteDeLitStatus)};">${getStatusText(teteDeLitStatus)}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/stores
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "espace espace espace"
                        "piece fenetres stores"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto 14px auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: title
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    espace:
                      - grid-area: espace
                      - height: 10px
                    piece:
                      - grid-area: piece
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    fenetres:
                      - grid-area: fenetres
                      - justify-self: end
                      - text-align: center
                    stores:
                      - grid-area: stores
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                custom_fields:
                  titre: |
                    [[[
                      return 'Commande Stores<BR>Pièces / Fenêtres / Stores';
                    ]]]
                  espace: |
                    [[[
                      return ' ';
                    ]]]
                  piece: |
                    [[[
                      return `
                      <div>
                        <div>Salon</div>
                        <div>Cuisine</div>
                        <div>Bureau</div>
                        <div>Chambre</div>
                      </div>
                      `;
                    ]]]
                  fenetres: |
                    [[[
                      function getColorForFenetreStatus(FenetreStatus) {
                        if (FenetreStatus === 'on') { return '<span style="color: red;">Ouvert</span>'; }
                        if (FenetreStatus === 'off') { return '<span style="color: lightgreen;">Fermé</span>'; }
                        return '<span style="color: purple;">Erreur</span>';
                      }
                      var salonFenetreStatus = getColorForFenetreStatus(states['binary_sensor.contact_fenetre_salon_ikea_contact']?.state || 'off');
                      var cuisineFenetreStatus = getColorForFenetreStatus(states['binary_sensor.contact_fenetre_cuisine_ikea_contact']?.state || 'off');
                      var bureauFenetreStatus = getColorForFenetreStatus(states['binary_sensor.contact_fenetre_bureau_ikea_contact']?.state || 'off');
                      var chambreFenetreStatus = getColorForFenetreStatus(states['binary_sensor.contact_fenetre_chambre_ikea_contact']?.state || 'off');
                      return `
                      <div>
                        <div>${salonFenetreStatus}</div>
                        <div>${cuisineFenetreStatus}</div>
                        <div>${bureauFenetreStatus}</div>
                        <div>${chambreFenetreStatus}</div>
                      </div>
                      `;
                    ]]]
                  stores: |
                    [[[
                      function getStoreStatus(entityId) {
                        var state = states[entityId]?.state;
                        if (state === undefined) return '-';
                        return state;
                      }
                      var salonStoreStatus = getStoreStatus('sensor.store_salon_status');
                      var cuisineStoreStatus = getStoreStatus('sensor.store_cuisine_status');
                      var bureauStoreStatus = getStoreStatus('sensor.store_bureau_status');
                      var chambreStoreStatus = getStoreStatus('sensor.store_chambre_status'); 
                      return `
                      <div>
                        <div>${salonStoreStatus}</div>
                        <div>${cuisineStoreStatus}</div>
                        <div>${bureauStoreStatus}</div>
                        <div>${chambreStoreStatus}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                icon: mdi:cog-outline
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/systeme freebox
                name: FreeBox Pop
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(340deg)
                    - left: 25%
                    - top: 20%
                    - color: darkred
                    - opacity: 1
                  name:
                    - color: white
                    - top: 12%
                    - left: 5%
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                entity: sensor.system_monitor_temperature_du_processeur
                icon: phu:intel-nuc
                aspect_ratio: 1/1
                name: _____ Mini - P.C. _____
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/systeme rpi
                styles:
                  card:
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11px
                    - line-height: 1.2
                    - padding: 3%
                  grid:
                    - grid-template-areas: |
                        "i temp"
                        "n n"
                        "cpu cpu"
                        "conso conso"
                        "ram ram"
                        "sd sd"
                  name:
                    - font-weight: bold
                    - font-size: 13px
                    - color: white
                    - align-self: middle
                    - justify-self: center
                    - padding-bottom: 7px
                  icon:
                    - color: |
                        [[[
                          if (entity.state < 65) return 'rgb(70, 175, 75)';
                          if (entity.state >= 65 && entity.state < 75) return 'orange';
                          else return 'red';
                        ]]]
                    - width: 100%
                  custom_fields:
                    temp:
                      - align-self: start
                      - margin-top: 18px
                      - margin-right: 10px
                      - '--text-icon-sensor': |
                          [[[
                            if (entity.state < 65) return 'rgb(70, 175, 75)';
                            if (entity.state >= 65 && entity.state < 75) return 'orange';
                            else return 'red';
                          ]]]
                      - '--text-color-sensor': |
                          [[[
                            if (entity.state < 65) return 'rgb(255,255,255)';
                            if (entity.state >= 65 && entity.state < 75) return 'orange';
                            else return 'red';
                          ]]]
                    cpu:
                      - padding-bottom: 1px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            let val = states["sensor.system_monitor_utilisation_du_processeur"].state;
                            if (val < 75) return 'white';
                            if (val >= 75 && val < 90) return 'orange';
                            else return 'red';
                          ]]]
                    conso:
                      - padding-bottom: 1px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            let val = states["sensor.prise_mini_pc_ikea_power"].state;
                            if (val < 15) return 'white';
                            if (val >= 15 && val < 19) return 'orange';
                            else return 'red';
                          ]]]
                    ram:
                      - padding-bottom: 1px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            let val = states["sensor.system_monitor_utilisation_de_la_memoire"].state;
                            if (val < 75) return 'white';
                            if (val >= 75 && val < 90) return 'orange';
                            else return 'red';
                          ]]]
                    sd:
                      - padding-bottom: 0px
                      - align-self: middle
                      - justify-self: start
                      - '--text-color-sensor': |
                          [[[
                            let val = states["sensor.system_monitor_utilisation_du_disque"].state;
                            if (val < 75) return 'white';
                            if (val >= 75 && val < 90) return 'orange';
                            else return 'red';
                          ]]]
                custom_fields:
                  temp: |
                    [[[
                      return `<ha-icon icon="mdi:thermometer" style="width: 15px; height: 15px; color: var(--text-icon-sensor);"></ha-icon> <span style="color: var(--text-color-sensor);">${entity.state}°C</span>`
                    ]]]
                  cpu: |
                    [[[
                      return `<ha-icon icon="mdi:server" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>CPU: <span style="color: var(--text-color-sensor);">${states['sensor.system_monitor_utilisation_du_processeur'].state}%</span></span>`
                    ]]]
                  conso: |
                    [[[
                      return `<ha-icon icon="mdi:lightning-bolt-outline" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>Power: <span style="color: var(--text-color-sensor);">${states['sensor.prise_mini_pc_ikea_power'].state}W</span></span>`
                    ]]]
                  ram: |
                    [[[
                      return `<ha-icon icon="mdi:memory" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>RAM: <span style="color: var(--text-color-sensor);">${states['sensor.system_monitor_utilisation_de_la_memoire'].state}%</span></span>`
                    ]]]
                  sd: |
                    [[[
                      return `<ha-icon icon="mdi:harddisk" style="width: 15px; height: 15px; color: rgb(70, 175, 75);"></ha-icon><span>SD: <span style="color: var(--text-color-sensor);">${states['sensor.system_monitor_utilisation_du_disque'].state}%</span></span>`
                    ]]]
              - type: custom:button-card
                entity: sensor.available_updates
                icon: mdi:home-assistant
                aspect_ratio: 1/1
                name: Software | modules
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/maj
                styles:
                  card:
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: |
                        [[[
                          if (entity.state == '0') return 'white';
                          else return 'orange';
                        ]]]
                    - font-size: 12px
                    - line-height: 1.2
                    - font-weight: bold
                  grid:
                    - grid-template-areas: '''icon n'' ''updates updates'''
                    - grid-template-columns: auto 1fr
                    - grid-template-rows: 1fr min-content
                  name:
                    - font-weight: bold
                    - color: white
                    - align-self: start
                    - justify-self: center
                    - margin-right: 50px
                  custom_fields:
                    icon:
                      - width: 40px
                      - height: 40px
                      - margin-top: 0%
                      - margin-left: 250%
                      - justify-self: center
                      - color: |
                          [[[
                            if (entity.state == '0') return 'lightblue';
                            else return 'orange';
                          ]]]
                    updates:
                      - align-self: start
                      - justify-self: center
                custom_fields:
                  icon: |
                    [[[
                      return '<ha-icon icon="mdi:home-assistant" style="width: 40px; height: 40px; color: ' +
                        (entity.state == '0' ? 'lightblue' : 'orange') + ';"></ha-icon>';
                    ]]]
                  updates: |
                    [[[
                      if (entity.state == '0') return 'Tout est à jour';
                      else if (entity.state == '1') return '1 mise à jour';
                      else return entity.state + ' mises à jour';
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/battery bp
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: >
                        "title title title title title title"

                        "espace_debut espace_debut espace_debut espace_debut
                        espace_debut espace_debut"

                        "count marque 100_75_battery 75_50_battery 50_25_battery
                        25_0_battery"

                        "espace_fin espace_fin espace_fin espace_fin espace_fin
                        espace_fin"
                    - grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr
                    - grid-template-rows: auto 10px auto 18px
                    - margin-top: 4.5px
                  custom_fields:
                    title:
                      - grid-area: title
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    espace_debut:
                      - grid-area: espace_debut
                      - height: 10px
                    count:
                      - grid-area: count
                      - justify-self: start
                      - margin-left: 5px
                      - text-align: right
                    marque:
                      - grid-area: marque
                      - margin-right: '-21px'
                      - text-align: left
                    100_75_battery:
                      - grid-area: 100_75_battery
                      - justify-self: end
                      - margin-right: '-15px'
                      - text-align: right
                    75_50_battery:
                      - grid-area: 75_50_battery
                      - justify-self: end
                      - margin-right: '-9px'
                      - text-align: right
                    50_25_battery:
                      - grid-area: 50_25_battery
                      - justify-self: end
                      - margin-right: '-2px'
                      - text-align: right
                    25_0_battery:
                      - grid-area: 25_0_battery
                      - justify-self: end
                      - margin-right: 5px
                      - text-align: right
                    espace_fin:
                      - grid-area: espace_fin
                      - height: 10px
                custom_fields:
                  title: |
                    [[[
                      return 'Etat des Piles & Batteries<br><br> >100% >75% >50% >25%';
                    ]]]
                  espace_debut: |
                    [[[
                      return ' ';
                    ]]]
                  count: |
                    [[[
                      function countGroupEntities(groupName) {
                        var group = states[groupName];
                        return group ? group.attributes.entity_id.length : 0;
                      }

                      function hasBatteryBelowThreshold(groupName, threshold) {
                        var group = states[groupName];
                        if (!group) return false;
                        return group.attributes.entity_id.some(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) < threshold;
                        });
                      }

                      function getStyledCount(count, groupName) {
                        if (hasBatteryBelowThreshold(groupName, 9)) {
                          return `<span style="color: red;">${count}</span>`;
                        }
                        return count;
                      }

                      var hueCount = getStyledCount(countGroupEntities('group.hue_devices'), 'group.hue_devices');
                      var ikeaCount = getStyledCount(countGroupEntities('group.ikea_devices'), 'group.ikea_devices');
                      var sonoffCount = getStyledCount(countGroupEntities('group.sonoff_devices'), 'group.sonoff_devices');

                      return `
                      <div>
                        <div>${hueCount}</div>
                        <div>${ikeaCount}</div>
                        <div>${sonoffCount}</div>
                      </div>
                      `;
                    ]]]
                  marque: |
                    [[[
                      return `
                      <div>
                        <div>HUE</div>
                        <div>IKEA</div>
                        <div>SONOFF</div>
                      </div>
                      `;
                    ]]]
                  100_75_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: orange;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue100_75 = getStyledCount(countBatteriesInRange('group.hue_devices', 76, 99));
                      var ikea100_75 = getStyledCount(countBatteriesInRange('group.ikea_devices', 76, 99));
                      var sonoff100_75 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 76, 99));
                      return `
                      <div>
                        <div>${hue100_75}</div>
                        <div>${ikea100_75}</div>
                        <div>${sonoff100_75}</div>
                      </div>
                      `;
                    ]]]
                  75_50_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: orange;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue75_50 = getStyledCount(countBatteriesInRange('group.hue_devices', 51, 75));
                      var ikea75_50 = getStyledCount(countBatteriesInRange('group.ikea_devices', 51, 75));
                      var sonoff75_50 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 51, 75));
                      return `
                      <div>
                        <div>${hue75_50}</div>
                        <div>${ikea75_50}</div>
                        <div>${sonoff75_50}</div>
                      </div>
                      `;
                    ]]]
                  50_25_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: orange;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue50_25 = getStyledCount(countBatteriesInRange('group.hue_devices', 26, 50));
                      var ikea50_25 = getStyledCount(countBatteriesInRange('group.ikea_devices', 26, 50));
                      var sonoff50_25 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 26, 50));
                      return `
                      <div>
                        <div>${hue50_25}</div>
                        <div>${ikea50_25}</div>
                        <div>${sonoff50_25}</div>
                      </div>
                      `;
                    ]]]
                  25_0_battery: |
                    [[[
                      function countBatteriesInRange(groupName, lowerBound, upperBound) {
                        var group = states[groupName];
                        if (!group) return 0;
                        return group.attributes.entity_id.filter(entityId => {
                          var entity = states[entityId];
                          return entity && entity.state && parseInt(entity.state) <= upperBound && parseInt(entity.state) > lowerBound;
                        }).length;
                      }
                      function getStyledCount(count) {
                        if (count > 0) {
                          return `<span style="color: orange;">${count}</span>`;
                        }
                        return count;
                      }
                      var hue25_0 = getStyledCount(countBatteriesInRange('group.hue_devices', 0, 25));
                      var ikea25_0 = getStyledCount(countBatteriesInRange('group.ikea_devices', 0, 25));
                      var sonoff25_0 = getStyledCount(countBatteriesInRange('group.sonoff_devices', 0, 25));
                      return `
                      <div>
                        <div>${hue25_0}</div>
                        <div>${ikea25_0}</div>
                        <div>${sonoff25_0}</div>
                      </div>
                      `;
                    ]]]
                  espace_fin: |
                    [[[
                      return '----------------------------------------';
                    ]]]
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/phone
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 12px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: |
                        "titre titre titre"
                        "nom batterie reserve"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: title
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                      - margin-top: '-3px'
                    nom:
                      - grid-area: nom
                      - justify-self: start
                      - margin-left: 8px
                      - text-align: left
                    batterie:
                      - grid-area: batterie
                      - justify-self: null
                      - text-align: end
                    reserve:
                      - grid-area: reserve
                      - justify-self: end
                      - margin-right: 8px
                      - text-align: right
                      - margin-top: 6px
                custom_fields:
                  titre: |
                    [[[
                      return 'État Batterie Portables';
                    ]]]
                  nom: |
                    [[[
                      return `
                      <div>
                        <div>GM1901</div>
                        <div>Mamour</div>
                        <div>NE2213</div>
                        <div>SM-A53</div>
                        <div>Tablette</div>
                      </div>
                      `;
                    ]]]
                  batterie: |
                    [[[
                      function getColorForBatteryLevel(batteryLevel) {
                        if (batteryLevel >= 80) return 'green';
                        if (batteryLevel >= 50) return 'orange';
                        if (batteryLevel >= 20) return 'red';
                        return 'purple';
                      }

                      function getDeviceStatus(entityId) {
                        var state = states[entityId];
                        if (state === undefined || state.state === 'unavailable') {
                          return '<span style="color: gray;">Éteint</span>';
                        }
                        var batteryLevel = parseInt(state.state);
                        var color = getColorForBatteryLevel(batteryLevel);
                        return '<span style="color: ' + color + ';">' + state.state + '%</span>';
                      }

                      var gm1901Status = getDeviceStatus('sensor.gm1901_battery_level');
                      var ne2213MamourStatus = getDeviceStatus('sensor.ne2213_mamour_battery_level');
                      var ne2213Status = getDeviceStatus('sensor.ne2213_battery_level');
                      var smA530FStatus = getDeviceStatus('sensor.sm_a530f_battery_level');
                      var tabletteStatus = getDeviceStatus('sensor.tablette_battery_level');

                      return `
                      <div>
                        <div>${gm1901Status}</div>
                        <div>${ne2213MamourStatus}</div>
                        <div>${ne2213Status}</div>
                        <div>${smA530FStatus}</div>
                        <div>${tabletteStatus}</div>
                      </div>
                      `;
                    ]]]
                  reserve: |
                    [[[
                      function getBatteryStateIcon(entityId) {
                        var state = states[entityId]?.state;
                        if (state === undefined) return '-';
                        if (state === 'charging') return '⚡';
                        if (state === 'discharging') return '---';
                        return state;
                      }

                      var gm1901BatteryState = getBatteryStateIcon('sensor.gm1901_battery_state');
                      var ne2213MamourBatteryState = getBatteryStateIcon('sensor.ne2213_mamour_battery_state');
                      var ne2213BatteryState = getBatteryStateIcon('sensor.ne2213_battery_state');
                      var smA530FBatteryState = getBatteryStateIcon('sensor.sm_a530f_battery_state');
                      var tabletteBatteryState = getBatteryStateIcon('sensor.tablette_battery_state');

                      return `
                      <div>
                        <div>${gm1901BatteryState}</div>
                        <div>${ne2213MamourBatteryState}</div>
                        <div>${ne2213BatteryState}</div>
                        <div>${smA530FBatteryState}</div>
                        <div>${tabletteBatteryState}</div>
                      </div>
                      `;
                    ]]]
              - type: custom:button-card
                icon: phu:xiaomi-logo
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/irobot
                name: Xiaomi
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(350deg)
                    - left: 15%
                    - top: 15%
                    - color: white
                    - opacity: 1
                  name:
                    - color: white
                    - top: 12%
                    - left: 5%
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/air quality
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 11.5px
                    - line-height: 1.2
                  grid:
                    - grid-template-areas: >
                        "titre titre titre"

                        "espace_debut espace_debut espace_debut"

                        "piece_pm25_salon type_pm25_salon value_pm25_salon"

                        "piece_pm25_bureau type_pm25_bureau value_pm25_bureau"

                        "piece_pm25_chambre type_pm25_chambre
                        value_pm25_chambre"

                        "piece_tcov_salon type_tcov_salon value_tcov_salon"

                        "piece_tcov_bureau type_tcov_bureau value_tcov_bureau"

                        "piece_tcov_chambre type_tcov_chambre
                        value_tcov_chambre"
                         "espace_fin espace_fin espace_fin"
                    - grid-template-columns: 1fr 1fr 1fr
                    - grid-template-rows: auto
                    - margin-top: 4.5px
                  custom_fields:
                    titre:
                      - grid-area: title
                      - justify-self: center
                      - text-align: center
                      - font-weight: bold
                    espace_debut:
                      - grid-area: espace_debut
                      - height: 10px
                    piece_pm25_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_pm25_bureau:
                      - justify-self: start
                      - margin-left: 4px
                    piece_pm25_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_tcov_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_tcov_bureau:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    piece_tcov_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 4px
                    type_pm25_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 6px
                    type_pm25_bureau:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 6px
                    type_pm25_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 6px
                    type_tcov_salon:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 7px
                    type_tcov_bureau:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 7px
                    type_tcov_chambre:
                      - text-align: center
                      - justify-self: start
                      - margin-left: 7px
                    value_pm25_salon:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 8px
                    value_pm25_bureau:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 8px
                    value_pm25_chambre:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 8px
                    value_tcov_salon:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 14px
                    value_tcov_bureau:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 15px
                    value_tcov_chambre:
                      - text-align: center
                      - justify-self: end
                      - margin-right: 14px
                    espace_fin:
                      - grid-area: espace_fin
                      - height: 10px
                custom_fields:
                  titre: |
                    [[[
                      return 'Info Qualitée d\'Air';
                    ]]]
                  espace_debut: |
                    [[[
                      return ' ';
                    ]]]
                  piece_pm25_salon: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_salon_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">Salon</span>';
                    ]]]
                  piece_pm25_bureau: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_bureau_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">Bureau</span>';
                    ]]]
                  piece_pm25_chambre: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_chambre_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">Chambre</span>';
                    ]]]
                  piece_tcov_salon: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_salon_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">Salon</span>';
                    ]]]
                  piece_tcov_bureau: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_bureau_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">Bureau</span>';
                    ]]]
                  piece_tcov_chambre: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_chambre_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">Chambre</span>';
                    ]]]
                  type_pm25_salon: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_salon_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">PM2.5</span>';
                    ]]]
                  type_pm25_bureau: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_bureau_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">PM2.5</span>';
                    ]]]
                  type_pm25_chambre: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_chambre_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">PM2.5</span>';
                    ]]]
                  type_tcov_salon: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_salon_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">tCOV</span>';
                    ]]]
                  type_tcov_bureau: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_bureau_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">tCOV</span>';
                    ]]]
                  type_tcov_chambre: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_chambre_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">tCOV</span>';
                    ]]]
                  value_pm25_salon: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_salon_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">' + pm25Value + ' µg/m³</span>';
                    ]]]
                  value_pm25_bureau: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_bureau_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">' + pm25Value + ' µg/m³</span>';
                    ]]]
                  value_pm25_chambre: |
                    [[[
                      var pm25Value = states['sensor.qualite_air_chambre_ikea_pm25'].state;
                      var color = pm25Value > 35 ? 'red' : pm25Value > 11 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">' + pm25Value + ' µg/m³</span>';
                    ]]]
                  value_tcov_salon: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_salon_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">' + tcovValue + ' ppb</span>';
                    ]]]
                  value_tcov_bureau: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_bureau_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">' + tcovValue + ' ppb</span>';
                    ]]]
                  value_tcov_chambre: |
                    [[[
                      var tcovValue = states['sensor.qualite_air_chambre_ikea_voc_index'].state;
                      var color = tcovValue > 1000 ? 'red' : tcovValue > 250 ? 'orange' : 'white';
                      return '<span style="color: ' + color + ';">' + tcovValue + ' ppb</span>';
                    ]]]
                  espace_fin: |
                    [[[
                      return ' ';
                    ]]]
              - type: custom:button-card
                icon: mdi:face-mask-outline
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/pollen pollution
                name: |-
                  [[[
                    var airQuality = states['sensor.qualite_globale_vence'].state;
                    var pollenAlert = states['sensor.qualite_globale_pollen_vence'].state;

                    function getColor(value) {
                      var severity = [
                        { color: 'grey', from: 0, to: 0 },
                        { color: 'green', from: 1, to: 1 },
                        { color: 'lightgreen', from: 2, to: 2 },
                        { color: 'gold', from: 3, to: 3 },
                        { color: 'orange', from: 4, to: 4 },
                        { color: 'red', from: 5, to: 5 },
                        { color: 'darkred', from: 6, to: 6 },
                        { color: 'purple', from: 7, to: 7 }
                      ];

                      var color = severity.find(function(range) {
                        return value >= range.from && value <= range.to;
                      });

                      return color ? color.color : 'black';
                    }

                    var airColor = getColor(airQuality);
                    var pollenColor = getColor(pollenAlert);

                    return `<div style="text-align: left; color: white; font-size: 13px;margin-bottom: 4px;">Pollution / Pollen</div>
                                  <div><span style="color: ${airColor}; font-weight: bold;">Niveau ${airQuality}</span> /
                                  <span style="color: ${pollenColor}; font-weight: bold;">Niveau ${pollenAlert}</span></div>`;
                  ]]]
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(350deg)
                    - left: 15%
                    - top: 15%
                    - color: white
                    - opacity: 1
                  name:
                    - color: white
                    - top: 10px
                    - left: 10px
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
              - type: custom:button-card
                icon: |
                  [[[
                    // Récupère l'entité
                    var sensor = states['sensor.alert_level_in_vence'];
                    // Récupère le nom de l'icône ou une icône par défaut
                    var iconName = sensor && sensor.attributes && sensor.attributes.icon ? sensor.attributes.icon : 'mdi:water-outline';
                    return iconName;
                  ]]]
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/vigieau
                name: |
                  [[[
                    var sensor = states['sensor.alert_level_in_vence'];
                    var alertLevel = sensor.state;
                    var alertColor = (sensor.attributes && sensor.attributes.Couleur) ? sensor.attributes.Couleur : 'grey';
                    switch(alertLevel) {
                      case 'vigilance (pas de restriction)':
                        alertLevel = 'Aucune restriction';
                      case 'alerte_renforcee':
                        alertLevel = 'Alerte renforcée';
                        break;
                    }

                    return `<div style="text-align: left; color: white; font-size: 13px; margin-bottom: 4px;">Vigieau / Vigi-Eau</div>
                            <div><span style="color: ${alertColor}; font-weight: bold;">${alertLevel}</span></div>`;
                  ]]]
                size: 60%
                styles:
                  card:
                    - aspect-ratio: 1/1
                    - border-radius: 10px
                    - background: transparent
                    - border-width: 3px
                    - border-color: white
                    - border-style: double
                    - color: white
                    - font-size: 15px
                    - line-height: 1.2
                  icon:
                    - transform: rotate(350deg)
                    - left: 15%
                    - top: 15%
                    - color: |
                        [[[
                            var sensor = states['sensor.alert_level_in_vence'];
                            return (sensor && sensor.attributes && sensor.attributes.Couleur) ? sensor.attributes.Couleur : 'white';
                        ]]]
                  name:
                    - color: white
                    - top: 10px
                    - left: 10px
                    - font-size: 80%
                    - font-weight: bold
                    - position: absolute
            columns: 3
    cards: []
    badges: []
  - title: Météo
    path: meteo
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:clouds
            heading: METEO
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_temperature
                color: green
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:bubble-card
            card_type: separator
            name: Appartement
            icon: mdi:home-assistant
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: horizontal-stack
            cards:
              - type: markdown
                content: >
                  <center>Température: <ha-icon
                  icon="mdi:home-thermometer"></ha-icon> {{
                  states("sensor.th_balcon_nord_temperature") |
                  round(0)}}°C</center>
                card_mod:
                  style: |
                    ha-card {
                      font-size: 19px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: markdown
                content: >
                  <center>Humidité: <ha-icon icon="mdi:water-percent"></ha-icon>
                  {{ states("sensor.th_balcon_nord_humidity") | round(0)
                  }}%</center>
                card_mod:
                  style: |
                    ha-card {
                      font-size: 19px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: custom:bubble-card
            card_type: separator
            name: Prévision Météo France & Carte Windy
            icon: mdi:sun-snowflake
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: vertical-stack
            cards:
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: weather-forecast
                    show_current: true
                    show_forecast: true
                    entity: weather.vence
                    forecast_type: hourly
                    card_mod:
                      style: |
                        .temp-attribute {
                          color:green;
                        }
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:swipe-card
                    parameters:
                      allowTouchMove: false
                      effect: coverflow
                      centeredSlides: true
                      slidesPerView: auto
                      spaceBetween: 8
                      pagination:
                        type: progressbar
                      navigation: null
                      keyboard:
                        enabled: true
                        onlyInViewport: true
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                    navigation: null
                    cards:
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=5&overlay=radar&product=radar&level=surface&lat=43.612&lon=7.207
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed2.html?lat=43&lon=7&detailLat=43&detailLon=7&zoom=5&level=surface&overlay=rain&product=ecmwf&menu=&message=&marker=&calendar=24&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed2.html?lat=43&lon=7&detailLat=43&detailLon=7&zoom=5&level=surface&overlay=temp&product=ecmwf&menu=&message=&marker=&calendar=24&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed2.html?lat=43&lon=7&detailLat=43&detailLon=7&zoom=5&level=surface&overlay=wind&product=ecmwf&menu=&message=&marker=&calendar=24&pressure=&type=map&location=coordinates&detail=&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              overflow: hidden;
                              pointer-events: none;
                            }
                  - type: weather-forecast
                    show_current: false
                    show_forecast: true
                    entity: weather.vence
                    forecast_type: daily
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: heading
            icon: mdi:compass-rose
            heading: Vitesse du Vent - Baromètre - U.V. - Pluie
            heading_style: title
            badges: []
            tap_action:
              action: none
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: separator
                name: Vent
                icon: mdi:compass-outline
                rows: 2
                styles: |-
                  .bubble-line {
                    background: var(--primary-text-color);
                    opacity: 1;
                  }
                card_layout: normal
              - type: custom:windrose-card
                title: Direction et Vitesse du Vent avec Rafales
                max_width: 300
                windspeed_bar_location: bottom
                windspeed_bar_full: true
                wind_direction_entity:
                  entity: sensor.direction_du_vent_vence
                  use_statistics: false
                  direction_compensation: 0
                windspeed_entities:
                  - entity: weather.vence
                    attribute: wind_speed
                    name: Moyenne
                    speed_unit: auto
                    speed_range_beaufort: false
                    speed_range_step: 5
                    speed_range_max: 35
                    current_speed_arrow: true
                    current_speed_arrow_size: 60
                    current_speed_arrow_location: below
                  - entity: sensor.vence_wind_gust
                    name: Rafale
                    speed_unit: auto
                    speed_range_beaufort: false
                    current_speed_arrow: true
                    current_speed_arrow_size: 60
                    current_speed_arrow_location: below
                wind_direction_unit: degrees
                input_speed_unit: auto
                output_speed_unit: kph
                direction_labels:
                  cardinal_direction_letters: NESO
                  show_cardinal_directions: true
                  show_intercardinal_directions: true
                  show_secondary_intercardinal_directions: true
                  cardinal_directions_text_size: 60
                  intercardinal_directions_text_size: 45
                  secondary_intercardinal_directions_text_size: 30
                  custom_labels:
                    'n': Nord
                    e: Est
                    s: Sud
                    w: Ouest
                    ne: NE
                    se: SE
                    sw: SO
                    nw: 'NO'
                    nne: NNE
                    ene: ENE
                    ese: ESE
                    sse: SSE
                    ssw: SSO
                    wsw: OSO
                    wnw: ONO
                    nnw: NNO
                matching_strategy: full-time
                direction_speed_time_diff: 1
                center_calm_percentage: true
                center_circle_size: 30
                colors:
                  rose_lines: rgb(0,255,0)
                  rose_cardinal_direction_labels: white
                  rose_intercardinal_direction_labels: white
                  rose_secondary_intercardinal_direction_labels: white
                  rose_center_percentage: white
                  rose_percentages: white
                  rose_current_direction_arrow: red
                  bar_border: hsl(200, 100%, 60%)
                  bar_unit_name: white
                  bar_name: white
                  bar_unit_values: white
                  bar_percentages: auto
                data_period:
                  period_selector:
                    location: top
                    active_color: black
                    active_bg_color: white
                    color: white
                    bg_color: black
                    buttons:
                      - hours: 24
                        title: 1 day
                        active: true
                      - hours: 168
                        title: 7 days
                      - hours: 360
                        title: 15 days
                      - hours: 730
                        title: 30 days
                refresh_interval: 60
                windrose_draw_north_offset: 0
                current_direction:
                  entity: sensor.vence_wind_speed
                  show_arrow: true
                  arrow_size: 100
                  center_circle_size: 30
                  hide_direction_below_speed: 1
                compass_direction:
                  entity: sensor.direction_du_vent_vence
                  auto_rotate: false
                  as_heading: false
                corner_info:
                  top_left:
                    label: Vitesse de la rafale actuelle
                    unit: ' km/h'
                    entity: sensor.vence_wind_gust
                    label_text_size: 50
                    value_text_size: 60
                    input_unit: kph
                    output_unit: kph
                    precision: 1
                  top_right:
                    label: Direction du Vent
                    color: white
                    entity: sensor.direction_du_vent_vence_lable
                    label_text_size: 50
                    value_text_size: 60
                  bottom_left:
                    label: Boussole
                    unit: °
                    entity: sensor.direction_du_vent_vence
                    label_text_size: 40
                  bottom_right:
                    label: Vitesse du Vent
                    unit: ' km/h'
                    entity: sensor.vitesse_du_vent_vence
                    label_text_size: 40
                actions:
                  top_left:
                    tap_action:
                      action: none
                  top_right:
                    double_tap_action:
                      action: none
                  windrose:
                    tap_action:
                      action: none
                  bottom_right:
                    tap_action:
                      action: mone
                  bottom_left:
                    tap_action:
                      action: none
                  speed_bar_1:
                    tap_action:
                      action: none
                  speed_bar_2:
                    tap_action:
                      action: none
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: vertical-stack
                cards: []
              - type: custom:bubble-card
                card_type: separator
                name: Baromètre
                icon: mdi:clouds
                rows: 2
                styles: |-
                  .bubble-line {
                    background: var(--primary-text-color);
                    opacity: 1;
                  }
                card_layout: normal
              - type: vertical-stack
                cards:
                  - card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: vertical-stack
                            cards:
                              - type: custom:tempometer-gauge-card
                                entity: sensor.vence_pressure
                                min: 980
                                entity_min: sensor.vence_pressure_mini
                                max: 1050
                                entity_max: sensor.vence_pressure_maxi
                                title: Baromètre
                                icon_color: white
                                decimals: 0
                                severity:
                                  green: 1020
                                  yellow: 1000
                                  red: 900
                                card_mod:
                                  style: |
                                    ha-card {
                                      border: none !important;
                                    }
                              - type: markdown
                                content: >
                                  <div style="display: flex; justify-content:
                                  center; align-items: center;">
                                    <span>Mini.: {{ states('sensor.vence_pressure_mini') }} hPa</span>
                                    <span> - Maxi.: {{ states('sensor.vence_pressure_maxi') }} hPa /24h</span>
                                  </div>
                                card_mod:
                                  style: |
                                    ha-card {
                                      margin-top: -30px;
                                      font-size: 10px;
                                      background: none !important;
                                      border: none !important;
                                      text-align: center; 
                                    }
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:bubble-card
                            card_type: separator
                            name: UV
                            icon: mdi:sunglasses
                            rows: 1
                            styles: |
                              .bubble-line {
                                background: var(--primary-text-color);
                                opacity: 1;
                              }
                          - type: custom:bubble-card
                            card_type: separator
                            name: Pluie
                            icon: mdi:weather-pouring
                            rows: 1
                            styles: |
                              .bubble-line {
                                background: var(--primary-text-color);
                                opacity: 1;
                              }
              - type: vertical-stack
                cards:
                  - card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:uv-index-card
                            entity: sensor.vence_uv
                            name: ''
                            icon: mdi:weather-sunny
                            card_mod:
                              style: |
                                ha-card {
                                  font-size: 15px;
                                  border: none !important;
                                  text-align: center;
                                }
                                ha-card > div > div:nth-child(1) > svg {
                                  width: 80%;
                                  margin-top: 25px;
                                  border: none !important;
                                } 
                          - type: custom:rain-gauge-card
                            entity: sensor.vence_daily_precipitation
                            fill_drop_colour: '#44739E'
                            max_level: 60
                            border_colour: grey
                            name: ''
                            icon: mdi:weather-rainy
                            card_mod:
                              style: |
                                ha-card {
                                  margin-top: 20px;
                                  font-size: 15px; 
                                  border: none !important;
                                  text-align: center;
                                }
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:bubble-card
                            card_type: separator
                            name: Pluie ces dernières 24 heures (Météo France)
                            icon: mdi:weather-pouring
                            rows: 2
                            styles: |
                              .bubble-line {
                                background: var(--primary-text-color);
                                opacity: 1;
                              }
              - type: vertical-stack
                cards:
                  - card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
                    type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: horizontal-stack
                        cards:
                          - type: custom:apexcharts-card
                            graph_span: 24h
                            header:
                              show: false
                              title: ''
                            series:
                              - entity: sensor.vence_daily_precipitation
                                stroke_width: 2
                                type: area
                                color: '#44739E'
                                opacity: 0.5
                                group_by:
                                  func: avg
                                  duration: 1m
                            card_mod:
                              style: |
                                ha-card {
                                  background: none !important;
                                  border: none !important;
                                }
              - type: vertical-stack
                cards: []
          - type: heading
            heading_style: title
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#foudre'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Impacts de foudre (50 Km)
                icon: mdi:weather-lightning
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                button_action: null
              - type: vertical-stack
                cards:
                  - type: conditional
                    conditions:
                      - condition: numeric_state
                        entity: sensor.blitzortung_lightning_counter
                        above: 1
                    card:
                      type: custom:button-card
                      entity: sensor.blitzortung_lightning_counter
                      name: |
                        [[[
                          // Récupère la distance de l'impact de foudre
                          let distance = states['sensor.blitzortung_lightning_distance'] ? parseFloat(states['sensor.blitzortung_lightning_distance'].state) : 0;

                          // Récupère la localisation de l'impact, si disponible
                          let localisation = states['sensor.blitzortung_lightning_localisation'] ? states['sensor.blitzortung_lightning_localisation'].state : 0;

                          // Récupère l'azimut (direction) de l'impact, si disponible
                          let azimuth = states['sensor.blitzortung_lightning_azimuth'] ? parseFloat(states['sensor.blitzortung_lightning_azimuth'].state) : null;

                          // Récupère le nombre total d'impacts détectés
                          let impactCount = states['sensor.blitzortung_lightning_counter'] ? parseInt(states['sensor.blitzortung_lightning_counter'].state) : 0;

                          // Récupère le temps écoulé depuis le dernier impact de foudre
                          let timeSinceLastLightning = states['input_text.dernier_impact_de_foudre_temps_ecoule'] ? states['input_text.dernier_impact_de_foudre_temps_ecoule'].state : 'Inconnu';
                          // Initialise le message à afficher
                          let message = '';

                          // Vérifie si une distance est disponible
                          if (distance > 0) {
                            message = `Un éclair a été détecté à ${distance} Km de la maison`;

                            // Vérifie si une localisation (ville) est disponible et différente de 0
                            let city = null;
                            if (localisation && localisation !== 0) {
                              let location = states['sensor.blitzortung_lightning_localisation'].attributes.features;
                              if (location && location[0] && location[0].properties && location[0].properties.geocoding && location[0].properties.geocoding.city) {
                                city = location[0].properties.geocoding.city;
                                message += ` à ${city}.`;
                              }
                            }

                            // Vérifie l'azimut pour déterminer la direction seulement si la ville n'est pas disponible
                            if (city === null && azimuth !== null) {
                              if (azimuth >= 348.75 || azimuth < 11.25) {
                                message += ' au nord.';
                              } else if (azimuth >= 11.25 && azimuth < 33.75) {
                                message += ' au nord-nord-est.';
                              } else if (azimuth >= 33.75 && azimuth < 56.25) {
                                message += ' au nord-est.';
                              } else if (azimuth >= 56.25 && azimuth < 78.75) {
                                message += ' à l\'est-nord-est.';
                              } else if (azimuth >= 78.75 && azimuth < 101.25) {
                                message += ' à l\'est.';
                              } else if (azimuth >= 101.25 && azimuth < 123.75) {
                                message += ' à l\'est-sud-est.';
                              } else if (azimuth >= 123.75 && azimuth < 146.25) {
                                message += ' au sud-est.';
                              } else if (azimuth >= 146.25 && azimuth < 168.75) {
                                message += ' au sud-sud-est.';
                              } else if (azimuth >= 168.75 && azimuth < 191.25) {
                                message += ' au sud.';
                              } else if (azimuth >= 191.25 && azimuth < 213.75) {
                                message += ' au sud-sud-ouest.';
                              } else if (azimuth >= 213.75 && azimuth < 236.25) {
                                message += ' au sud-ouest.';
                              } else if (azimuth >= 236.25 && azimuth < 258.75) {
                                message += ' à l\'ouest-sud-ouest.';
                              } else if (azimuth >= 258.75 && azimuth < 281.25) {
                                message += ' à l\'ouest.';
                              } else if (azimuth >= 281.25 && azimuth < 303.75) {
                                message += ' à l\'ouest-nord-ouest.';
                              } else if (azimuth >= 303.75 && azimuth < 326.25) {
                                message += ' au nord-ouest.';
                              } else if (azimuth >= 326.25 && azimuth < 348.75) {
                                message += ' au nord-nord-ouest.';
                              }
                            }
                          } else {
                            message = 'Pas d\'impact de foudre détecté.';
                          }
                          // Ajoute le temps écoulé au message
                          message += `<br>${timeSinceLastLightning}.`;

                          // Retourne le message final avec le nombre total d'impacts, sauf si aucun impact n'est détecté
                          if (impactCount > 0) {
                            return `${message}<br><strong>${impactCount}</strong> impact(s) détecté(s)`;
                          } else {
                            return message;
                          }
                        ]]]
                      show_state: false
                      color_type: card
                      styles:
                        card:
                          - animation: blink 0s ease infinite
                        name:
                          - font-weight: bold
                          - font-size: 13px
                          - margin-top: 9px
                        icon:
                          - width: 50px
                          - height: 50px
                      color: rgb(255, 123, 0)
                      icon: mdi:weather-lightning
                      hide_state: false
                      vertical: false
                      show_entity_picture: false
                      tap_action:
                        action: none
                      icon_tap_action:
                        action: none
                      hold_action:
                        action: none
                      card_mod:
                        style: |
                          ha-card {
                            box-shadow: none !important;
                            
                            border: none !important;
                          }
                  - type: conditional
                    conditions:
                      - condition: numeric_state
                        entity: sensor.blitzortung_lightning_counter
                        below: 1
                    card:
                      type: custom:button-card
                      entity: sensor.blitzortung_lightning_counter
                      name: |
                        [[[
                          let timeSinceLastLightning = states['input_text.dernier_impact_de_foudre_temps_ecoule'] ? states['input_text.dernier_impact_de_foudre_temps_ecoule'].state : 'Inconnu';
                          let message = 'Pas d\'impact de foudre détecté.';
                          message += `<br>${timeSinceLastLightning}.`;
                          return message;
                        ]]]
                      show_state: false
                      color_type: card
                      styles:
                        name:
                          - font-weight: bold
                          - font-size: 12px
                        icon:
                          - width: 30px
                          - height: 30px
                      color: rgb(0, 255, 0)
                      icon: mdi:weather-sunny
                      hide_state: true
                      vertical: false
                      show_entity_picture: false
                      tap_action:
                        action: none
                      icon_tap_action:
                        action: none
                      hold_action:
                        action: none
                      card_mod:
                        style: |
                          ha-card {
                            box-shadow: none !important;
                            
                            border: none !important;
                          }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Compteur des points d'impacts
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_hourly
                            name: Heure
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 3000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 428
                          - color: gold
                            from: 429
                            to: 857
                          - color: orange
                            from: 858
                            to: 1285
                          - color: darkorange
                            from: 1286
                            to: 1714
                          - color: red
                            from: 1715
                            to: 2142
                          - color: darkred
                            from: 2143
                            to: 2571
                          - color: purple
                            from: 2572
                            to: 3000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_daily
                            name: Jour
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 30000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 4285
                          - color: gold
                            from: 4286
                            to: 8571
                          - color: orange
                            from: 8572
                            to: 12857
                          - color: darkorange
                            from: 12858
                            to: 17142
                          - color: red
                            from: 17143
                            to: 21428
                          - color: darkred
                            from: 21429
                            to: 25714
                          - color: purple
                            from: 25715
                            to: 30000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_weekly
                            name: Semaine
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 50000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 7142
                          - color: gold
                            from: 7143
                            to: 14285
                          - color: orange
                            from: 14286
                            to: 21428
                          - color: darkorange
                            from: 21429
                            to: 28571
                          - color: red
                            from: 28572
                            to: 35714
                          - color: darkred
                            from: 35715
                            to: 42857
                          - color: purple
                            from: 42858
                            to: 50000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_monthly
                            name: Mois
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 70000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 10000
                          - color: gold
                            from: 10001
                            to: 20000
                          - color: orange
                            from: 20001
                            to: 30000
                          - color: darkorange
                            from: 30001
                            to: 40000
                          - color: red
                            from: 40001
                            to: 50000
                          - color: darkred
                            from: 50001
                            to: 60000
                          - color: purple
                            from: 60001
                            to: 70000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.eclair_yearly
                            name: Année
                        icon: mdi:flash-alert
                        direction: up
                        height: 168px
                        width: 70px
                        columns: 1
                        min: 0
                        max: 100000
                        stack: horizontal
                        positions:
                          indicator: 'off'
                          icon: 'off'
                        severity:
                          - color: Green
                            from: 0
                            to: 14285
                          - color: gold
                            from: 14286
                            to: 28571
                          - color: orange
                            from: 28572
                            to: 42857
                          - color: darkorange
                            from: 42858
                            to: 57142
                          - color: red
                            from: 57143
                            to: 71428
                          - color: darkred
                            from: 71429
                            to: 85714
                          - color: purple
                            from: 85715
                            to: 100000
                        card_mod:
                          style: >
                            bar-card-currentbar, bar-card-backgroundbar {
                              border-radius: 10px;
                            }

                            states > bar-card-row > bar-card-card >
                            bar-card-background >

                            bar-card-contentbar > bar-card-name {
                              font-weight: bold;
                              font-size: 11px;
                            }

                            bar-card-name {
                              margin-top: 10px;
                              margin-left: 5px;
                            }

                            ha-card {
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              margin: 0px 0px 0px 0px;
                              display: flex;
                              justify-content: center;
                              align-items: center;
                            }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Direction et distance du dernier point d'impact
              - type: custom:windrose-card
                max_width: 300
                windspeed_bar_location: bottom
                windspeed_bar_full: true
                wind_direction_entity:
                  entity: sensor.lightning_bearing
                  use_statistics: false
                  direction_compensation: 0
                windspeed_entities:
                  - entity: sensor.lightning_distance_km
                    name: Distance
                    speed_unit: kph
                    speed_range_beaufort: false
                    speed_range_step: 10
                    speed_range_max: 40
                    current_speed_arrow: true
                    current_speed_arrow_size: 60
                    current_speed_arrow_location: below
                wind_direction_unit: degrees
                input_speed_unit: kph
                output_speed_unit: kph
                direction_labels:
                  cardinal_direction_letters: NESO
                  show_cardinal_directions: true
                  show_intercardinal_directions: true
                  show_secondary_intercardinal_directions: true
                  cardinal_directions_text_size: 60
                  intercardinal_directions_text_size: 45
                  secondary_intercardinal_directions_text_size: 30
                  custom_labels:
                    'n': Nord
                    e: Est
                    s: Sud
                    w: Ouest
                    ne: NE
                    se: SE
                    sw: SO
                    nw: 'NO'
                    nne: NNE
                    ene: ENE
                    ese: ESE
                    sse: SSE
                    ssw: SSO
                    wsw: OSO
                    wnw: ONO
                    nnw: NNO
                matching_strategy: full-time
                direction_speed_time_diff: 1
                center_calm_percentage: true
                center_circle_size: 30
                colors:
                  rose_lines: rgb(0,255,0)
                  rose_cardinal_direction_labels: white
                  rose_intercardinal_direction_labels: white
                  rose_secondary_intercardinal_direction_labels: white
                  rose_center_percentage: white
                  rose_percentages: white
                  rose_current_direction_arrow: purple
                  bar_border: hsl(200, 100%, 60%)
                  bar_unit_name: white
                  bar_name: white
                  bar_unit_values: white
                  bar_percentages: auto
                data_period:
                  period_selector:
                    location: top
                    active_color: black
                    active_bg_color: white
                    color: white
                    bg_color: black
                    buttons:
                      - hours: 24
                        title: 1 jour
                        active: true
                      - hours: 168
                        title: 7 jours
                      - hours: 360
                        title: 15 jours
                      - hours: 730
                        title: 30 jours
                refresh_interval: 60
                windrose_draw_north_offset: 0
                current_direction:
                  entity: sensor.lightning_bearing
                  show_arrow: true
                  arrow_size: 100
                  center_circle_size: 30
                  hide_direction_below_speed: 1
                compass_direction:
                  entity: sensor.lightning_bearing
                  auto_rotate: false
                  as_heading: false
                corner_info:
                  top_left:
                    label: Distance de l'éclair
                    unit: ' km'
                    entity: sensor.lightning_distance_km
                    label_text_size: 50
                    value_text_size: 60
                    input_unit: kph
                    output_unit: kph
                    precision: 1
                  top_right:
                    label: Direction de l'éclair
                    color: white
                    entity: sensor.direction_de_l_eclair_label
                    label_text_size: 50
                    value_text_size: 60
                  bottom_left:
                    label: Boussole
                    unit: °
                    entity: sensor.lightning_bearing
                    label_text_size: 40
                  bottom_right:
                    label: Compteur d'éclairs
                    unit: ' ↯'
                    entity: sensor.eclair_daily
                    label_text_size: 40
                actions:
                  top_left:
                    tap_action:
                      action: none
                  top_right:
                    double_tap_action:
                      action: none
                  windrose:
                    tap_action:
                      action: none
                  bottom_right:
                    tap_action:
                      action: none
                  bottom_left:
                    tap_action:
                      action: none
                  speed_bar_1:
                    tap_action:
                      action: none
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
                    .sensor-1 {
                      line-height: 18px;
                    }
                    .sensor-1 .value {
                      font-weight: bold;
                      font-size: 18px !important;
                    }
                    .sensor-0 .value {
                      {% if is_state('sensor.lightning_distance_km', 'unknown') %}
                        font-size: 0px !important;
                      {% else %}
                        font-weight: bold;
                        font-size: 26px !important;
                      {% endif %}
                    }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Graphiques des points d'impact par période
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                span:
                  end: day
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: Nombre d'éclaires heure par heure
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Eclaires
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: diff
                    duration: 1h
                    start_with_last: true
                  show:
                    legend_value: true
                    extremas: true
                series:
                  - entity: sensor.eclair_yearly
                    yaxis_id: Eclaires
                    name: Nb éclaires ce jours
                    color: gainsboro
                    type: column
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 429
                        color: gold
                      - value: 858
                        color: orange
                      - value: 1286
                        color: darkorange
                      - value: 1715
                        color: red
                      - value: 2143
                        color: darkred
                      - value: 2572
                        color: purple
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 730h
                span:
                  end: day
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: Nombre d'éclaires par jour du mois en cours
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Eclaires
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: diff
                    duration: 24h
                    start_with_last: true
                  show:
                    legend_value: true
                    extremas: true
                series:
                  - entity: sensor.eclair_yearly
                    yaxis_id: Eclaires
                    name: Nb éclaires ce jours
                    color: gainsboro
                    type: column
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 4286
                        color: gold
                      - value: 8572
                        color: orange
                      - value: 12858
                        color: darkorange
                      - value: 17143
                        color: red
                      - value: 21429
                        color: darkred
                      - value: 25715
                        color: purple
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                type: custom:stack-in-card
                mode: vertical
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style:
                            .: |
                              :host {
                                --text-divider-color: white;
                                --text-divider-line-size: 1px;
                              }
                        card:
                          type: custom:text-divider-row
                          text: Cartes des orages et des impacts de foudre
              - type: custom:stack-in-card
                mode: horizontal
                keep:
                  box_shadow: false
                  margin: false
                  border_radius: false
                  background: false
                  outer_padding: false
                cards:
                  - type: custom:swipe-card
                    parameters:
                      allowTouchMove: false
                      effect: coverflow
                      centeredSlides: true
                      slidesPerView: auto
                      spaceBetween: 8
                      pagination:
                        type: progressbar
                      navigation: null
                      keyboard:
                        enabled: true
                        onlyInViewport: true
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                    navigation: null
                    cards:
                      - type: iframe
                        url: >-
                          https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=default&metricTemp=default&metricWind=default&zoom=5&overlay=radar&product=radar&level=surface&lat=43.612&lon=7.207
                        aspect_ratio: 99%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                              pointer-events: none;
                            }
                      - type: iframe
                        url: https://map.blitzortung.org/#6.70/43.7221/7.10878
                        aspect_ratio: 100%
                        card_mod:
                          style: |
                            ha-card {
                              filter: invert(0%);
                              background: none !important;
                              box-shadow: none !important;
                              border: none !important;
                            }
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#alert'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Carte d'alerte(s) Météo France
                icon: mdi:alert-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                button_action: null
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 1px;
                            }
                              ha-card {
                                top: 10px;
                                border: none !important;
                                box-shadow: none !important;
                                background: none !important;
                              }
                        card:
                          type: custom:text-divider-row
                          text: CARTES
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            ha-card {
                              margin: -30px 5px -23px 5px;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                        card:
                          type: horizontal-stack
                          cards:
                            - type: custom:button-card
                              entity: camera.mf_alerte_today
                              name: Alerte météo <br/>Aujourd'hui
                              show_icon: false
                              show_entity_picture: true
                              aspect_ratio: 1/1
                              size: 100%
                              styles:
                                card:
                                  - '--mdc-ripple-color': none
                                  - padding: 15%
                              card_mod:
                                style: |
                                  ha-card {
                                    border: none !important;
                                    box-shadow: none !important;
                                    background: none !important;
                                  }
                            - type: custom:button-card
                              entity: camera.mf_alerte_tomorrow
                              name: Alerte météo <br/>Demain
                              aspect_ratio: 1/1
                              show_icon: false
                              show_entity_picture: true
                              size: 100%
                              styles:
                                card:
                                  - '--mdc-ripple-color': none
                                  - padding: 15%
                              card_mod:
                                style: |
                                  ha-card {
                                    border: none !important;
                                    box-shadow: none !important;
                                    background: none !important;
                                  }
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_meteo
                    secondary: Météo
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_orages
                    secondary: Orages
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_pluie_inondation
                    secondary: Pluie Inondation
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_vent_violent
                    secondary: Vent violent
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_avalanches
                    secondary: Avalanches
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: horizontal-stack
                cards:
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_canicule
                    secondary: Canicule
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_inondation
                    secondary: Inondation
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_neige_verglas
                    secondary: Neige
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_grand_froid
                    secondary: Grand Froid
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
                  - type: custom:mushroom-template-card
                    primary: ''
                    icon: '{{ state_attr(entity, ''icon'') }}'
                    icon_color: |-
                      {% if states(entity) == 'Vert' %}
                       green
                      {% elif states(entity) == 'Jaune' %}
                       yellow
                      {% elif states(entity) == 'Orange' %}
                       orange
                      {% elif states(entity) == 'Rouge' %}
                       red
                      {% endif %}
                    entity: sensor.alerte_vagues_submersion
                    secondary: Vagues submersion
                    layout: vertical
                    hold_action:
                      action: none
                    double_tap_action:
                      action: none
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                        }
              - type: custom:meteoalarm-card
                entities:
                  - entity: sensor.06_weather_alert
                integration: meteofrance
                hide_when_no_warning: true
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#sun'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Lever et coucher du Soleil
                icon: mdi:sun-clock-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
                button_action: null
              - type: vertical-stack
                cards:
                  - type: custom:stack-in-card
                    mode: vertical
                    keep:
                      box_shadow: false
                      margin: false
                      border_radius: false
                      background: false
                      outer_padding: false
                    cards:
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 1px;
                            }
                        card:
                          type: custom:text-divider-row
                          text: Suivi du soleil
                      - type: custom:horizon-card
                        title: ' '
                        moon: true
                        refresh_period: 60
                        fields:
                          sunrise: true
                          sunset: true
                          dawn: true
                          noon: true
                          dusk: true
                          azimuth: true
                          sun_azimuth: true
                          moon_azimuth: true
                          elevation: true
                          sun_elevation: true
                          moon_elevation: true
                          moonrise: true
                          moonset: true
                          moon_phase: true
                        southern_flip: false
                        moon_phase_rotation: -10
                        language: fr
                        time_format: fr
                        number_format: fr
                        latitude: 43.716667
                        longitude: 7.116667
                        elevation: 330
                        time_zone: Europe/paris
                        no_card: false
                        debug_level: 0
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                            }
                      - type: custom:mod-card
                        card_mod:
                          style: |
                            :host {
                              --text-divider-color: white;
                              --text-divider-line-size: 1px;
                            }
                        card:
                          type: custom:text-divider-row
                          text: Cycles
                      - type: glance
                        entities:
                          - entity: sun.sun
                            name: Soleil
                          - entity: sensor.season
                            name: Saison
                        state_color: true
                        show_name: true
                        show_state: true
                        card_mod:
                          style: |
                            ha-card {
                              border: none !important;
                            }
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          box-shadow: none !important;
                          background: none !important;
                          margin: 0;
                          padding: 0;
                        }
          - type: custom:bubble-card
            card_type: horizontal-buttons-stack
            1_link: '#alert'
            1_icon: mdi:alert-outline
            2_link: '#foudre'
            2_icon: mdi:weather-lightning
            3_link: '#sun'
            3_icon: mdi:sun-clock-outline
            highlight_current_view: true
            hide_gradient: true
            rise_animation: true
            auto_order: true
    cards: []
  - type: sections
    path: lumieres
    max_columns: 2
    title: lumières
    sections:
      - type: grid
        cards:
          - type: heading
            icon: hue:bulb-group-classic-3-alt
            heading: LUMIERES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: phu:rooms-hallway
            heading: Entrée
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.entree
                color: state
                name: Entrée
                state_content:
                  - name
                  - state
                icon: mdi:ceiling-light
          - type: custom:mushroom-template-card
            entity: light.entree
            primary: Entrée
            secondary: |
              {% if is_state('light.entree', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.entree', 'on') %}
                mdi:ceiling-light
              {% else %}
                mdi:ceiling-light-outline
              {% endif %}
            icon_color: |
              {% if is_state('light.entree', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.entree', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.entree', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.entree', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.entree', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: cover.store_salon
                color: state
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.salon
                icon: hue:flourish-alt
                color: state
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: light.table
                icon: mdi:ceiling-light
                color: state
                state_content: state
            heading: Salon
          - type: custom:mushroom-template-card
            entity: light.salon
            primary: Salon
            secondary: |
              {% if is_state('light.salon', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.salon', 'on') %}
                mdi:sofa
              {% else %}
                mdi:sofa-outline
              {% endif %}
            icon_color: |
              {% if is_state('light.salon', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.salon', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.salon', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 6
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.salon', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.salon', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
          - type: custom:mushroom-template-card
            entity: light.table
            primary: Table
            secondary: |
              {% if is_state('light.table', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: mdi:table-chair
            icon_color: |
              {% if is_state('light.table', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.table', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.table', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 6
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.table', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.table', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
          - type: heading
            icon: mdi:fridge
            heading: Cuisine
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: light.cuisine
                color: state
                name: 'Cuisine '
                state_content:
                  - name
                  - state
                icon: mdi:ceiling-light
          - type: custom:mushroom-template-card
            entity: light.cuisine
            primary: Cuisine
            secondary: |
              {% if is_state('light.cuisine', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.cuisine', 'on') %}
                mdi:ceiling-light
              {% else %}
                mdi:ceiling-light-outline
              {% endif %}
            icon_color: |
              {% if is_state('light.cuisine', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.cuisine', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.cuisine', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.cuisine', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.cuisine', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
          - type: heading
            icon: mdi:home-import-outline
            heading: Couloir
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.couloir
                color: state
                name: Couloir
                state_content:
                  - name
                  - state
                icon: mdi:ceiling-light
          - type: custom:mushroom-template-card
            entity: light.couloir
            primary: Couloir
            secondary: |
              {% if is_state('light.couloir', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.couloir', 'on') %}
                mdi:ceiling-light
              {% else %}
                mdi:ceiling-light-outline
              {% endif %}
            icon_color: |
              {% if is_state('light.couloir', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.couloir', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.couloir', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.couloir', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.couloir', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
      - type: grid
        cards:
          - type: heading
            icon: hue:bulb-group-classic-3-alt
            heading: LUMIERES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: cover.store_bureau
                color: state
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.bureau_z2m
                icon: hue:flourish-alt
                color: state
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: light.bureau
                color: state
                icon: mdi:television
                state_content: state
            heading: Bureau
          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                entity: light.bureau_z2m
                primary: Bureau
                secondary: |
                  {% if is_state('light.bureau_z2m', 'on') %}
                    Allumée
                  {% else %}
                    Éteint
                  {% endif %}
                icon: |
                  {% if is_state('light.bureau_z2m', 'on') %}
                    hue:flourish-alt
                  {% else %}
                    hue:flourish
                  {% endif %}
                icon_color: |
                  {% if is_state('light.bureau_z2m', 'on') %}
                    green
                  {% else %}
                    grey
                  {% endif %}
                badge_icon: |
                  {% if is_state('light.bureau_z2m', 'on') %}
                    mdi:checkbox-marked-circle
                  {% else %}
                    mdi:checkbox-blank-circle-outline
                  {% endif %}
                badge_color: |
                  {% if is_state('light.bureau_z2m', 'on') %}
                    green
                  {% else %}
                    grey
                  {% endif %}
                tap_action:
                  action: toggle
                grid_options:
                  columns: 6
                  rows: 2
                card_mod:
                  style:
                    mushroom-state-info$: |
                      .primary {
                        position: relative;
                        top: -5px;
                        left: 10px;
                        font-size: 24px !important;
                        font-weight: bold;
                      }
                      .secondary {
                        position: relative;
                        top: 5px;
                        left: 10px;
                        font-size: 12px !important;
                      }
                    .: |
                      :host {
                        --mush-icon-size: 70px;
                      }
                    style: |
                      ha-card {
                        border: 1px solid {% if is_state('light.bureau_z2m', 'on') %} green {% else %} grey {% endif %};
                        background-color: {% if is_state('light.bureau_z2m', 'on') %} rgba(0, 255, 0, 0.0) 
                        {% else %} 
                          transparent 
                        {% endif %};
                      }
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    entity: light.bureau_z2m
                    tap_action:
                      action: navigate
                      navigation_path: '#bureau_z2m'
                    icon: |
                      {% if is_state('light.bureau_z2m', 'on') %}
                        hue:flourish-alt
                      {% else %}
                        hue:flourish
                      {% endif %}
                    icon_color: |
                      {% if is_state(entity, 'on') %}
                        green
                      {% elif is_state(entity, 'off') %}
                        grey
                      {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      --chip-border-width: 1;
                      --chip-border-color: {% if is_state('light.bureau_z2m', 'on') %} green {% else %} grey {% endif %};
                      --chip-height: 30px;
                      margin-left: 80%;
                      bottom: 15px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  border: 1px solid {% if is_state('light.bureau_z2m', 'on') %} green {% else %} grey {% endif %};
                  background-color: {% if is_state('light.bureau_z2m', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                }
            grid_options:
              columns: 6
              rows: 2
          - type: custom:mushroom-template-card
            entity: light.bureau
            primary: Ecran P.C.
            secondary: |
              {% if is_state('light.bureau', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.bureau', 'on') %}
                mdi:television
              {% else %}
                mdi:television-off
              {% endif %}
            icon_color: |
              {% if is_state('light.bureau', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.bureau', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.bureau', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.bureau', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.bureau', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
            grid_options:
              columns: 6
              rows: 2
            visibility:
              - condition: state
                entity: switch.hue_smart_eco_pc_bureau
                state: 'on'
          - type: heading
            icon: mdi:bathtub
            heading: Salle de Bain
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: light.lampe_salle_de_bain_hue
                icon: mdi:ceiling-light
                color: state
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.relais_lumiere_sdb_sonoff
                color: state
                icon: mdi:mirror-rectangle
          - type: custom:mushroom-template-card
            entity: switch.salle_de_bain
            primary: Salle de Bain
            secondary: |
              {% if is_state('light.salle_de_bain', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.salle_de_bain', 'on') %}
                mdi:ceiling-light
              {% else %}
                mdi:ceiling-light-outline
              {% endif %}
            icon_color: |
              {% if is_state('light.salle_de_bain', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.salle_de_bain', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.salle_de_bain', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.salle_de_bain', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.salle_de_bain', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
          - type: heading
            icon: mdi:bed
            heading: Chambre
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: light.chambre
                icon: hue:flourish-alt
                color: state
                state_content: state
          - type: custom:mushroom-template-card
            entity: light.chambre
            primary: Chambre
            secondary: |
              {% if is_state('light.chambre', 'on') %}
                Allumée
              {% else %}
                Éteint
              {% endif %}
            icon: |
              {% if is_state('light.chambre', 'on') %}
                hue:flourish-alt
              {% else %}
                hue:flourish
              {% endif %}
            icon_color: |
              {% if is_state('light.chambre', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.chambre', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.chambre', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.chambre', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.chambre', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
          - type: heading
            icon: mdi:bed
            heading: Têtes de Lit
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.zone_eric
                color: state
                icon: hue:wall-impress-narrow
                name: zE
                state_content:
                  - name
                  - state
                  - brightness
              - type: entity
                show_state: true
                show_icon: true
                entity: light.zone_gege
                name: zG
                icon: hue:wall-impress-narrow
                state_content:
                  - name
                  - state
                  - brightness
                color: state
            visibility:
              - condition: state
                entity: switch.prise_tete_de_lit_chambre
                state: 'on'
          - type: conditional
            conditions:
              - entity: switch.prise_tete_de_lit_chambre
                state: 'on'
            card:
              type: custom:vertical-stack-in-card
              cards:
                - type: custom:mushroom-template-card
                  entity: light.lit
                  primary: Têtes de Lit
                  secondary: >
                    {% set on_lights =
                    expand('light.hue_color_candle_chambre_gege',
                    'light.hue_color_candle_chambre_eric') | selectattr('state',
                    'eq', 'on') | list %}

                    {% if on_lights | length > 0 %}
                      {{ on_lights | length }} lampe(s) allumée(s)
                    {% else %}
                      Aucune lampe allumée
                    {% endif %}
                  icon: |
                    {% if is_state('light.lit', 'on') %}
                      mdi:bed
                    {% else %}
                      mdi:bed-outline
                    {% endif %}
                  icon_color: |
                    {% if is_state('light.lit', 'on') %}
                      green
                    {% else %}
                      grey
                    {% endif %}
                  badge_icon: |
                    {% if is_state('light.lit', 'on') %}
                      mdi:checkbox-marked-circle
                    {% else %}
                      mdi:checkbox-blank-circle-outline
                    {% endif %}
                  badge_color: |
                    {% if is_state('light.lit', 'on') %}
                      green
                    {% else %}
                      grey
                    {% endif %}
                  tap_action:
                    action: toggle
                  card_mod:
                    style:
                      mushroom-state-info$: |
                        .primary {
                          top: -5px;
                          left: 10px;
                          font-size: 24px !important;
                          font-weight: bold;
                        }
                        .secondary {
                          position: relative;
                          top: 7px;
                          left: 3px;
                          font-size: 12px !important;
                        }
                      .: |
                        :host {
                          --mush-icon-size: 65px;
                        }
                      style: |
                        ha-card {
                          min-height: 5px !important;
                          max-height: 5px !important;
                          background-color: {% if is_state('light.lit', 'on') %} transparent {% else %} transparent {% endif %};
                          margin-top: 55px;
                        }
                - type: custom:mushroom-chips-card
                  chips:
                    - type: template
                      entity: light.lit
                      tap_action:
                        action: navigate
                        navigation_path: '#tete_de_lit'
                      icon: |
                        {% if is_state('light.lit', 'on') %}
                          mdi:floor-lamp
                        {% else %}
                          mdi:floor-lamp-outline
                        {% endif %}
                      icon_color: |
                        {% if is_state(entity, 'on') %}
                          green
                        {% elif is_state(entity, 'off') %}
                          grey
                        {% endif %}
                  card_mod:
                    style: |
                      ha-card {
                        --chip-border-width: 1;
                        --chip-border-color: {% if is_state('light.lit', 'on') %} green {% else %} grey {% endif %};
                        --chip-height: 50px;
                        margin-left: 80%;
                        bottom: 30px;
                        background: none !important;
                        box-shadow: none !important;
                        border: none !important;
                      }
              card_mod:
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.lit', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.lit', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#tete_de_lit'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Têtes de Lit
                icon: mdi:floor-lamp
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-light-card
                    entity: light.hue_color_candle_chambre_gege
                    name: Tête de Lit Gégé
                    icon: mdi:floor-lamp
                    icon_color: green
                    layout: normal
                    use_light_color: false
                    show_brightness_control: true
                    show_color_temp_control: false
                    show_color_control: false
                    collapsible_controls: false
                    card_mod:
                      style: |
                        ha-card {
                          border: 2px solid {% if is_state('light.hue_color_candle_chambre_gege', 'on') %} green {% else %} grey {% endif %};
                          background-color: {% if is_state('light.hue_color_candle_chambre_gege', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                        }
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 25% 25% 25% 25%
                      grid-template-rows: 100%
                      grid-template-areas: |
                        "zone1 zone2 zone3 zone4"
                    cards:
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone1
                        label: 25%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 25
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone2
                        label: 50%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 50
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone3
                        label: 75%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 75
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.hue_color_candle_chambre_gege'].attributes.brightness;
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone4
                        label: 100%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.hue_color_candle_chambre_gege
                            brightness_pct: 100
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  if (states['light.hue_color_candle_chambre_gege'].state == "on" && states['light.hue_color_candle_chambre_gege'].attributes.brightness == 255)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
              - type: custom:mushroom-light-card
                entity: light.hue_color_candle_chambre_eric
                name: Tête de Lit Eric
                icon: mdi:floor-lamp
                icon_color: green
                layout: normal
                use_light_color: false
                show_brightness_control: true
                show_color_temp_control: false
                show_color_control: false
                collapsible_controls: false
                card_mod:
                  style: |
                    ha-card {
                      border: 2px solid {% if is_state('light.hue_color_candle_chambre_eric', 'on') %} green {% else %} grey {% endif %};
                      background-color: {% if is_state('light.hue_color_candle_chambre_eric', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                    }
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  grid-template-columns: 25% 25% 25% 25%
                  grid-template-rows: 100%
                  grid-template-areas: |
                    "zone1 zone2 zone3 zone4"
                cards:
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone1
                    label: 25%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 25
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "rgba(0, 255, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 63 && brightness <= 65)
                                return "green";
                              else
                                return "grey";
                            ]]]
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone2
                    label: 50%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 50
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "rgba(0, 255, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 127 && brightness <= 129)
                                return "green";
                              else
                                return "grey";
                            ]]]
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone3
                    label: 75%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 75
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "rgba(0, 255, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              var brightness = states['light.hue_color_candle_chambre_eric'].attributes.brightness;
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && brightness >= 190 && brightness <= 192)
                                return "green";
                              else
                                return "grey";
                            ]]]
                  - type: custom:button-card
                    view_layout:
                      grid-area: zone4
                    label: 100%
                    show_label: true
                    tap_action:
                      action: call-service
                      service: light.turn_on
                      service_data:
                        entity_id: light.hue_color_candle_chambre_eric
                        brightness_pct: 100
                    styles:
                      grid:
                        - grid-template-areas: '"i" "n" "l"'
                        - grid-template-rows: min-content min-content 1fr
                      card:
                        - aspect-ratio: 1/1
                        - background-color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "rgba(0, 255, 0, 0.1)";
                              else
                                return "transparent";
                            ]]]
                        - border-width: 1px
                        - border-color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      icon:
                        - color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "green";
                              else
                                return "grey";
                            ]]]
                      label:
                        - font-weight: bold
                        - color: |
                            [[[
                              if (states['light.hue_color_candle_chambre_eric'].state == "on" && states['light.hue_color_candle_chambre_eric'].attributes.brightness == 255)
                                return "green";
                              else
                                return "grey";
                            ]]]
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bureau_z2m'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Lampes Bureau
                icon: hue:flourish-alt
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-light-card
                    entity: light.bureau_z2m
                    name: Lampes Bureau
                    icon: hue:flourish-alt
                    icon_color: green
                    layout: normal
                    use_light_color: false
                    show_brightness_control: true
                    show_color_temp_control: false
                    show_color_control: false
                    collapsible_controls: false
                    card_mod:
                      style: |
                        ha-card {
                          border: 2px solid {% if is_state('light.bureau_z2m', 'on') %} green {% else %} grey {% endif %};
                          background-color: {% if is_state('light.bureau_z2m', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                        }
                  - type: custom:layout-card
                    layout_type: custom:grid-layout
                    layout:
                      grid-template-columns: 25% 25% 25% 25%
                      grid-template-rows: 100%
                      grid-template-areas: |
                        "zone1 zone2 zone3 zone4"
                    cards:
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone1
                        label: 25%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau_z2m
                            brightness_pct: 25
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 63 && brightness <= 65)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone2
                        label: 50%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau_z2m
                            brightness_pct: 50
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 127 && brightness <= 129)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone3
                        label: 75%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau_z2m
                            brightness_pct: 75
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  var brightness = states['light.bureau_z2m'].attributes.brightness;
                                  if (states['light.bureau_z2m'].state == "on" && brightness >= 190 && brightness <= 192)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                      - type: custom:button-card
                        view_layout:
                          grid-area: zone4
                        label: 100%
                        show_label: true
                        tap_action:
                          action: call-service
                          service: light.turn_on
                          service_data:
                            entity_id: light.bureau_z2m
                            brightness_pct: 100
                        styles:
                          grid:
                            - grid-template-areas: '"i" "n" "l"'
                            - grid-template-rows: min-content min-content 1fr
                          card:
                            - aspect-ratio: 1/1
                            - background-color: |
                                [[[
                                  if (states['light.bureau_z2m'].state == "on" && states['light.bureau_z2m'].attributes.brightness == 255)
                                    return "rgba(0, 255, 0, 0.1)";
                                  else
                                    return "transparent";
                                ]]]
                            - border-width: 1px
                            - border-color: |
                                [[[
                                  if (states['light.bureau_z2m'].state == "on" && states['light.bureau_z2m'].attributes.brightness == 255)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          icon:
                            - color: |
                                [[[
                                  if (states['light.bureau_z2m'].state == "on" && states['light.bureau_z2m'].attributes.brightness == 255)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
                          label:
                            - font-weight: bold
                            - color: |
                                [[[
                                  if (states['light.bureau_z2m'].state == "on" && states['light.bureau_z2m'].attributes.brightness == 255)
                                    return "green";
                                  else
                                    return "grey";
                                ]]]
    cards: []
  - title: Temperatures
    path: temperatures
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:thermometer
            heading: TEMPERATURE - HUMIDITEES
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_battery
                color: state
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            graph_span: 24h
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: Extèrieur
              show_states: true
              colorize_states: true
            yaxis:
              - id: first
                min: ~50
                max: ~70
                decimals: 0
                apex_config:
                  tickAmount: 10
              - id: second
                min: ~15
                max: ~25
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 30m
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.vence_temperature
                name: Météo VENCE
                yaxis_id: second
                stroke_width: 2
                fill_raw: last
                color: orange
              - entity: sensor.th_balcon_nord_temperature
                name: T° Bal.Nrd
                yaxis_id: second
                stroke_width: 2
                fill_raw: last
                color: green
              - entity: sensor.th_balcon_nord_humidity
                name: Humi.Bal.Nrd
                yaxis_id: first
                color: rgb(19, 160, 255)
                type: column
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:water-thermometer-outline
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: false
                entity: sensor.temperature_delta
                icon: mdi:delta
                color: primary
                tap_action:
                  action: navigate
                  navigation_path: '#tendances'
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: 'Tendances '
          - type: horizontal-stack
            cards:
              - type: custom:vertical-stack-in-card
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.th_balcon_nord_temperature
                    icon: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        mdi:arrow-top-right-thick
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        mdi:arrow-bottom-right-thick
                      {% else %}
                        mdi:arrow-right-thick
                      {% endif %}
                    icon_color: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        red
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        blue
                      {% else %}
                        #df6366
                      {% endif %}
                    primary: ''
                    secondary: '{{ states(''sensor.th_balcon_nord_temperature'') }}°C'
                    layout: horizontal
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_mod:
                      style: |
                        ha-card {
                          background-color: transparent !important;
                          border: none !important;
                        }
                        mushroom-state-info$: |
                          .primary {
                            font-size: 12px !important;
                            color: lightgrey !important;
                            position: relative;
                            bottom: 5px;
                            left: 5px;
                            overflow: visible !important;
                            white-space: normal !important;
                          }
                          .secondary {
                            font-size: 19px !important;
                            position: relative;
                            overflow: visible !important;
                            top: 0px;
                            left: 5px;
                          }
                        mushroom-shape-icon$: |
                          .shape {
                            position: relative;
                            left: 0px;
                            top: 0px;
                          }
                        .: |
                          :host {
                            --mush-icon-size: 50px;
                          }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.th_balcon_nord_temperature
                        name: Température
                        color: '#df6366'
                    height: 200
                    hours_to_show: 24
                    decimals: 0
                    points_per_hour: 1
                    line_width: 2
                    font_size: 20
                    animate: true
                    show:
                      labels: true
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.th_balcon_nord_humidity
                    icon: >
                      {% if is_state('sensor.th_balcon_nord_humidity_trend',
                      'increasing') %}
                        mdi:arrow-top-right-thick
                      {% elif is_state('sensor.th_balcon_nord_humidity_trend',
                      'decreasing') %}
                        mdi:arrow-bottom-right-thick
                      {% else %}
                        mdi:arrow-right-thick
                      {% endif %}
                    icon_color: >
                      {% if is_state('sensor.th_balcon_nord_humidity_trend',
                      'increasing') %}
                        blue
                      {% elif is_state('sensor.th_balcon_nord_humidity_trend',
                      'decreasing') %}
                        #ADD8E6
                      {% else %}
                        #00CED1
                      {% endif %}
                    primary: ''
                    secondary: '{{ states(''sensor.th_balcon_nord_humidity'') }}%'
                    layout: horizontal
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        mushroom-state-info$: |
                          .primary {
                            font-size: 12px !important;
                            color: lightgrey !important;
                            position: relative;
                            bottom: 5px;
                            left: 5px;
                            overflow: visible !important;
                            white-space: normal !important;
                          }
                          .secondary {
                            font-size: 19px !important;
                            position: relative;
                            overflow: visible !important;
                            top: 0px;
                            left: 5px;
                          }
                        mushroom-shape-icon$: |
                          .shape {
                            position: relative;
                            left: 0px;
                            top: 0px;
                          }
                        .: |
                          :host {
                            --mush-icon-size: 50px;
                          }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.th_balcon_nord_humidity
                        name: Humidité
                        color: '#00CED1'
                    height: 200
                    hours_to_show: 24
                    decimals: 0
                    points_per_hour: 1
                    line_width: 2
                    font_size: 20
                    animate: true
                    show:
                      labels: true
                      name: false
                      icon: false
                      state: false
                      legend: false
                      fill: fade
                    card_mod:
                      style: |
                        ha-card {
                         background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                  height: 228px;
                  margin-left: auto;
                  margin-right: auto;
                }
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: sensor.salon_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_salon_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_salon_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Salon: {% if is_state('sensor.clim_salon_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.cuisine_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: |
                    {% if is_state('sensor.radiateur_cuisine_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Cuisine: {% if is_state('sensor.radiateur_cuisine_etat',
                    'Heat') %}
                      Heat
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.bureau_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_bureau_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_bureau_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Bureau: {% if is_state('sensor.clim_bureau_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.chambre_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_chambre_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_chambre_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Chambre: {% if is_state('sensor.clim_chambre_etat', 'Heat')
                    %}
                      Heat
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
            alignment: center
          - type: custom:apexcharts-card
            graph_span: 24h
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: first
                min: ~0
                max: auto
                decimals: 0
                apex_config:
                  tickAmount: 10
              - id: second
                min: ~0
                max: auto
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 30m
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.temperature_moyenne_interieure
                name: T° moyenne intèrieur
                yaxis_id: first
                stroke_width: 2
                fill_raw: last
                color: orange
              - entity: sensor.th_balcon_nord_temperature
                name: T° Bal.Nrd
                yaxis_id: first
                stroke_width: 2
                fill_raw: last
                color: green
              - entity: sensor.conso_clim_rad_total
                name: Conso. Total
                yaxis_id: second
                stroke_width: 2
                fill_raw: last
                color: blue
                curve: stepline
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:thermometer
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Récap. Températures
          - type: custom:apexcharts-card
            graph_span: 24h
            update_interval: 1m
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: Salon / Cellier / Cuisine / Bureau / SdB / Chambre
              show_states: true
              colorize_states: true
            yaxis:
              - id: TH
                min: ~10
                max: ~20
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 1h
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.th_salon_temperature
                name: Salon
                color: rgb(202, 135, 135)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cellier_temperature
                name: Cellier
                color: skyblue
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cuisine_temperature
                name: Cuisine
                color: rgb(162, 148, 249)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_bureau_temperature
                name: Bureau
                color: orange
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_salle_de_bain_temperature
                name: Salle de bain
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_chambre_temperature
                name: Chambre
                color: rgb(177, 194, 158)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:water
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Récap. Humiditée
          - type: custom:apexcharts-card
            graph_span: 24h
            update_interval: 1m
            apex_config:
              chart:
                height: 250px
            header:
              show: true
              title: Salon / Cellier / Cuisine / Bureau / SdB / Chambre
              show_states: true
              colorize_states: true
            yaxis:
              - id: TH
                min: ~10
                max: ~20
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 10
            all_series_config:
              group_by:
                func: last
                duration: 1h
              show:
                legend_value: false
                extremas: true
            series:
              - entity: sensor.th_salon_humidity
                name: Salon
                color: rgb(202, 135, 135)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cellier_humidity
                name: Cellier
                color: skyblue
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_cuisine_humidity
                name: Cuisine
                color: rgb(162, 148, 249)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_bureau_humidity
                name: Bureau
                color: orange
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_salle_de_bain_humidity
                name: Salle de bain
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
              - entity: sensor.th_chambre_humidity
                name: Chambre
                color: rgb(177, 194, 158)
                yaxis_id: TH
                stroke_width: 2
                fill_raw: last
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                color: green
                state_content:
                  - name
                  - state
                name: Salon
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.clim
              - entity: climate.clim
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
                show_name: false
                name: Ventil.
            icon: mdi:air-conditioner
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            name: Clim du Salon
            state_color: false
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Salon
              temperature_entity: sensor.th_salon_temperature
              humidity_entity: sensor.th_salon_humidity
              margin_top: '-150'
              icon: mdi:sofa
          - type: heading
            icon: mdi:food-variant
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cellier_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CELLIER
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Cellier
              temperature_entity: sensor.th_cellier_temperature
              humidity_entity: sensor.th_cellier_humidity
              icon: mdi:food-variant
          - type: heading
            icon: mdi:fridge
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.radiateur_elec_cuisine
                icon: mdi:power
                color: state
                tap_action:
                  action: toggle
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                color: green
                name: Cuisine
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CUISINE  (RADIATEUR)
          - type: custom:bubble-card
            card_type: climate
            entity: climate.radiateur_cuisine
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.radiateur_cuisine
            icon: ''
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            name: Radiateur de la Cuisine
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Cuisine
              temperature_entity: sensor.th_cuisine_temperature
              humidity_entity: sensor.th_cuisine_humidity
              icon: mdi:fridge
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_du_bureau
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                color: green
                name: Bureau
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: BUREAU
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_du_bureau
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_du_bureau
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            icon: mdi:air-conditioner
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Bureau
              temperature_entity: sensor.th_bureau_temperature
              humidity_entity: sensor.th_bureau_humidity
              icon: mdi:desktop-tower-monitor
          - type: heading
            icon: mdi:bathtub
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                name: Salle de Bain
                state_content:
                  - name
                  - state
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALLE DE BAIN
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Salle de Bain
              temperature_entity: sensor.th_salle_de_bain_temperature
              humidity_entity: sensor.th_salle_de_bain_humidity
              icon: mdi:bathtub
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_de_la_chambre
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                name: Chambre
                state_content:
                  - name
                  - state
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_battery
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CHAMBRE
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_de_la_chambre
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.clim_de_la_chambre
              - entity: climate.clim_de_la_chambre
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
                name: Ventil.
                show_state: false
                show_name: false
                show_attribute: false
                show_last_changed: false
                show_arrow: true
            icon: mdi:air-conditioner
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
          - type: custom:streamline-card
            template: temperature_humidite
            variables:
              card_title: Chambre
              temperature_entity: sensor.th_chambre_temperature
              humidity_entity: sensor.th_chambre_humidity
              icon: mdi:bed
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#tendances'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: CALCUL DU DELTA Intérieur <-> Extérieur
                icon: mdi:delta
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: markdown
                content: >
                  **Calcul de la Température Cible** 

                  - Température Extérieure : {{
                  states('sensor.th_balcon_nord_temperature') | float | round(2)
                  }}°C

                  {% set temperature_exterieure =
                  states('sensor.th_balcon_nord_temperature') | float %} {% set
                  consigne_de_base = states('sensor.consigne_de_base') | int %}
                  {% set delta_7 = states('sensor.delta_7') | int %} {% set
                  delta_5 = states('sensor.delta_5') | int %}

                  {% if temperature_exterieure >= 40 %}
                    {% set temperature_cible = temperature_exterieure - delta_7 %}
                    - [1] Calcul T°Ext. > 40°C [ {{ temperature_exterieure | round(0) }} - {{ delta_7 }} = {{ temperature_cible | round(0) }} ]

                  {% elif temperature_exterieure > 32 %}  
                    {% set temperature_cible = temperature_exterieure - delta_5 %}
                    - [2] Calcul si T°Ext. > 32°C [ {{ temperature_exterieure | round(0) }} - {{ delta_5 }} = {{ temperature_cible | round(0) }} ]

                  {% else %}
                    {% set temperature_cible = consigne_de_base %}
                    - [3] Consigne de Base : {{ consigne_de_base | round(0) }}°C
                    
                    {% set temperature_differentielle = states('sensor.temperature_differentielle') | int %}
                    - [4] Consigne différentielle : {{ temperature_differentielle | round(0) }}°C
                  {% endif %}

                  {% if temperature_exterieure >= 40 %}        
                    - [5] Température Cible si T°Ext. > 40°C = {{ temperature_cible | round(0) }}°C            
                    - [6] Température différentielle = {{ (states('sensor.temperature_differentielle') | int) + (temperature_cible - consigne_de_base) | round(0) }}°C

                  {% elif temperature_exterieure > 32 %}        
                    - [7] Température Cible = {{ temperature_cible | round(0) }}°C            
                    - [8] Température différentielle = {{ (states('sensor.temperature_differentielle') | int) + (temperature_cible - consigne_de_base) | round(0) }}°C

                  {% else %}        
                    - [ 9] Température Cible si T°Ext. < 32°C = {{ temperature_cible | round(0) }}°C
                    - [10] Température différentielle = {{ (states('sensor.temperature_differentielle') | int) + (temperature_cible - consigne_de_base) | round(0) }}°C
                  {% endif %}

                  {% if temperature_exterieure > 40 %}
                    - [11] DELTA: {{ states('sensor.temperature_delta') }}
                  {% elif temperature_exterieure > 32 %}        
                    - [12] DELTA: {{ states('sensor.temperature_delta') }}
                  {% else %}     
                    - [13] DELTA: {{ states('sensor.temperature_delta') }}
                  {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: transparent;
                    }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'false'
                  - entity: sensor.condition_eric_wifi
                    state: 'false'
                card:
                  type: markdown
                  content: |
                    **Les deux en mode Cellular**
                     - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'true'
                  - entity: sensor.condition_eric_wifi
                    state: 'true'
                card:
                  type: markdown
                  content: |
                    **Les deux en mode Wifi**
                     - Climatiseur Salon : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Bureau : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'true'
                  - entity: sensor.condition_eric_wifi
                    state: 'false'
                card:
                  type: markdown
                  content: |
                    **Mamour en mode Wifi**
                     - Climatiseur Salon : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'false'
                  - entity: sensor.condition_eric_wifi
                    state: 'true'
                card:
                  type: markdown
                  content: |
                    **Eric en mode Wifi**
                     - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Bureau : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
    cards: []
  - type: sections
    path: clim
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sun-snowflake
            heading: CLIM.  / RADIATEUR
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: false
                entity: sensor.temperature_delta
                tap_action:
                  action: navigate
                  navigation_path: '#calcul'
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Consomation TOTAL Climatisations & Radiateurs
          - type: custom:mushroom-chips-card
            chips:
              - type: conditional
                conditions:
                  - entity: sensor.salon_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_salon_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_salon_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Salon: {% if is_state('sensor.clim_salon_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_salon_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_salon_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.cuisine_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:heating-coil
                  icon_color: |
                    {% if is_state('sensor.radiateur_cuisine_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Cuisine: {% if is_state('sensor.radiateur_cuisine_etat',
                    'Heat') %}
                      Heat
                    {% elif is_state('sensor.radiateur_cuisine_etat', 'Off') %}
                      Off
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.bureau_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_bureau_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_bureau_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: |
                    Bureau: {% if is_state('sensor.clim_bureau_etat', 'Heat') %}
                      Heat
                    {% elif is_state('sensor.clim_bureau_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_bureau_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
              - type: conditional
                conditions:
                  - entity: sensor.chambre_power_status
                    state_not: 'off'
                chip:
                  type: template
                  icon: mdi:air-conditioner
                  icon_color: |
                    {% if is_state('sensor.clim_chambre_etat', 'Cool') %}
                      #87CEEB
                    {% elif is_state('sensor.clim_chambre_etat', 'Heat') %}
                      #DC143C
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      #40E0D0
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      #FF0000
                    {% endif %}
                  content: >
                    Chambre: {% if is_state('sensor.clim_chambre_etat', 'Heat')
                    %}
                      Heat
                    {% elif is_state('sensor.clim_chambre_etat', 'Fan') %}
                      Fan
                    {% elif is_state('sensor.clim_chambre_etat', 'Off') %}
                      Off
                    {% else %}
                      Cool
                    {% endif %}
                  tap_action:
                    action: none
            alignment: center
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt-outline
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.conso_clim_rad_total
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.conso_clim_rad_total
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Climatiseur du SALON
          - type: heading
            icon: mdi:sofa
            heading: Clim. Salon
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.clim_connectivity
                color: state
                icon: mdi:check-network
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_salon_week
                name: Sem.
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_salon_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.clim_salon_nous
                icon: mdi:power
                color: state
                tap_action:
                  action: toggle
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog clim salon
          - type: thermostat
            entity: climate.clim
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - fan_only
                  - heat
                  - cool
              - style: icons
                type: climate-fan-modes
                fan_modes:
                  - auto
                  - low
                  - medium
                  - high
            name: Clim SALON
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.clim_salon_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.clim_salon_nous_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Radiateur électrique de la CUISINE
          - type: heading
            icon: mdi:fridge
            heading: Rad. Cuisine
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.radiateur_elec_cuisine
                color: state
                icon: mdi:power
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_radiateur_cuisine_week
                color: state
                state_content: name
                name: Sem.
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_radiateur_cuisine_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.radiateur_elec_cuisine
                icon: mdi:power
                color: state
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog radiateur cuisine
          - type: thermostat
            entity: climate.radiateur_cuisine
            features:
              - type: climate-hvac-modes
              - style: icons
                type: climate-preset-modes
            show_current_as_primary: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.radiateur_elec_cuisine_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.radiateur_elec_cuisine_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Climatiseur du BUREAU
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading: clim. Bureau
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.clim_du_bureau_connectivity
                color: state
                icon: mdi:check-network
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_bureau_week
                name: Sem.
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_du_bureau_week_end
                name: Week-End
                color: state
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_du_bureau_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.clim_du_bureau_nous
                icon: mdi:power
                color: state
                tap_action:
                  action: toggle
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog clim bureau
          - type: thermostat
            entity: climate.clim_du_bureau
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - fan_only
                  - heat
                  - cool
              - style: icons
                type: climate-fan-modes
                fan_modes:
                  - auto
                  - low
                  - medium
                  - high
            name: Clim du BUREAU
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.clim_du_bureau_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.clim_du_bureau_nous_power
                above: 0.1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:mod-card
                    card_mod:
                      style:
                        .: |
                          :host {
                            --text-divider-color: white;
                            --text-divider-line-size: 5px;
                          }
                    card:
                      type: custom:text-divider-row
                      text: Climatiseur de la CHAMBRE
          - type: heading
            icon: mdi:bed
            heading: clim. Chambre
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.clim_de_la_chambre_connectivity
                color: state
                icon: mdi:check-network
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_de_la_chambre_week
                color: state
                name: Sem.
                state_content: name
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.schedule_clim_de_la_chambre_week_end
                state_content: name
                color: state
                name: Week-End
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_nous_power
                color: amber
              - type: entity
                show_state: false
                show_icon: true
                entity: switch.clim_chambre_nous
                color: state
                icon: mdi:power
                tap_action:
                  action: toggle
            layout_options:
              grid_columns: full
              grid_rows: 1
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/prog clim chambre
          - type: thermostat
            entity: climate.clim_de_la_chambre
            features:
              - style: icons
                type: climate-hvac-modes
                hvac_modes:
                  - 'off'
                  - fan_only
                  - heat
                  - cool
              - style: icons
                type: climate-fan-modes
                fan_modes:
                  - auto
                  - low
                  - medium
                  - high
            name: Clim de la CHAMBRE
            show_current_as_primary: false
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: '1'
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: |
                      :host {
                        --ha-card-border-color: none !important;
                        --card-background-color: none !important;
                        }
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: none !important;
                        font-weight: bold;
                        --mdc-icon-size: 25px;
                        --paper-item-icon-color: white;
                      }
                      bar-card-currentbar, bar-card-backgroundbar {
                        height: 6px !important;
                        margin-top: 35px;
                      }
                filter:
                  include:
                    - options: {}
                      entity_id: sensor.clim_chambre_nous_power
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
            visibility:
              - condition: numeric_state
                entity: sensor.clim_chambre_nous_power
                above: 0.1
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#calcul'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: CALCUL DU DELTA Intérieur <-> Extérieur
                icon: mdi:delta
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: markdown
                content: >
                  **Calcul de la Température Cible** 

                  - Température Extérieure : {{
                  states('sensor.th_balcon_nord_temperature') | float | round(2)
                  }}°C

                  {% set temperature_exterieure =
                  states('sensor.th_balcon_nord_temperature') | float %} {% set
                  consigne_de_base = states('sensor.consigne_de_base') | int %}
                  {% set delta_7 = states('sensor.delta_7') | int %} {% set
                  delta_5 = states('sensor.delta_5') | int %}

                  {% if temperature_exterieure >= 40 %}
                    {% set temperature_cible = temperature_exterieure - delta_7 %}
                    - [1] Calcul T°Ext. > 40°C [ {{ temperature_exterieure | round(0) }} - {{ delta_7 }} = {{ temperature_cible | round(0) }} ]

                  {% elif temperature_exterieure > 32 %}  
                    {% set temperature_cible = temperature_exterieure - delta_5 %}
                    - [2] Calcul si T°Ext. > 32°C [ {{ temperature_exterieure | round(0) }} - {{ delta_5 }} = {{ temperature_cible | round(0) }} ]

                  {% else %}
                    {% set temperature_cible = consigne_de_base %}
                    - [3] Consigne de Base : {{ consigne_de_base | round(0) }}°C
                    
                    {% set temperature_differentielle = states('sensor.temperature_differentielle') | int %}
                    - [4] Consigne différentielle : {{ temperature_differentielle | round(0) }}°C
                  {% endif %}

                  {% if temperature_exterieure >= 40 %}        
                    - [5] Température Cible si T°Ext. > 40°C = {{ temperature_cible | round(0) }}°C            
                    - [6] Température différentielle = {{ (states('sensor.temperature_differentielle') | int) + (temperature_cible - consigne_de_base) | round(0) }}°C

                  {% elif temperature_exterieure > 32 %}        
                    - [7] Température Cible = {{ temperature_cible | round(0) }}°C            
                    - [8] Température différentielle = {{ (states('sensor.temperature_differentielle') | int) + (temperature_cible - consigne_de_base) | round(0) }}°C

                  {% else %}        
                    - [ 9] Température Cible si T°Ext. < 32°C = {{ temperature_cible | round(0) }}°C
                    - [10] Température différentielle = {{ (states('sensor.temperature_differentielle') | int) + (temperature_cible - consigne_de_base) | round(0) }}°C
                  {% endif %}

                  {% if temperature_exterieure > 40 %}
                    - [11] DELTA: {{ states('sensor.temperature_delta') }}
                  {% elif temperature_exterieure > 32 %}        
                    - [12] DELTA: {{ states('sensor.temperature_delta') }}
                  {% else %}     
                    - [13] DELTA: {{ states('sensor.temperature_delta') }}
                  {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: transparent;
                    }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'false'
                  - entity: sensor.condition_eric_wifi
                    state: 'false'
                card:
                  type: markdown
                  content: |
                    **Les deux en mode Cellular**
                     - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'true'
                  - entity: sensor.condition_eric_wifi
                    state: 'true'
                card:
                  type: markdown
                  content: |
                    **Les deux en mode Wifi**
                     - Climatiseur Salon : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Bureau : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'true'
                  - entity: sensor.condition_eric_wifi
                    state: 'false'
                card:
                  type: markdown
                  content: |
                    **Mamour en mode Wifi**
                     - Climatiseur Salon : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Bureau : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
              - type: conditional
                conditions:
                  - entity: sensor.condition_mamour_wifi
                    state: 'false'
                  - entity: sensor.condition_eric_wifi
                    state: 'true'
                card:
                  type: markdown
                  content: |
                    **Eric en mode Wifi**
                     - Climatiseur Salon : {{ states('sensor.temperature_cible') | int }}°C
                     - Climatiseur Bureau : {{ (states('sensor.temperature_differentielle') | int) + (states('sensor.temperature_cible') | int - states('sensor.consigne_de_base') | int) }}°C
                     - Climatiseur Chambre : {{ states('sensor.temperature_cible') | int }}°C
                  card_mod:
                    style: |
                      ha-card {
                        border: none !important;
                        box-shadow: none !important;
                        background: transparent;
                      }
    title: Clim
    cards: []
  - type: sections
    max_columns: 2
    title: prog clim salon
    path: prog clim salon
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sun-snowflake
            heading: CLIM. DU SALON
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - climate.clim
            exclude: []
            discover_existing: true
            title: Planificateur Clim. Salon
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Salon Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_salon_week', 'weekdays') |
                  join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_salon_week
                    name: Programmation Climatisation Salon Semaine
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week' %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week' %} {%
                  set current_slot = state_attr(entity_id, 'current_slot') %} {%
                  set next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %}

                  <br> **Prochain déclenchement** {% if next_trigger is not none
                  %} à {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Salon Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_salon_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_salon_week_end
                    name: Programmation Climatisation Salon Week-end
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week_end' %}
                  {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                   <br> <br> <br>
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_salon_week_end' %}
                  {% set current_slot = state_attr(entity_id, 'current_slot') %}
                  {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %}

                  <br> **Prochain déclenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} à {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
        column_span: 2
    cards: []
  - type: sections
    max_columns: 2
    title: PROG RADIATEUR CUISINE
    path: prog radiateur cuisine
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sun-thermometer-outline
            heading: RADIATEUR CUISINE
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - person
              - person.eric
              - climate.radiateur_cuisine
            exclude: []
            discover_existing: true
            title: Planificateur Radiateur Cuisine
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Radiateur de la Cuisine Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_radiateur_cuisine_week',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_radiateur_cuisine_week
                    name: Programmation Radiateur Cuisine Semaine
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_radiateur_cuisine_week' %}
                  {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {% if actions[i].data is defined and actions[i].data.temperature is defined %} {{ actions[i].data.temperature }}°C {% else %} Non défini {% endif %} -> Mode: {% if actions[i].data is defined and actions[i].data.hvac_mode is defined %} {{ actions[i].data.hvac_mode }} {% else %} Non défini {% endif %} {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_radiateur_cuisine_week' %}
                  {% set current_slot = state_attr(entity_id, 'current_slot') %}
                  {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {% if actions[current_slot].data
                  is defined and actions[current_slot].data.temperature is
                  defined %} {{ actions[current_slot].data.temperature }}°C {%
                  else %} Non défini {% endif %} -> Mode: {% if
                  actions[current_slot].data is defined and
                  actions[current_slot].data.hvac_mode is defined %} {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %} {% else %} Non défini {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {% if actions[next_slot].data is
                  defined and actions[next_slot].data.temperature is defined %}
                  {{ actions[next_slot].data.temperature }}°C {% else %} Non
                  défini {% endif %} -> Mode: {% if actions[next_slot].data is
                  defined and actions[next_slot].data.hvac_mode is defined %} {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %} {% else %} Non défini {% endif %}

                  <br> **Prochain déclenchement** {% if next_trigger is not none
                  %} à {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Radiateur Cuisine Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_radiateur_cuisine_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_radiateur_cuisine_week_end
                    name: Programmation radiateur Cuisine Week-end
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_radiateur_cuisine_week_end' %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :**  {% for i in
                  range(timeslots | length)%} 

                  - **{{ timeslots[i] }}** -> {% if actions[i].data is defined
                  and actions[i].data.temperature is defined %} {{
                  actions[i].data.temperature }}°C {% else %} Non défini {%
                  endif %} -> Mode: {% if actions[i].data is defined and
                  actions[i].data.hvac_mode is defined %} {{
                  actions[i].data.hvac_mode }} {% else %} Non défini {% endif %}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_radiateur_cuisine_week_end' %} {% set
                  current_slot = state_attr(entity_id, 'current_slot') %} {% set
                  next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {% if actions[current_slot].data
                  is defined and actions[current_slot].data.temperature is
                  defined %} {{ actions[current_slot].data.temperature }}°C {%
                  else %} Non défini {% endif %} -> Mode: {% if
                  actions[current_slot].data is defined and
                  actions[current_slot].data.hvac_mode is defined %} {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %} {% else %} Non défini {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {% if actions[next_slot].data is
                  defined and actions[next_slot].data.temperature is defined %}
                  {{ actions[next_slot].data.temperature }}°C {% else %} Non
                  défini {% endif %} -> Mode: {% if actions[next_slot].data is
                  defined and actions[next_slot].data.hvac_mode is defined %} {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %} {% else %} Non défini {% endif %}

                  <br> **Prochain déclenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} à {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
        column_span: 2
    cards: []
  - type: sections
    max_columns: 2
    title: prog clim bureau
    path: prog clim bureau
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sun-snowflake
            heading: CLIM. DU BUREAU
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - person
              - person.eric
              - climate.clim_du_bureau
            exclude: []
            discover_existing: true
            title: Planificateur Clim. Bureau
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Bureau Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_bureau_week', 'weekdays')
                  | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_bureau_week
                    name: Programmation Climatisation Bureau Semaine
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }    
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week' %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week' %} {%
                  set current_slot = state_attr(entity_id, 'current_slot') %} {%
                  set next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non     
                  défini {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %}

                  <br> **Prochain déclenchement** {% if next_trigger is not none
                  %} à {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim du Bureau Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_du_bureau_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_du_bureau_week_end
                    name: Programmation Climatisation Bureau Week-end
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }    
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week_end'
                  %} {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                   <br> <br> <br>
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_du_bureau_week_end'
                  %} {% set current_slot = state_attr(entity_id, 'current_slot')
                  %} {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %} 

                  <br> **Prochain déclenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} à {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
        column_span: 2
    cards: []
  - type: sections
    max_columns: 2
    title: prog clim chambre
    path: prog clim chambre
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:sun-snowflake
            heading: CLIM. DE LA CHAMBRE
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/clim
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            clock_size: large
            time_zone: Europe/Paris
            time_format: '24'
            show_seconds: true
            type: clock
            grid_options:
              columns: full
              rows: 2
          - include:
              - person
              - person.eric
              - climate.clim_de_la_chambre
            exclude: []
            discover_existing: true
            title: Planificateur Clim. Chambre
            show_header_toggle: true
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - days
                - time
                - additional-tasks
            sort_by:
              - state
              - relative-time
            customize: {}
            tags:
              - Jours de la semaine
              - Week-End
            exclude_tags: []
            type: custom:scheduler-card
            grid_options:
              columns: 24
              rows: auto
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim de la Chambre Semaine

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_de_la_chambre_week',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_de_la_chambre_week
                    name: Programmation Climatisation Chambre Semaine
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_de_la_chambre_week'
                  %} {% set timeslots = state_attr(entity_id, 'timeslots') %} {%
                  set actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  {% set entity_id = 'switch.schedule_clim_de_la_chambre_week'
                  %} {% set current_slot = state_attr(entity_id, 'current_slot')
                  %} {% set next_slot = state_attr(entity_id, 'next_slot') %} {%
                  set next_trigger = state_attr(entity_id, 'next_trigger') %} {%
                  set timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneau actuel :** {% if current_slot is not none %} {{
                  timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %}

                  <br> **Prochain déclenchement :** {% if next_trigger is not
                  none %} à {{ next_trigger | as_timestamp |
                  timestamp_custom('%H:%M') }} {% else %} Non défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
          - type: vertical-stack
            cards:
              - type: markdown
                content: >
                  # Clim de la Chambre Week-End

                  **Jours de la semaine :** {{
                  state_attr('switch.schedule_clim_de_la_chambre_week_end',
                  'weekdays') | join(', ') }}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: entities
                entities:
                  - entity: switch.schedule_clim_de_la_chambre_week_end
                    name: Programmation Climatisation Chambre Week-End
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }   
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_clim_de_la_chambre_week_end' %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  **Créneaux horaires et actions :** {% for i in range(timeslots
                  | length) %}
                    - **{{ timeslots[i] }}** -> {{ actions[i].data.temperature }}°C -> Mode: {{ actions[i].data.hvac_mode }}
                  {% endfor %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: markdown
                content: >
                  {% set entity_id =
                  'switch.schedule_clim_de_la_chambre_week_end' %} {% set
                  current_slot = state_attr(entity_id, 'current_slot') %} {% set
                  next_slot = state_attr(entity_id, 'next_slot') %} {% set
                  next_trigger = state_attr(entity_id, 'next_trigger') %} {% set
                  timeslots = state_attr(entity_id, 'timeslots') %} {% set
                  actions = state_attr(entity_id, 'actions') %}

                  <br><br><br> **Créneau actuel :** {% if current_slot is not
                  none %} {{ timeslots[current_slot] }} -> {{
                  actions[current_slot].data.temperature }}°C -> Mode: {{
                  actions[current_slot].data.hvac_mode }} {% else %} Non défini
                  {% endif %}

                  <br> **Prochain créneau :** {% if next_slot is not none %} {{
                  timeslots[next_slot] }} -> {{
                  actions[next_slot].data.temperature }}°C -> Mode: {{
                  actions[next_slot].data.hvac_mode }} {% else %} Non défini {%
                  endif %}

                  <br> **Prochain déclenchement :** {% if next_trigger is not
                  none %} le {{ next_trigger | as_timestamp |
                  timestamp_custom('%d/%m/%y') }} à {{ next_trigger |
                  as_timestamp | timestamp_custom('%H:%M') }} {% else %} Non
                  défini {% endif %}
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: 0;
                      padding: 0;
                    }
        column_span: 2
    cards: []
  - title: Stores
    path: stores
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:window-shutter
            heading: STORES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0px 0px -20px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: CONDITIONS
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - type: heading
            icon: ''
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_temperature
                color: green
            heading: Auto open at +18° or auto close at +34°
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 90px;
                  padding: 0;
                }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: STORE SALON
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -40px 0px 0px 0px;
                  padding: 0;
                }
            type: heading
            icon: phu:sliding-window-door-close
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.contact_fenetre_salon_ikea_contact
                color: green
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.contact_fenetre_salon_ikea_battery
                color: state
                tap_action:
                  action: more-info
            heading: Fenêtre Salon
          - type: vertical-stack
            cards:
              - type: custom:enhanced-shutter-card
                entities:
                  - entity: cover.store_salon
                    name: Salon
                    name_disabled: true
                    opening_disabled: true
                    passive_mode: false
                    resize_height_pct: 100
                    resize_width_pct: 130
                    title_position: bottom
                    opening_position: bottom
                    inline_header: true
                    view_image: ' '
                    buttons_position: left
                    signal_entity: sensor.store_salon_signal_strength
                    shutter_slat_image: esc-shutter-slat.png
                    shutter_bottom_image: esc-shutter-bottom.png
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: -55px 0px 0px 0px;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  <div style="text-align: center;">Salon : {{
                  states('sensor.store_salon_status') | default('-') }}</div>
                card_mod:
                  style: |
                    ha-card {
                      background: transparent;
                      border: transparent;
                      text-align: center;
                      margin-top: -45px;
                    }
              - type: horizontal-stack
                cards:
                  - type: custom:button-card
                    name: 100%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 100
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 75%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 85
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 50%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 70
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 25%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 45
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 10%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_salon
                        position: 20
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
          - type: custom:mushroom-light-card
            entity: light.smart_roller_shutter_2309261223820570080348e1e9dc6401_dnd
            grid_options:
              columns: full
              rows: 1
            primary_info: name
            secondary_info: state
            fill_container: true
            use_light_color: false
            tap_action:
              action: toggle
            icon: phu:roller-shutter-switch
            icon_color: green
            icon_type: icon
            hold_action:
              action: none
            double_tap_action:
              action: none
            name: Store Salon (Voyants commandes)
            card_mod:
              style: |
                ha-card {
                  background: transparent;
                  border: transparent;
                }
          - type: heading
            icon: mdi:window-shutter
            heading: STORES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0px 0px -20px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: CONDITIONS
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - type: heading
            icon: ''
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_balcon_nord_temperature
                color: green
            heading: Auto open at +18° or auto close at +25°
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 90px;
                  padding: 0;
                }
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -20px 0px 0px 0px;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: STORE BUREAU
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: none !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
          - type: heading
            icon: phu:sliding-window-door-close
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: binary_sensor.contact_fenetre_bureau_ikea_contact
                color: green
                state_content: state
                icon: mdi:door-open
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.contact_fenetre_bureau_ikea_battery
                color: state
                tap_action:
                  action: more-info
            heading: Fenêtre Bureau
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: -40px 0px 0px 0px;
                  padding: 0;
                }
          - type: vertical-stack
            cards:
              - type: custom:enhanced-shutter-card
                entities:
                  - entity: cover.store_bureau
                    name: Bureau
                    name_disabled: true
                    opening_disabled: true
                    passive_mode: false
                    resize_height_pct: 100
                    resize_width_pct: 130
                    title_position: bottom
                    opening_position: bottom
                    inline_header: true
                    view_image: ' '
                    buttons_position: left
                    signal_entity: sensor.store_bureau_signal_strength
                    shutter_slat_image: esc-shutter-slat.png
                    shutter_bottom_image: esc-shutter-bottom.png
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                      margin: -55px 0px 0px 0px;
                      padding: 0;
                    }
              - type: markdown
                content: >
                  <div style="text-align: center;">Bureau : {{
                  states('sensor.store_bureau_status') | default('-') }}</div>
                card_mod:
                  style: |
                    ha-card {
                      background: transparent;
                      border: transparent;
                      text-align: center;
                      margin-top: -45px;
              - type: horizontal-stack
                cards:
                  - type: custom:button-card
                    name: 100%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 100
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 75%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 90
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 50%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 60
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 25%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 45
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
                  - type: custom:button-card
                    name: 10%
                    tap_action:
                      action: call-service
                      service: cover.set_cover_position
                      service_data:
                        entity_id: cover.store_bureau
                        position: 25
                    styles:
                      card:
                        - background-color: transparent
                        - border: 1px solid
                        - border-radius: 5px
                        - padding: 10px
                      name:
                        - color: white
          - type: custom:mushroom-light-card
            entity: light.smart_roller_shutter_2309266337793570080348e1e9dc5a17_dnd
            grid_options:
              columns: full
              rows: 1
            primary_info: name
            secondary_info: state
            fill_container: true
            use_light_color: false
            tap_action:
              action: toggle
            icon: phu:roller-shutter-switch
            icon_color: green
            icon_type: icon
            hold_action:
              action: none
            double_tap_action:
              action: none
            name: Store Bureau (Voyants commandes)
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                }
    cards: []
  - type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:transmission-tower
            heading: ENERGIE HOME
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.ecojoko_consommation_temps_reel
                color: green
                state_content:
                  - name
                  - state
                name: Réel
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie temps reel
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.ecojoko_consommation_reseau
                color: green
                state_content:
                  - name
                  - state
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie mensuel
                name: Cumul Jrs
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:bubble-card
            card_type: separator
            name: Appartement
            icon: mdi:home-assistant
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: gauge
            entity: sensor.conso_mini
            severity:
              green: 0
              yellow: 50
              red: 75
            needle: true
            name: Conso. Mini
            min: 0
            max: 100
            tap_action:
              action: none
            grid_options:
              columns: 4
              rows: 3
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.ecojoko_consommation_temps_reel
            severity:
              green: 0
              yellow: 2000
              red: 4000
            needle: true
            name: Conso. Temps Réel
            min: 0
            max: 6000
            tap_action:
              action: none
            grid_options:
              rows: 3
              columns: 4
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.conso_maxi
            severity:
              green: 0
              yellow: 2000
              red: 4000
            needle: true
            name: Conso. Maxi
            min: 0
            max: 6000
            tap_action:
              action: none
            grid_options:
              columns: 4
              rows: 3
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:energy-overview-card
                    entities:
                      - power: sensor.ecojoko_consommation_reseau
                        current: sensor.ecojoko_consommation_temps_reel
                        label_leading: Enedis
                        label_trailing: Maison
                        icon_leading: mdi:transmission-tower
                        icon_trailing: mdi:home-lightning-bolt
                        color: '#488fc2'
                        animation:
                          power: 1000
                          min_duration: 1
                          max_duration: 5
                    card_mod:
                      style: |
                        :host {
                          --card-mod-icon-color: #488fc2;
                          --mdc-icon-size: 20px;
                        }
                        ha-card {
                          font-weight: bold;
                          background: transparent;
                        }
                card_mod:
                  style: |
                    ha-card {
                      --text-divider-color: rgb(68, 115, 158);
                      --text-divider-line-size: 3px;
                      --text-divider-font-size: 15px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            grid_options:
              columns: 24
              rows: auto
          - type: custom:bubble-card
            card_type: separator
            name: Ratio Mois A-1 / Semaine dernière  / A-1
            icon: mdi:percent
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:content-card-linky
            entity: sensor.linky_25481620821301_consumption
            ewEntity: sensor.linky_25481620821301_consumption
            show_inject: true
            show_history: true
            show_injection: false
            showEcoWatt: false
            showError: false
            showYesterdayRatio: false
            showHistory: false
            showIcon: false
            showTitle: false
            showPeakOffPeak: false
            showDayPrice: false
            showPrice: false
            showDayMaxPower: false
            showCurrentMonthRatio: true
            showTitleLign: false
            showHeader: false
            showEcoWattJ12: false
            showTempoColor: false
            showTempo: false
            showWeekRatio: false
            showInTableUnit: false
            showDayPriceHCHP: false
            showDayHCHP: false
            showYearRatio: false
            showMonthRatio: false
            showDayName: long
            nbJoursAffichage: '7'
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
            grid_options:
              columns: 4
              rows: auto
          - type: custom:content-card-linky
            entity: sensor.linky_25481620821301_consumption
            ewEntity: sensor.linky_25481620821301_consumption
            show_inject: true
            show_history: true
            show_injection: false
            showEcoWatt: false
            showError: false
            showYesterdayRatio: false
            showHistory: false
            showIcon: false
            showTitle: false
            showPeakOffPeak: false
            showDayPrice: false
            showPrice: false
            showDayMaxPower: false
            showCurrentMonthRatio: false
            showTitleLign: false
            showHeader: false
            showEcoWattJ12: false
            showTempoColor: false
            showTempo: false
            showWeekRatio: true
            showInTableUnit: false
            showDayPriceHCHP: false
            showDayHCHP: false
            showYearRatio: false
            showMonthRatio: false
            showDayName: long
            nbJoursAffichage: '7'
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
            grid_options:
              columns: 4
              rows: auto
          - type: custom:content-card-linky
            entity: sensor.linky_25481620821301_consumption
            ewEntity: sensor.linky_25481620821301_consumption
            show_inject: true
            show_history: true
            show_injection: false
            showEcoWatt: false
            showError: false
            showYesterdayRatio: false
            showHistory: false
            showIcon: false
            showTitle: false
            showPeakOffPeak: false
            showDayPrice: false
            showPrice: false
            showDayMaxPower: false
            showCurrentMonthRatio: false
            showTitleLign: false
            showHeader: false
            showEcoWattJ12: false
            showTempoColor: false
            showTempo: false
            showWeekRatio: false
            showInTableUnit: false
            showDayPriceHCHP: false
            showDayHCHP: false
            showYearRatio: true
            showMonthRatio: false
            showDayName: long
            nbJoursAffichage: '7'
            grid_options:
              columns: 4
              rows: auto
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: Coût Mensuel et Quotidien
            icon: mdi:currency-eur
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: horizontal-stack
            cards:
              - type: statistic
                entity: sensor.ecojoko_consommation_reseau
                period:
                  calendar:
                    period: month
                    offset: 0
                stat_type: change
                name: Total Mois
                icon: mdi:lightning-bolt-outline
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hp_reseau_cost
                period:
                  calendar:
                    period: month
                    offset: 0
                stat_type: change
                name: H.P. Mois
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hc_reseau_cost
                period:
                  calendar:
                    period: month
                    offset: 0
                stat_type: change
                name: H.C. Mois
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                    .icon {
                      color: white !important;
                    }

                     
            grid_options:
              columns: 36
              rows: auto
          - type: horizontal-stack
            cards:
              - type: statistic
                entity: sensor.ecojoko_consommation_reseau
                period:
                  calendar:
                    period: day
                    offset: 0
                stat_type: change
                name: Total Jours
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hp_reseau_cost
                period:
                  calendar:
                    period: day
                    offset: 0
                stat_type: change
                name: H.P. Jours
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                      
                    }
                    .icon {
                      color: white !important;
                    }
              - type: statistic
                entity: sensor.ecojoko_consommation_hc_reseau_cost
                period:
                  calendar:
                    period: day
                    offset: 0
                stat_type: change
                name: H.C. Jours
                icon: mdi:currency-eur
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
                    .icon {
                      color: white !important;
                    }

                     
          - type: custom:bubble-card
            card_type: separator
            name: Conso. Mensuel par Jours
            icon: mdi:lightning-bolt-outline
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:apexcharts-card
            graph_span: 730h
            cache: false
            span:
              end: day
            apex_config:
              chart:
                height: 400px
              legend:
                show: false
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: first
                min: ~0
                max: auto
                opposite: true
                decimals: 0
                apex_config:
                  tickAmount: 20
            all_series_config:
              group_by:
                func: max
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.ecojoko_consommation_reseau
                name: conso. jour en cours
                yaxis_id: first
                color: rgb(19, 160, 255)
                type: column
              - entity: sensor.ecojoko_consommation_reseau
                type: line
                stroke_dash: 8
                color: red
                stroke_width: 1
                name: Avg(730h)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: Conso. réel sur 24 Heures
            icon: mdi:lightning-bolt
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:apexcharts-card
            graph_span: 24h
            cache: false
            apex_config:
              chart:
                height: 400px
              legend:
                show: false
            header:
              show: true
              title: ' '
              show_states: true
              colorize_states: true
            yaxis:
              - id: first
                min: ~0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 20
            all_series_config:
              group_by:
                func: last
                duration: 10m
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.ecojoko_consommation_temps_reel
                name: conso. en temps réel
                color: green
                type: area
                stroke_width: 1
              - entity: sensor.ecojoko_consommation_temps_reel
                unit: Wh
                type: line
                stroke_dash: 8
                color: red
                stroke_width: 1
                name: Moy.(en cours)
                group_by:
                  func: avg
                  duration: 24h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: Energie Totale consommée sur 7 Jours
            icon: mdi:lightning-bolt
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
            graph_span: 23h
            cache: false
            span:
              end: day
            now:
              show: true
              color: darkred
              label: Now
            header:
              show: true
              show_states: true
              colorize_states: true
              title: ' '
            apex_config:
              chart:
                height: 450px
                type: area
              stroke:
                show: true
              dataLabels:
                enabled: true
              legend:
                show: true
              fill:
                type: gradient
                gradient:
                  inverseColors: true
                  type: vertical
                  shadeIntensity: 0.1
                  opacityFrom: 0.5
                  opacityTo: 0.1
                  stops:
                    - 0
                    - 50
                    - 100
              grid:
                show: true
            all_series_config:
              group_by:
                func: last
                duration: 10m
              curve: smooth
              type: area
            yaxis:
              - id: kW
                opposite: true
                apex_config:
                  tickAmount: 20
            series:
              - entity: sensor.ecojoko_consommation_reseau
                color: gainsboro
                extend_to: false
                name: ( 0d)
                transform: return x / 1;
                unit: kW
                stroke_width: 3
                float_precision: 2
                show:
                  legend_value: false
                  extremas: max
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(204, 255, 204)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-1d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(153, 255, 153)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-2d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(102, 255, 102)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-3d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(51, 204, 51)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-4d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(0, 153, 0)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-5d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(0, 102, 0)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-6d'
              - entity: sensor.ecojoko_consommation_reseau
                color: rgb(0, 70, 0)
                extend_to: false
                name: ' '
                unit: kW
                stroke_width: 2
                float_precision: 1
                show:
                  legend_value: false
                  extremas: max
                offset: '-7d'
            card_mod:
              style: |
                div#state__value {
                  font-size: 8.5px;
                }
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:bubble-card
            card_type: separator
            name: Coût totale par Jours (hors Abo.)
            icon: mdi:lightning-bolt
            rows: 2
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
            card_layout: normal
          - card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
            type: custom:flex-table-card
            entities:
              - entity: sensor.linky_jour_0
              - entity: sensor.linky_jour_1
              - entity: sensor.linky_jour_2
              - entity: sensor.linky_jour_3
              - entity: sensor.linky_jour_4
              - entity: sensor.linky_jour_5
              - entity: sensor.linky_jour_6
              - entity: sensor.linky_jour_7
            columns:
              - name: Jour
                data: jour
                align: left
              - name: Total (kWh)
                data: total_kwh
                align: center
              - name: Coût (€)
                data: cout
                align: center
              - name: HP (kWh)
                data: hp_kwh
                align: center
              - name: HC (kWh)
                data: hc_kwh
                align: center
        column_span: 1
    title: Energie HOME
    cards: []
    path: energie
  - type: sections
    max_columns: 1
    title: Energie HOME Temps Réel
    path: energie temps reel
    sections:
      - type: grid
        cards:
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:lightning-bolt
                heading: Temps Réél
                heading_style: title
                badges:
                  - type: entity
                    show_state: true
                    show_icon: true
                    entity: sensor.ecojoko_consommation_temps_reel
                    name: Réel
                    color: green
                    state_content:
                      - name
                      - state
                tap_action:
                  action: navigate
                  navigation_path: /dashboard-tablette/energie
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightning-bolt
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: 1
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 5
                    - color: rgb(102, 255, 102)
                      from: 5
                      to: 49
                    - color: rgb(0, 102, 0)
                      from: 50
                      to: 249
                    - color: orange
                      from: 250
                      to: 499
                    - color: darkorange
                      from: 500
                      to: 749
                    - color: red
                      from: 750
                      to: 999
                    - color: darkred
                      from: 1000
                      to: 6000
                  card_mod:
                    style: >
                      :host {
                        --ha-card-border-color: transparent !important;
                        --card-background-color: none !important;
                      }

                      ha-card {
                          font-weight: bold;
                          --mdc-icon-size: 25px;
                          --paper-item-icon-color: white;
                      }

                      bar-card-currentbar {
                          border-radius: 10px;
                      }

                      bar-card-currentbar, bar-card-current,
                      bar-card-backgroundbar {

                      height: 6px !important;

                      margin-top: 34px;

                      }
                filter:
                  exclude:
                    - options: {}
                      entity_id: ^sensor.oneplus*power$
                    - options: {}
                      entity_id: ^sensor.eclairage*$
                    - options: {}
                      entity_id: ^sensor.lampe*ikea*power$
                    - options: {}
                      entity_id: ^*hue*$
                    - options: {}
                      entity_id: ^*device*$
                    - options: {}
                      entity_id: ^*relais*$
                    - options: {}
                      state: unavailable
                    - options: {}
                      state: <= 0.999
                  include:
                    - options: {}
                      entity_id: ^sensor.*power$
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                  show_empty: false
                  entity_row: true
          - type: vertical-stack
            cards:
              - type: custom:auto-entities
                card:
                  type: custom:bar-card
                  icon: mdi:lightbulb-outline
                  title_position: inside
                  height: 38
                  positions:
                    icon: inside
                    indicator: inside
                    name: inside
                    value: inside
                  show_icon: true
                  align: split
                  columns: 1
                  unit_of_measurement: W
                  severity:
                    - color: gainsboro
                      from: 0
                      to: 0.99
                    - color: rgb(102, 255, 102)
                      from: 1
                      to: 4.99
                    - color: rgb(0, 102, 0)
                      from: 5
                      to: 9.99
                    - color: orange
                      from: 10
                      to: 14.99
                    - color: red
                      from: 15
                      to: 19.99
                  card_mod:
                    style: >
                      :host {
                        --ha-card-border-color: transparent !important;
                        --card-background-color: none !important;
                      }

                      ha-card {
                          font-weight: bold;
                          --mdc-icon-size: 25px;
                          --paper-item-icon-color: white;
                      }

                      bar-card-currentbar {
                          border-radius: 10px;
                      }

                      bar-card-currentbar, bar-card-current,
                      bar-card-backgroundbar {

                      height: 6px !important;

                      margin-top: 34px;

                      }
                filter:
                  exclude:
                    - options: {}
                      last_updated: 1m ago
                    - options: {}
                      state: <= 1
                    - options: {}
                      state: unavailable
                  include:
                    - options: {}
                      entity_id: ^*relais*power$
                    - options: {}
                      entity_id: sensor.lampe_salle_de_bain_hue_power
                    - options: {}
                      entity_id: ^sensor.hue*power$
                    - options: {}
                      entity_id: ^sensor.lampe*ikea*power$
                sort:
                  numeric: true
                  reverse: true
                  ip: false
                  ignore_case: false
                  method: state
                show_empty: true
          - type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                chart_type: donut
                graph_span: 24h
                cache: false
                span:
                  start: day
                apex_config:
                  chart:
                    height: 600px
                header:
                  show: true
                  title: Conso. journalière (Cumul sur 24h)
                  show_states: true
                  colorize_states: true
                all_series_config:
                  group_by:
                    func: diff
                    duration: 24h
                  show:
                    legend_value: false
                    extremas: false
                show:
                  loading: true
                  last_updated: false
                series:
                  - entity: sensor.prise_box_internet_ikea_energy
                    transform: return x * 1000;
                    unit: W
                    name: Box
                    color: gainsboro
                  - entity: sensor.prise_horloge_ikea_energy
                    transform: return x * 1000;
                    unit: W
                    name: Horloge
                    color: rgb(183, 183, 183)
                  - entity: sensor.prise_pc_s_gege_ikea_energy
                    transform: return x * 1000;
                    unit: W
                    name: PCg
                    color: rgb(202, 135, 135)
                  - entity: sensor.prise_salon_chargeur_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: Charge
                    color: rgb(174, 68, 90)
                  - entity: sensor.prise_four_micro_ondes_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: Four M.O. (+)
                    color: rgb(98, 78, 136)
                  - entity: sensor.prise_lave_linge_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: Linge (+)
                    color: rgb(137, 103, 179)
                  - entity: sensor.prise_lave_vaisselle_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: Vaisselle
                    color: rgb(129, 116, 180)
                  - entity: sensor.prise_airfryer_ninja_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: Airfryer (+)
                    color: rgb(142, 122, 181)
                  - entity: sensor.four_et_plaque_de_cuisson_energy
                    transform: return x * 1000;
                    unit: W
                    name: four Plq-cui.
                    color: rgb(162, 148, 249)
                  - entity: sensor.prise_frigo_cuisine_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: frigo
                    color: cyan
                  - entity: sensor.prise_congelateur_cuisine_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: congél.
                    color: rgb(19, 160, 255)
                  - entity: sensor.prise_bureau_pc_ikea_energy
                    transform: return x * 1000;
                    unit: W
                    name: PCe
                    color: orange
                  - entity: sensor.prise_bureau_fer_a_repasser_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: FàR (+)
                    color: gold
                  - entity: sensor.prise_tete_de_lit_chambre_energy
                    transform: return x * 1000;
                    unit: W
                    name: Têtes L.
                    color: rgb(177,194,158)
                  - entity: sensor.prise_tv_chambre_nous_energy
                    transform: return x * 1000;
                    unit: W
                    name: TV
                    color: rgb(30, 81, 40)
                  - entity: sensor.all_standby_energy
                    transform: return x * 1000;
                    unit: W
                    name: Veilles
                    color: grey
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:apexcharts-card
                graph_span: 24h
                cache: false
                update_interval: 1m
                apex_config:
                  chart:
                    height: 300px
                header:
                  show: true
                  title: Conso. Instantanée
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Watts
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: last
                    duration: 10m
                  show:
                    legend_value: false
                    extremas: true
                series:
                  - entity: sensor.prise_box_internet_ikea_power
                    name: Box
                    color: gainsboro
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_horloge_ikea_power
                    name: Horloge
                    color: rgb(183, 183, 183)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_pc_s_gege_ikea_power
                    name: PCg
                    color: rgb(202, 135, 135)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_salon_chargeur_nous_power
                    name: Charge
                    color: rgb(174,68,90)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_four_micro_ondes_nous_power
                    name: Four M.O. (+)
                    color: rgb(98, 78, 136)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_lave_linge_nous_power
                    name: Linge (+)
                    color: rgb(137, 103, 179)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_lave_vaisselle_nous_power
                    name: Vaisselle
                    color: rgb(129,116,180)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_airfryer_ninja_nous_power
                    name: Airfryer (+)
                    color: rgb(142, 122, 181)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.four_et_plaque_de_cuisson_power
                    name: Four Plq Cui.
                    color: rgb(162, 148, 249)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_frigo_cuisine_nous_power
                    name: Frigo
                    color: cyan
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_congelateur_cuisine_nous_power
                    name: Congél
                    color: rgb(19, 160, 255)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_bureau_pc_ikea_power
                    name: PCe
                    color: orange
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_bureau_fer_a_repasser_nous_power
                    name: FàR (+)
                    color: gold
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_tete_de_lit_chambre_power
                    name: Têtes L.
                    color: rgb(177,194,158)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.prise_tv_chambre_nous_power
                    name: TV
                    color: rgb(30, 81,40)
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.all_standby_power
                    name: Veilles
                    color: grey
                    yaxis_id: Watts
                    stroke_width: 2
                    fill_raw: last
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:bubble-card
                    card_type: separator
                    name: 'Sélectionner une pièce :'
                    icon: mdi:arrow-right-bottom-bold
                    rows: 2
                    styles: |-
                      .bubble-line {
                        background: var(--primary-text-color);
                        opacity: 1;
                      }
                  - type: custom:tabbed-card
                    styles:
                      '--mdc-theme-primary': white
                      '--mdc-tab-text-label-color-default': rgba(255, 255, 255, 0.25)
                    options: {}
                    tabs:
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Box Internet
                                - span_offset: +15m
                                - group_duration: 1m
                                - energy_entity: sensor.prise_box_internet_ikea_power
                                - energy_color: gainsboro
                                - current_entity: sensor.prise_box_internet_ikea_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Horloge Entrée
                                - span_offset: +15m
                                - group_duration: 1m
                                - energy_entity: sensor.prise_horloge_ikea_power
                                - energy_color: rgb(183, 183, 183)
                                - current_entity: sensor.prise_horloge_ikea_current
                                - current_color: rgb(255, 41, 41)
                        attributes:
                          label: Entrée
                          icon: mdi:door
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: PC's Géraldine
                                - span_offset: +15m
                                - group_duration: 1m
                                - energy_entity: sensor.prise_pc_s_gege_ikea_power
                                - energy_color: rgb(202, 135, 135)
                                - current_entity: sensor.prise_pc_s_gege_ikea_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: >-
                                    Prise Salon (Chargeurs, Vapote, Aspi.,
                                    Roomba & Fontaine)
                                - span_offset: +15m
                                - group_duration: 1m
                                - energy_entity: sensor.prise_salon_chargeur_nous_power
                                - energy_color: rgb(174, 68, 90)
                                - current_entity: sensor.prise_salon_chargeur_nous_current
                                - current_color: rgb(255, 41, 41)
                        attributes:
                          label: Salon
                          icon: mdi:sofa
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Four Micro-Ondes
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.prise_four_micro_ondes_nous_power
                                - energy_color: rgb(98, 78, 136)
                                - current_entity: sensor.prise_four_micro_ondes_nous_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: >-
                                    Lave-Linge (grille pain, Théière, machine à
                                    café)
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.prise_lave_linge_nous_power
                                - energy_color: rgb(137, 103, 179)
                                - current_entity: sensor.prise_lave_linge_nous_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Lave-Vaisselle
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.prise_lave_vaisselle_nous_power
                                - energy_color: rgb(129, 116, 180)
                                - current_entity: sensor.prise_lave_vaisselle_nous_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Airfryer (Cookéo, mixer, ect...)
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.prise_airfryer_ninja_nous_power
                                - energy_color: rgb(142, 122, 181)
                                - current_entity: sensor.prise_airfryer_ninja_nous_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Four et plaque de Cuisson
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.four_et_plaque_de_cuisson_power
                                - energy_color: rgb(162, 148, 249)
                                - current_entity: sensor.four_et_plaque_de_cuisson_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Frigo
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.prise_frigo_cuisine_nous_power
                                - energy_color: cyan
                                - current_entity: sensor.prise_frigo_cuisine_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Congélateur
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: sensor.prise_congelateur_cuisine_nous_power
                                - energy_color: rgb(19, 160, 255)
                                - current_entity: sensor.prise_congelateur_cuisine_current
                                - current_color: rgb(255, 41, 41)
                        attributes:
                          label: Cuisine
                          icon: mdi:fridge
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: PCe Buraeu
                                - span_offset: +15m
                                - group_duration: 1m
                                - energy_entity: sensor.prise_bureau_pc_ikea_power
                                - energy_color: orange
                                - current_entity: sensor.prise_bureau_pc_ikea_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Fer à Repasser Buraeu (FàR)
                                - span_offset: +15m
                                - group_duration: 1s
                                - energy_entity: >-
                                    sensor.prise_bureau_fer_a_repasser_nous_power
                                - energy_color: gold
                                - current_entity: >-
                                    sensor.prise_bureau_fer_a_repasser_nous_current
                                - current_color: rgb(255, 41, 41)
                        attributes:
                          label: BUREAU
                          icon: mdi:desktop-tower-monitor
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Têtes de Lit chambre
                                - span_offset: +15m
                                - group_duration: 1m
                                - energy_entity: sensor.prise_tete_de_lit_chambre_power
                                - energy_color: rgb(177, 194, 158)
                                - current_entity: sensor.prise_tete_de_lit_chambre_current
                                - current_color: rgb(255, 41, 41)
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: TV Chambre
                                - span_offset: +15m
                                - group_duration: 5m
                                - energy_entity: sensor.prise_tv_chambre_nous_power
                                - energy_color: rgb(30, 81, 40)
                                - current_entity: sensor.prise_tv_chambre_nous_current
                                - current_color: rgb(255, 41, 41)
                        attributes:
                          label: Chambre
                          icon: mdi:bed
                      - card:
                          type: vertical-stack
                          cards:
                            - type: custom:streamline-card
                              template: conso_temps_reel_appareil
                              variables:
                                - card_title: Veilles
                                - span_offset: +1h
                                - group_duration: 1s
                                - energy_entity: sensor.all_standby_power
                                - energy_color: grey
                                - current_entity: sensor.all_standby_power
                                - current_color: red
                        attributes:
                          label: Vieilles
                          icon: mdi:sleep
    cards: []
  - type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:transmission-tower
            heading: ENERGIE MENSUEL (Start Month)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/energie
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: false
            span:
              start: month
            apex_config:
              chart:
                height: 600px
            header:
              show: true
              title: Conso. mensuel
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.prise_box_internet_ikea_energy
                name: Box
                color: gainsboro
              - entity: sensor.prise_horloge_ikea_energy
                name: Horloge
                color: rgb(183, 183, 183)
              - entity: sensor.prise_pc_s_gege_ikea_energy
                name: PCg
                color: rgb(202, 135, 135)
              - entity: sensor.prise_salon_chargeur_nous_energy
                name: Chargeurs
                color: rgb(174,68,90)
              - entity: sensor.prise_lave_linge_nous_energy
                name: Four M-O (+)
                color: rgb(98, 78, 136)
              - entity: sensor.prise_lave_linge_nous_energy
                name: Linge (+)
                color: rgb(137, 103, 179)
              - entity: sensor.prise_lave_vaisselle_nous_energy
                name: Vaisselle
                color: rgb(129, 116, 180)
              - entity: sensor.prise_airfryer_ninja_nous_energy
                name: Airfryer (+)
                color: rgb(142, 122, 181)
              - entity: sensor.four_et_plaque_de_cuisson_energy
                name: Four & Plq Cui.
                color: rgb(162, 148, 249)
              - entity: sensor.prise_frigo_cuisine_nous_energy
                name: frigo
                color: cyan
              - entity: sensor.prise_congelateur_cuisine_nous_energy
                name: congél.
                color: rgb(19, 160, 255)
              - entity: sensor.prise_bureau_pc_ikea_energy
                name: PCe
                color: orange
              - entity: sensor.prise_bureau_fer_a_repasser_nous_energy
                name: FàR (+)
                color: gold
              - entity: sensor.prise_tete_de_lit_chambre_energy
                name: Têtes L.
                color: rgb(177, 194, 158)
              - entity: sensor.prise_tv_chambre_nous_energy
                name: TV
                color: rgb(30, 81, 40)
              - entity: sensor.all_standby_energy
                name: Veilles
                color: grey
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: phu:rooms-hallway
            heading: Entrée
            heading_style: title
            badges: []
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Box Internet
              - energy_entity: sensor.prise_box_internet_ikea_energy
              - color: gainsboro
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Horloge Entrée
              - energy_entity: sensor.prise_horloge_ikea_energy
              - color: rgb(183, 183, 183)
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges: []
            heading: Salon
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Pc's(g) Salon
              - energy_entity: sensor.prise_pc_s_gege_ikea_energy
              - color: rgb(202, 135, 135)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel PC‑S (Charg, Vap, Aspi, iRobot & Fontaine)
              - energy_entity: sensor.prise_salon_chargeur_nous_energy
              - color: rgb(174,68,90)
          - type: heading
            icon: mdi:fridge
            heading: Cuisine
            heading_style: title
            badges: []
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Four Micro-Ondes (Alexa)
              - energy_entity: sensor.prise_four_micro_ondes_nous_energy
              - color: rgb(98, 78, 136)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Lave-Linge (Grille-pain, Théière, M‑café)
              - energy_entity: sensor.prise_lave_linge_nous_energy
              - color: rgb(137, 103, 179)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Lave-Vaisselle
              - energy_entity: sensor.prise_lave_vaisselle_nous_energy
              - color: rgb(129, 116, 180)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel NINJA Airfryer (Cookéo, Etc...)
              - energy_entity: sensor.prise_airfryer_ninja_nous_energy
              - color: rgb(142, 122, 181)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Four & plaque de Cuisson
              - energy_entity: sensor.four_et_plaque_de_cuisson_energy
              - color: rgb(142, 122, 181)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Frigo
              - energy_entity: sensor.prise_frigo_cuisine_nous_energy
              - color: cyan
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Congélateur
              - energy_entity: sensor.prise_congelateur_cuisine_nous_energy
              - color: rgb(19, 160, 255)
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges: []
            heading: Bureau
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Bureau PC(e)
              - energy_entity: sensor.prise_bureau_pc_ikea_energy
              - color: orange
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Fer à Repasser (FàR) & Store
              - energy_entity: sensor.prise_bureau_fer_a_repasser_nous_energy
              - color: gold
          - type: heading
            icon: mdi:bed
            heading: Chambre
            heading_style: title
            badges: []
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Têtes de Lit chambre
              - energy_entity: sensor.prise_tete_de_lit_chambre_energy
              - color: rgb(177, 194, 158)
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel TV Chambre
              - energy_entity: sensor.prise_tv_chambre_nous_energy
              - color: rgb(30,81,40)
          - type: heading
            icon: mdi:sleep
            heading: Veilles
            heading_style: title
            badges: []
          - type: custom:streamline-card
            template: conso_mensuelle_appareil
            variables:
              - title: Conso. mensuel Veilles
              - energy_entity: sensor.all_standby_energy
              - color: grey
    title: Energie HOME Mensuel
    cards: []
    path: energie mensuel
  - type: sections
    path: energie clim
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:transmission-tower
            heading: ENERGIE (C)LIM / (R)ADIATEUR
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.conso_clim_rad_total
                icon: mdi:lightning-bolt-outline
                color: red
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 24h
            cache: false
            span:
              start: day
            apex_config:
              chart:
                height: 600px
            header:
              show: true
              title: Conso. journalière
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.clim_salon_nous_energy
                name: SALON (C)
                color: rgb(174,68,90)
                float_precision: 2
              - entity: sensor.radiateur_elec_cuisine_energy
                name: CUISINE (R)
                color: rgb(168, 136, 181)
                float_precision: 2
              - entity: sensor.clim_du_bureau_nous_energy
                name: BUREAU (C)
                color: orange
                float_precision: 2
              - entity: sensor.prise_radiateur_salle_de_bain_nous_energy
                name: Salle de Bain (R)
                color: magenta
                float_precision: 2
              - entity: sensor.clim_chambre_nous_energy
                name: CHAMBRE (C)
                color: rgb(30,81,40)
                float_precision: 2
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: false
            span:
              start: month
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. mensuel (Start Month)
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.clim_salon_nous_energy
                name: SALON (C)
                color: rgb(174,68,90)
                float_precision: 2
              - entity: sensor.radiateur_elec_cuisine_energy
                name: CUISINE (R)
                color: rgb(168, 136, 181)
                float_precision: 2
              - entity: sensor.clim_du_bureau_nous_energy
                name: BUREAU (C)
                color: orange
                float_precision: 2
              - entity: sensor.prise_radiateur_salle_de_bain_nous_energy
                name: Salle de Bain (R)
                color: magenta
                float_precision: 2
              - entity: sensor.clim_chambre_nous_energy
                name: CHAMBRE (C)
                color: rgb(30,81,40)
                float_precision: 2
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:thermometer-lines
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: false
                entity: sensor.temperature_delta
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: 'Tendances '
          - type: horizontal-stack
            cards:
              - type: custom:vertical-stack-in-card
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.th_balcon_nord_temperature
                    icon: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        mdi:arrow-top-right-thick
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        mdi:arrow-bottom-right-thick
                      {% else %}
                        mdi:arrow-right-thick
                      {% endif %}
                    icon_color: >
                      {% if is_state('sensor.th_balcon_nord_temperature_trend',
                      'increasing') %}
                        red
                      {% elif
                      is_state('sensor.th_balcon_nord_temperature_trend',
                      'decreasing') %}
                        blue
                      {% else %}
                        #df6366
                      {% endif %}
                    primary: ''
                    secondary: '{{ states(''sensor.th_balcon_nord_temperature'') }}°C'
                    layout: horizontal
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_mod:
                      style: |
                        ha-card {
                          background-color: transparent !important;
                          border: none !important;
                        }
                        mushroom-state-info$: |
                          .primary {
                            font-size: 12px !important;
                            color: lightgrey !important;
                            position: relative;
                            bottom: 5px;
                            left: 5px;
                            overflow: visible !important;
                            white-space: normal !important;
                          }
                          .secondary {
                            font-size: 19px !important;
                            position: relative;
                            overflow: visible !important;
                            top: 0px;
                            left: 5px;
                          }
                        mushroom-shape-icon$: |
                          .shape {
                            position: relative;
                            left: 0px;
                            top: 0px;
                          }
                        .: |
                          :host {
                            --mush-icon-size: 50px;
                          }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.th_balcon_nord_temperature
                        name: Température
                        color: '#df6366'
                    height: 200
                    hours_to_show: 24
                    decimals: 1
                    points_per_hour: 6
                    line_width: 2
                    font_size: 80
                    hour24: true
                    animate: true
                    show:
                      labels: true
                      name: false
                      icon: false
                      state: false
                      legend: false
                      extrema: true
                      fill: fade
                      points: false
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                  height: 228px;
                  margin-left: auto;
                  margin-right: auto;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salon_temperature
                color: green
                state_content:
                  - name
                  - state
                name: Salon
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.clim
              - entity: climate.clim
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
                show_name: false
                name: Ventil.
            icon: mdi:air-conditioner
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            name: Clim du Salon
          - type: gauge
            entity: sensor.clim_salon_nous_current
            name: Clim. Salon (A)
            unit: A
            needle: true
            min: 0
            max: 10
            severity:
              green: 0
              yellow: 7.5
              red: 9
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.clim_salon_nous_voltage
            name: Clim. Salon (V)
            needle: true
            max: 240
            severity:
              green: 219
              yellow: 200
              red: 180
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            unit: V
            min: 180
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:streamline-card
            template: conso_temps_reel_clim_rad
            variables:
              - card_title: Conso. Temps Réel Clim. Salon
              - energy_entity: sensor.clim_salon_nous_power
              - energy_color: rgb(174,68,90)
              - current_entity: sensor.clim_salon_nous_current
              - current_color: rgb(255, 41, 41)
              - power_entity_avg: sensor.clim_salon_nous_power
              - power_entity: sensor.clim_salon_nous_power
              - power_color: rgb(174,68,90)
              - span_offset: +3m
              - group_duration: 1s
          - type: heading
            icon: mdi:sofa
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.clim_salon_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_salon_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:streamline-card
            template: conso_mensuelle_clim
            variables:
              - title: Conso. mensuel Clim Salon
              - energy_entity: sensor.clim_salon_nous_energy
              - energy_name: Conso. jours en cours
              - energy_color: rgb(174,68,90)
              - avg_color: red
              - avg_name: Avg(730h)
              - temp_entity: sensor.th_balcon_nord_temperature
              - temp_color: rgb(126, 24, 145)
              - temp_unit: °C
              - temp_name: T.Mini.(24h)
          - type: heading
            icon: mdi:fridge
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.radiateur_cuisine
                icon: mdi:power
                color: state
                tap_action:
                  action: more-info
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_cuisine_temperature
                color: green
                name: Cuisine
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CUISINE  (RADIATEUR)
          - type: custom:bubble-card
            card_type: climate
            entity: climate.radiateur_cuisine
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.radiateur_cuisine
            icon: ''
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
            name: Radiateur de la Cuisine
          - type: gauge
            entity: sensor.radiateur_elec_cuisine_current
            name: Radiateur Cuisine (A)
            unit: A
            needle: true
            min: 0
            max: 10
            severity:
              green: 0
              yellow: 7.5
              red: 9
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.radiateur_elec_cuisine_voltage
            name: Radiateur Cuisine (V)
            needle: true
            max: 240
            severity:
              green: 219
              yellow: 200
              red: 0
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: auto
            unit: V
            min: 180
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:streamline-card
            template: conso_temps_reel_clim_rad
            variables:
              card_title: Conso. Temps Réel Radiateur Cuisine
              energy_entity: sensor.radiateur_elec_cuisine_power
              energy_color: rgb(168, 136, 181)
              current_entity: sensor.radiateur_elec_cuisine_current
              current_color: rgb(255, 41, 41)
              power_entity_avg: sensor.radiateur_elec_cuisine_power
              power_entity: sensor.radiateur_elec_cuisine_power
              power_color: rgb(168, 136, 181)
              span_offset: +3m
              group_duration: 1s
          - type: heading
            icon: mdi:fridge
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.radiateur_elec_cuisine_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_elec_cuisine_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:streamline-card
            template: conso_mensuelle_clim
            variables:
              - title: Conso. mensuel Radiateur Cuisine
              - energy_entity: sensor.radiateur_elec_cuisine_energy
              - energy_name: Conso. jours en cours
              - energy_color: rgb(168, 136, 181)
              - avg_color: red
              - avg_name: Avg(730h)
              - temp_entity: sensor.th_balcon_nord_temperature
              - temp_color: rgb(126, 24, 145)
              - temp_unit: °C
              - temp_name: T.Min.(24h)
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_du_bureau
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                color: green
                name: Bureau
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: BUREAU
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_du_bureau
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
              - entity: climate.clim_du_bureau
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
            icon: mdi:air-conditioner
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
          - type: gauge
            entity: sensor.clim_bureau_current
            name: Clim. Bureau (A)
            unit: A
            needle: true
            min: 0
            max: 10
            severity:
              green: 0
              yellow: 7.5
              red: 9
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.clim_bureau_voltage
            name: Clim. Bureau (V)
            needle: true
            max: 240
            severity:
              green: 219
              yellow: 200
              red: 0
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            unit: V
            min: 180
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:streamline-card
            template: conso_temps_reel_clim_rad
            variables:
              card_title: Conso. Temps Réel Clim. Bureau
              energy_entity: sensor.clim_du_bureau_nous_power
              energy_color: orange
              current_entity: sensor.clim_bureau_current
              current_color: rgb(255, 41, 41)
              power_entity_avg: sensor.clim_du_bureau_nous_power
              power_entity: sensor.clim_du_bureau_nous_power
              power_color: orange
              span_offset: +3m
              group_duration: 1s
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.clim_du_bureau_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_du_bureau_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_du_bureau_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_du_bureau_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:streamline-card
            template: conso_mensuelle_clim
            variables:
              - title: Conso. mensuel Clim Bureau
              - energy_entity: sensor.clim_du_bureau_nous_energy
              - energy_name: Conso. jours en cours
              - energy_color: orange
              - avg_color: red
              - avg_name: Avg(730h)
              - temp_entity: sensor.th_balcon_nord_temperature
              - temp_color: rgb(126, 24, 145)
              - temp_unit: °C
              - temp_name: T.Mini.(24h)
          - type: heading
            icon: hue:room-bathroom
            heading: Salle de Bain
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_salle_de_bain_temperature
                color: green
          - type: gauge
            entity: sensor.prise_radiateur_salle_de_bain_nous_current
            name: Rad. SdB (A)
            unit: A
            needle: true
            min: 0
            max: 10
            severity:
              green: 0
              yellow: 7.5
              red: 9
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.prise_radiateur_salle_de_bain_nous_voltage
            name: Rad. SdB (V)
            needle: true
            max: 240
            severity:
              green: 219
              yellow: 200
              red: 0
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            unit: V
            min: 180
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:streamline-card
            template: conso_temps_reel_clim_rad
            variables:
              card_title: Radiateur Salle de Bain
              energy_entity: sensor.prise_radiateur_salle_de_bain_nous_power
              energy_color: magenta
              current_entity: sensor.prise_radiateur_salle_de_bain_nous_current
              current_color: rgb(255, 41, 41)
              power_entity_avg: sensor.prise_radiateur_salle_de_bain_nous_power
              power_entity: sensor.prise_radiateur_salle_de_bain_nous_power
              power_color: magenta
              span_offset: +15m
              group_duration: 1m
          - type: heading
            icon: mdi:bathtub
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.radiateur_sdb_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_sdb_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_sdb_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.radiateur_sdb_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:streamline-card
            template: conso_mensuelle_clim
            variables:
              - title: Conso. mensuel Radiateur SdB
              - energy_entity: sensor.prise_radiateur_salle_de_bain_nous_energy
              - energy_name: Conso. jours en cours
              - energy_color: magenta
              - avg_color: red
              - avg_name: Avg(730h)
              - temp_entity: sensor.th_balcon_nord_temperature
              - temp_color: rgb(126, 24, 145)
              - temp_unit: °C
              - temp_name: T.Min.(24h)
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: climate.clim_de_la_chambre
                color: state
                tap_action:
                  action: more-info
                icon: mdi:thermometer
                state_content:
                  - name
                  - temperature
                name: Réglé à
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_chambre_temperature
                name: Chambre
                state_content:
                  - name
                  - state
                color: green
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: CHAMBRE
          - type: custom:bubble-card
            card_type: climate
            entity: climate.clim_de_la_chambre
            sub_button:
              - name: HVAC modes menu
                select_attribute: hvac_modes
                state_background: false
                show_arrow: true
                show_background: true
                show_attribute: false
                entity: climate.clim_de_la_chambre
              - entity: climate.clim_de_la_chambre
                select_attribute: fan_modes
                show_background: true
                state_background: false
                show_icon: true
                icon: mdi:fan
                name: Ventil.
                show_state: false
                show_name: false
                show_attribute: false
                show_last_changed: false
                show_arrow: true
            icon: mdi:air-conditioner
            scrolling_effect: false
            show_icon: true
            force_icon: false
            show_name: true
            show_state: true
            show_attribute: true
            attribute: fan_mode
          - type: gauge
            entity: sensor.clim_chambre_nous_current
            name: Clim. chambre (A)
            unit: A
            needle: true
            min: 0
            max: 10
            severity:
              green: 0
              yellow: 7.5
              red: 9
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: gauge
            entity: sensor.clim_chambre_nous_voltage
            name: Clim. chambre (V)
            needle: true
            max: 240
            severity:
              green: 219
              yellow: 200
              red: 0
            tap_action:
              action: none
            grid_options:
              columns: 6
              rows: 3
            unit: V
            min: 180
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:streamline-card
            template: conso_temps_reel_clim_rad
            variables:
              card_title: Conso. Temps Réel Clim. Chambre
              energy_entity: sensor.clim_chambre_nous_power
              energy_color: rgb(30,81,40)
              current_entity: sensor.clim_chambre_nous_current
              current_color: rgb(255, 41, 41)
              power_entity_avg: sensor.clim_chambre_nous_power
              power_entity: sensor.clim_chambre_nous_power
              power_color: rgb(30,81,40)
              span_offset: +3m
              group_duration: 1s
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.clim_chambre_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_chambre_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:streamline-card
            template: conso_mensuelle_clim
            variables:
              - title: Conso. mensuel Clim de la Chambre
              - energy_entity: sensor.clim_chambre_nous_energy
              - energy_name: Conso. jours en cours
              - energy_color: rgb(30,81,40)
              - avg_color: red
              - avg_name: Avg(730h)
              - temp_entity: sensor.th_balcon_nord_temperature
              - temp_color: rgb(126, 24, 145)
              - temp_unit: °C
              - temp_name: T.Min.(24h)
    title: Energie Clim
    cards: []
  - type: sections
    path: irobot
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: phu:pet-water-fountian
            heading: XIAOMI - Pet Fountain
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: entities
            title: Fontaine - On/Off
            state_color: true
            entities:
              - entity: light.mmgg_wi11_8b36_indicator_light
                icon: mdi:lightning-bolt-circle
                name: Indicator Light
                secondary_info: none
              - entity: switch.mmgg_wi11_8b36_pet_drinking_fountain
                name: Fontaine On / Off
              - entity: binary_sensor.mmgg_wi11_8b36_pump_block_flag
                name: No Water
                icon: mdi:water-circle
              - entity: sensor.message_fontaine_a_eau_de_minouche
                secondary_info: none
                name: 'Info:'
              - entity: select.mmgg_wi11_8b36_mode
                name: Common (Normal) / Smart (Intelligent)
              - entity: button.mmgg_wi11_8b36_reset_filter_life
                name: Reset Filtre
                icon: mdi:button-cursor
              - entity: sensor.mmgg_wi11_8b36_filter_left_time_2
                name: Jours restant avant remplacement
                icon: phu:pool-filter
              - entity: button.mmgg_wi11_8b36_reset_clean_time
                name: Nettoyage
                icon: mdi:button-cursor
              - entity: sensor.mmgg_wi11_8b36_remain_clean_time
                name: Jours Restant Avant le Nettoyage
                icon: mdi:spray-bottle
              - entity: update.xiaomi_miot_auto_update
                icon: phu:xiaomi-logo
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
          - type: heading
            icon: mdi:robot-vacuum
            heading: IROBOT - ROUMBA
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:vacuum-card
            entity: vacuum.roomba_home
            style: |
              ha-card {
                --vc-background: #17A8F4;
                --vc-spacing: 5px;
              }
    title: IRobot
    cards: []
  - type: sections
    max_columns: 3
    path: energie lampes
    title: Lampes
    sections:
      - type: grid
        cards:
          - type: heading
            icon: hue:bulb-group-filament-hung
            heading: LAMPES
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.salon
                color: state
                icon: hue:flourish-alt
                tap_action:
                  action: more-info
                state_content: state
              - type: entity
                show_state: true
                show_icon: true
                entity: light.table
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 24h
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES SALON CONSO. PAR JOURS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_ambiance_lamp_salon_1_energy
                name: Salon 1A (B1)
                color: C9DABF
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_2_energy
                name: Salon 2A (B2)
                color: 9CA986
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_3_energy
                name: Salon 3A (L1)
                color: 808D7C
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_salon_1_energy
                name: Salon 1C (L1)
                color: 5F6F65
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_table_salon_energy
                name: Table
                color: 677D6A
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES SALON CONSO. PAR MOIS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_ambiance_lamp_salon_1_energy
                name: Salon 1A (B1)
                color: C9DABF
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_2_energy
                name: Salon 2A (B2)
                color: 9CA986
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_ambiance_lamp_salon_3_energy
                name: Salon 3A (L1)
                color: 808D7C
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_salon_1_energy
                name: Salon 1C (L1)
                color: 5F6F65
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_table_salon_energy
                name: Table
                color: 677D6A
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            graph_span: 730h
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. Mensuel Lampes Salon
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: ~0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: ~0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_salon_5_energie
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: C9DABF
                type: column
              - entity: sensor.eclairage_salon_5_energie
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: Wh
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_salon_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salon_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salon_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salon_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            grid_options:
              columns: 36
              rows: 1
          - type: heading
            icon: mdi:home
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.entree
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.cuisine
                icon: mdi:ceiling-light
                color: state
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.couloir
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
            heading: ENTREE - CUISINE - COULOIR
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 24h
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes Entrée - Cuisine - Couloir Conso. / Jrs
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_entree_energy
                name: Entrée
                color: rgb(255, 207, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_cuisine_energy
                name: Cuisine
                color: rgb(222, 143, 95)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_couloir_energy
                name: Couloir
                color: rgb(255, 178, 111)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes Entrée - Cuisine - Couloir Conso. / Mois
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_entree_energy
                name: Entrée
                color: rgb(255, 207, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_cuisine_energy
                name: Cuisine
                color: rgb(222, 143, 95)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_couloir_energy
                name: Couloir
                color: rgb(255, 178, 111)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            graph_span: 730h
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. Mensuel Lampes Entrée, Cuisine & Couloir
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: ~0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: ~0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_appart_3_energie
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(222, 143, 95)
                type: column
              - entity: sensor.eclairage_appart_3_energie
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: Wh
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:home-lightbulb-outline
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_appart_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_appart_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_appart_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_appart_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            grid_options:
              columns: 36
              rows: 1
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.bureau
                color: state
                state_content: name
                icon: mdi:desktop-tower-monitor
                name: Pc
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.bureau_z2m
                name: Bureau
                icon: hue:wellner-solid
                color: state
                state_content: name
                tap_action:
                  action: more-info
            heading: BUREAU
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 24h
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES BUREAU CONSO. PAR JOURS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_play_1_pc_bureau_energy
                name: play 1
                color: rgb(22, 72, 99)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_2_pc_bureau_energy
                name: play 2
                color: rgb(66, 125, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_3_pc_bureau_energy
                name: play 3
                color: rgb(155, 190, 200)
                transform: return x * 1000;
                unit: W
              - entity: sensor.lampe_bureau_1_ikea_energy
                name: Bureau IKEA 1
                color: rgb(122, 178, 211)
                transform: return x * 1000;
                unit: W
              - entity: sensor.lampe_bureau_2_ikea_energy
                name: Bureau IKEA 2
                color: rgb(74, 98, 138)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES BUREAU CONSO. PAR MOIS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_play_1_pc_bureau_energy
                name: play 1
                color: rgb(22, 72, 99)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_2_pc_bureau_energy
                name: play 2
                color: rgb(66, 125, 157)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_play_3_pc_bureau_energy
                name: play 3
                color: rgb(155, 190, 200)
                transform: return x * 1000;
                unit: W
              - entity: sensor.lampe_bureau_1_ikea_energy
                name: Bureau IKEA 1
                color: rgb(122, 178, 211)
                transform: return x * 1000;
                unit: W
              - entity: sensor.lampe_bureau_2_ikea_energy
                name: Bureau IKEA 2
                color: rgb(74, 98, 138)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            graph_span: 730h
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. mensuel Lampes Bureau
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: ~0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: ~0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_bureau_5_energie
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(22, 72, 99)
                type: column
              - entity: sensor.eclairage_bureau_5_energie
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: Wh
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:sofa
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_bureau_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_bureau_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_bureau_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_bureau_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:shower
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.lampe_salle_de_bain_hue
                color: state
                icon: mdi:ceiling-light
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: switch.relais_lumiere_sdb_sonoff
                icon: hue:adore-alt
                color: state
                tap_action:
                  action: more-info
            heading: SALLE DE BAIN
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 24h
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes Salle de bain Conso. / Jrs
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.lampe_salle_de_bain_hue_energy
                name: Salle de bain
                color: rgb(127, 85, 177)
                transform: return x * 1000;
                unit: W
              - entity: sensor.relais_lumiere_sdb_sonoff_energy
                name: Miroir
                color: rgb(155, 126, 189)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: Lampes Salle de Bain Conso. / Mois
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.lampe_salle_de_bain_hue_energy
                name: Salle de bain
                color: rgb(127, 85, 177)
                transform: return x * 1000;
                unit: W
              - entity: sensor.relais_lumiere_sdb_sonoff_energy
                name: Miroir
                color: rgb(155, 126, 189)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            graph_span: 730h
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. Mensuel Lampes Salle de Bain
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: ~0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: ~0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_sdb_2_energie
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(127, 85, 177)
                type: column
              - entity: sensor.eclairage_sdb_2_energie
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: Wh
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:shower
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_eclairage_salle_de_bain_2_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_eclairage_salle_de_bain_2_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_eclairage_salle_de_bain_2_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_salle_de_bain_2_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: light.chambre
                color: state
                icon: hue:flourish-alt
                tap_action:
                  action: more-info
              - type: entity
                show_state: true
                show_icon: true
                entity: light.lit
                icon: mdi:bed
                color: state
                tap_action:
                  action: more-info
            heading: CHAMBRE
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 24h
            cache: true
            span:
              start: day
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES CHAMBRE CONSO. PAR JOURS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_chambre_1_energy
                name: Chambre 1 (B1)
                color: rgb(255, 198, 198)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_chambre_2_energy
                name: Chambre 2 (B2)
                color: rgb(217, 171, 171)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_gege_energy
                name: Géraldine (TL1)
                color: rgb(199, 91, 122)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_eric_energy
                name: Eric (TL2)
                color: rgb(146, 26, 64)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            chart_type: donut
            graph_span: 730h
            cache: true
            span:
              start: month
            apex_config:
              chart:
                height: 700px
            header:
              show: true
              title: LAMPES CHAMBRE CONSO. PAR MOIS
              show_states: true
              colorize_states: true
            all_series_config:
              group_by:
                func: diff
                duration: 730h
              show:
                legend_value: false
                extremas: false
            show:
              loading: true
              last_updated: false
            series:
              - entity: sensor.hue_white_lamp_chambre_1_energy
                name: Chambre 1 (B1)
                color: rgb(255, 198, 198)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_white_lamp_chambre_2_energy
                name: Chambre 2 (B2)
                color: rgb(217, 171, 171)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_gege_energy
                name: Géraldine (TL1)
                color: rgb(199, 91, 122)
                transform: return x * 1000;
                unit: W
              - entity: sensor.hue_color_candle_chambre_eric_energy
                name: Eric (TL2)
                color: rgb(146, 26, 64)
                transform: return x * 1000;
                unit: W
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: custom:apexcharts-card
            graph_span: 730h
            span:
              end: day
            apex_config:
              chart:
                height: 500px
            header:
              show: true
              title: Conso. mensuel Lampes Chambre
              show_states: true
              colorize_states: true
            yaxis:
              - id: Watts
                min: ~0
                max: auto
                opposite: false
                decimals: 0
                apex_config:
                  tickAmount: 4
              - id: Avg
                min: ~0
                max: auto
                opposite: true
                decimals: 1
                apex_config:
                  tickAmount: 4
            all_series_config:
              group_by:
                func: diff
                duration: 24h
              show:
                legend_value: true
                extremas: true
            series:
              - entity: sensor.eclairage_chambre_4_energie
                transform: return x * 1000;
                unit: W
                name: Conso. par jours
                yaxis_id: Watts
                color: rgb(146, 26, 64)
                type: column
              - entity: sensor.eclairage_chambre_4_energie
                yaxis_id: Avg
                type: line
                stroke_dash: 8
                color: red
                unit: Wh
                stroke_width: 1
                name: Avg(730hrs)
                group_by:
                  func: avg
                  duration: 730h
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:bed
            heading_style: subtitle
            badges:
              - type: entity
                show_state: true
                show_icon: true
                color: amber
                state_content:
                  - name
                  - state
                entity: sensor.eclairage_chambre_quotidien
                name: Q
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_chambre_hebdomadaire
                name: H
                color: orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_chambre_mensuel
                name: M
                color: deep-orange
                state_content:
                  - name
                  - state
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.eclairage_chambre_annuel
                name: A
                color: red
                state_content:
                  - name
                  - state
            layout_options:
              grid_columns: full
              grid_rows: 1
        column_span: 3
    cards: []
  - title: Portable
    path: phone
    cards: []
    type: sections
    max_columns: 2
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Oneplus 10Pro NE2213 (E)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
              brush: true
            graph_span: 24h
            brush:
              selection_span: 30m
              apex_config: null
            header:
              show: true
              title: Niveau de la batterie
              show_states: true
              colorize_states: true
            yaxis:
              - id: Niveau
                min: ~0
                max: ~100
                decimals: 0
            series:
              - entity: sensor.ne2213_battery_level
                yaxis_id: Niveau
                name: Batterie
                color: green
                type: area
                stroke_width: 1
                color_threshold:
                  - value: 80
                    color: green
                  - value: 50
                    color: orange
                  - value: 20
                    color: red
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: entities
            entities:
              - entity: sensor.ne2213_battery_level
              - entity: sensor.ne2213_battery_state
                name: Battery state
              - entity: sensor.ne2213_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.ne2213_battery_health
                name: Battery health
                secondary_info: none
              - entity: sensor.ne2213_battery_temperature
              - entity: sensor.ne2213_network_type
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Oneplus 7 GM1901
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
              brush: true
            graph_span: 24h
            brush:
              selection_span: 30m
              apex_config: null
            header:
              show: true
              title: Niveau de la batterie
              show_states: true
              colorize_states: true
            yaxis:
              - id: Niveau
                min: ~0
                max: ~100
                decimals: 0
            series:
              - entity: sensor.gm1901_battery_level
                yaxis_id: Niveau
                name: Batterie
                color: green
                type: area
                stroke_width: 1
                color_threshold:
                  - value: 80
                    color: green
                  - value: 50
                    color: orange
                  - value: 20
                    color: red
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: entities
            entities:
              - entity: sensor.gm1901_battery_level
              - entity: sensor.gm1901_battery_state
                name: Battery state
              - entity: sensor.gm1901_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.gm1901_battery_health
              - entity: sensor.gm1901_battery_temperature
              - entity: sensor.gm1901_network_type
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Samsung A8 SM-A530F
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
              brush: true
            graph_span: 24h
            brush:
              selection_span: 30m
              apex_config: null
            header:
              show: true
              title: Niveau de la batterie
              show_states: true
              colorize_states: true
            yaxis:
              - id: Niveau
                min: ~0
                max: ~100
                decimals: 0
            series:
              - entity: sensor.sm_a530f_battery_level
                yaxis_id: Niveau
                name: Batterie
                color: green
                type: area
                stroke_width: 1
                color_threshold:
                  - value: 80
                    color: green
                  - value: 50
                    color: orange
                  - value: 20
                    color: red
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: entities
            entities:
              - entity: sensor.sm_a530f_battery_level
              - entity: sensor.sm_a530f_battery_state
                name: Battery state
              - entity: sensor.sm_a530f_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.sm_a530f_battery_health
              - entity: sensor.sm_a530f_battery_temperature
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
      - type: grid
        cards:
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Oneplus 10Pro NE2213 (M)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
              brush: true
            graph_span: 24h
            brush:
              selection_span: 30m
              apex_config: null
            header:
              show: true
              title: Niveau de la batterie
              show_states: true
              colorize_states: true
            yaxis:
              - id: Niveau
                min: ~0
                max: ~100
                decimals: 0
            series:
              - entity: sensor.ne2213_mamour_battery_level
                yaxis_id: Niveau
                name: Batterie
                color: green
                type: area
                stroke_width: 1
                color_threshold:
                  - value: 80
                    color: green
                  - value: 50
                    color: orange
                  - value: 20
                    color: red
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: entities
            entities:
              - entity: sensor.ne2213_mamour_battery_level
              - entity: sensor.ne2213_mamour_battery_state
                name: Battery state
              - entity: sensor.ne2213_mamour_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.ne2213_battery_health
                name: Battery health
                secondary_info: none
              - entity: sensor.ne2213_mamour_battery_temperature
              - entity: sensor.ne2213_mamour_network_type
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:cellphone-nfc
            heading: Tablette
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: custom:apexcharts-card
            experimental:
              color_threshold: true
              brush: true
            graph_span: 24h
            brush:
              selection_span: 30m
              apex_config: null
            header:
              show: true
              title: Niveau de la batterie
              show_states: true
              colorize_states: true
            yaxis:
              - id: Niveau
                min: ~0
                max: ~100
                decimals: 0
            series:
              - entity: sensor.tablette_battery_level
                yaxis_id: Niveau
                name: Batterie
                color: green
                type: area
                stroke_width: 1
                color_threshold:
                  - value: 80
                    color: green
                  - value: 50
                    color: orange
                  - value: 20
                    color: red
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: entities
            entities:
              - entity: sensor.tablette_battery_level
              - entity: sensor.tablette_battery_state
                name: Battery state
              - entity: sensor.tablette_charger_type
                name: Charger type
                secondary_info: none
              - entity: sensor.tablette_battery_health
              - entity: sensor.tablette_battery_temperature
            state_color: true
            show_header_toggle: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
  - type: sections
    path: prises
    max_columns: 1
    title: Prises
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:power-standby
            heading: PRISES éCO.
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: phu:rooms-hallway
            heading: Entrée
            heading_style: title
            badges: []
          - type: custom:mushroom-template-card
            entity: switch.prise_horloge_ikea
            primary: Prise Eco. Horloge
            secondary: |
              {% if is_state('switch.prise_horloge_ikea', 'on') %}
                Allumée
              {% else %}
                Economie 
              {% endif %}
            icon: |
              {% if is_state('switch.prise_horloge_ikea', 'on') %}
                mdi:power-socket-fr
              {% else %}
                mdi:power-sleep
              {% endif %}
            icon_color: |
              {% if is_state('switch.prise_horloge_ikea', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('switch.prise_horloge_ikea', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('switch.prise_horloge_ikea', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('switch.prise_horloge_ikea', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('switch.prise_horloge_ikea', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: cover.store_salon
                color: state
                tap_action:
                  action: more-info
            heading: Salon
          - type: custom:mushroom-template-card
            entity: light.hue_smart_salon
            primary: Prise Eco. Salon (Chargeur ACU. etc...)
            secondary: |
              {% if is_state('light.hue_smart_salon', 'on') %}
                Allumée
              {% else %}
                Economie 
              {% endif %}
            icon: |
              {% if is_state('light.hue_smart_salon', 'on') %}
                mdi:power-socket-fr
              {% else %}
                mdi:power-sleep
              {% endif %}
            icon_color: |
              {% if is_state('light.hue_smart_salon', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.hue_smart_salon', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.hue_smart_salon', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 20px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.hue_smart_salon', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.hue_smart_salon', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
          - type: custom:mushroom-template-card
            entity: light.hue_smart_tv_salon
            primary: Prise Eco. TV Salon
            secondary: |
              {% if is_state('light.hue_smart_tv_salon', 'on') %}
                Allumée
              {% else %}
                Economie 
              {% endif %}
            icon: |
              {% if is_state('light.hue_smart_tv_salon', 'on') %}
                mdi:power-socket-fr
              {% else %}
                mdi:power-sleep
              {% endif %}
            icon_color: |
              {% if is_state('light.hue_smart_tv_salon', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.hue_smart_tv_salon', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.hue_smart_tv_salon', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.hue_smart_tv_salon', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.hue_smart_tv_salon', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.th_bureau_temperature
                color: green
              - type: entity
                show_state: true
                show_icon: true
                entity: cover.store_bureau
                color: state
                tap_action:
                  action: more-info
            heading: Bureau
          - type: custom:mushroom-template-card
            entity: switch.hue_smart_eco_pc_bureau
            primary: Prise Eco. PC Bureau
            secondary: |
              {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %}
                Allumée
              {% else %}
                Economie 
              {% endif %}
            icon: |
              {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %}
                mdi:power-socket-fr
              {% else %}
                mdi:power-sleep
              {% endif %}
            icon_color: |
              {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('switch.hue_smart_eco_pc_bureau', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
          - type: heading
            icon: mdi:bed
            heading: Chambre
            heading_style: title
            badges:
              - type: entity
                show_state: true
                show_icon: true
                entity: sensor.clim_de_la_chambre_temperature
                color: green
          - type: custom:mushroom-template-card
            entity: light.hue_smart_tv_chambre
            primary: Prise Eco. TV Chambre
            secondary: |
              {% if is_state('light.hue_smart_tv_chambre', 'on') %}
                Allumée
              {% else %}
                Economie 
              {% endif %}
            icon: |
              {% if is_state('light.hue_smart_tv_chambre', 'on') %}
                mdi:power-socket-fr
              {% else %}
                mdi:power-sleep
              {% endif %}
            icon_color: |
              {% if is_state('light.hue_smart_tv_chambre', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('light.hue_smart_tv_chambre', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('light.hue_smart_tv_chambre', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('light.hue_smart_tv_chambre', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('light.hue_smart_tv_chambre', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
          - type: heading
            icon: mdi:bed
            heading: Tête de Lit
            heading_style: title
            badges: []
          - type: custom:mushroom-template-card
            entity: switch.prise_tete_de_lit_chambre
            primary: Prise Eco. Têtes de Lit
            secondary: |
              {% if is_state('light.hue_smart_tv_chambre', 'on') %}
                Allumée
              {% else %}
                Economie 
              {% endif %}
            icon: |
              {% if is_state('switch.prise_tete_de_lit_chambre', 'on') %}
                mdi:power-socket-fr
              {% else %}
                mdi:power-sleep
              {% endif %}
            icon_color: |
              {% if is_state('switch.prise_tete_de_lit_chambre', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            badge_icon: |
              {% if is_state('switch.prise_tete_de_lit_chambre', 'on') %}
                mdi:checkbox-marked-circle
              {% else %}
                mdi:checkbox-blank-circle-outline
              {% endif %}
            badge_color: |
              {% if is_state('switch.prise_tete_de_lit_chambre', 'on') %}
                green
              {% else %}
                grey
              {% endif %}
            tap_action:
              action: toggle
            grid_options:
              columns: 12
              rows: 2
            card_mod:
              style:
                mushroom-state-info$: |
                  .primary {
                    position: relative;
                    top: -5px;
                    left: 10px;
                    font-size: 24px !important;
                    font-weight: bold;
                  }
                  .secondary {
                    position: relative;
                    top: 5px;
                    left: 10px;
                    font-size: 12px !important;
                  }
                .: |
                  :host {
                    --mush-icon-size: 70px;
                  }
                style: |
                  ha-card {
                    border: 1px solid {% if is_state('switch.prise_tete_de_lit_chambre', 'on') %} green {% else %} grey {% endif %};
                    background-color: {% if is_state('switch.prise_tete_de_lit_chambre', 'on') %} rgba(0, 255, 0, 0.1) {% else %} transparent {% endif %};
                  }  
  - title: BATTERY (BP)
    path: battery bp
    cards: []
    type: sections
    max_columns: 1
    sections:
      - type: grid
        columns: 1
        square: false
        cards:
          - type: heading
            icon: mdi:battery-high
            heading: BATTERIES (Boutons / Thermostats / Détecteurs…)
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries des boutons-poussoirs HUE
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Boutons HUE (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:light-switch
                icon_color: first
                entities:
                  - sensor.hue_smart_button_entee_1_battery
                  - sensor.hue_smart_button_entee_2_battery
                  - sensor.hue_smart_button_eco_battery
                  - sensor.hue_smart_button_table_battery
                  - sensor.hue_smart_button_cuisine_battery
                  - sensor.hue_smart_button_couloir_battery
                  - sensor.boutton_bureau_hue_battery
                  - sensor.boutton_salle_de_bain_hue_battery
                  - sensor.hue_smart_button_chambre_battery
                  - sensor.eric_hue_smart_button_chambre_battery
                  - sensor.gege_hue_smart_button_chambre_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries — boutons & détecteurs IKEA
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Capteurs IKEA (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:hammer-screwdriver
                icon_color: first
                entities:
                  - sensor.poussoir_ikea_tradfri_battery
                  - sensor.inter_bureau_rodret_battery
                  - sensor.inter_somrig_battery
                  - sensor.inter_salon_4_ikea_battery
                  - sensor.detecteur_de_fuite_ikea_battery
                  - sensor.detecteur_vallhorn_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries — contacts de fenêtres IKEA
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Contacts de fenêtres IKEA (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:window-closed-variant
                icon_color: first
                entities:
                  - sensor.contact_fenetre_salon_ikea_battery
                  - sensor.contact_fenetre_cuisine_ikea_battery
                  - sensor.contact_fenetre_bureau_ikea_battery
                  - sensor.contact_fenetre_chambre_ikea_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: heading
            icon: mdi:battery-high
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Batteries — thermostats SONOFF
          - type: custom:battery-state-card
            secondary_info: '{last_changed}'
            colors:
              steps:
                - '#ff0000'
                - '#ffff00'
                - '#00ff00'
              gradient: true
            filter:
              exclude:
                - name: entity_id
                  value: sensor.ne2213_*
                - name: entity_id
                  value: sensor.gm1901_battery_level
                - name: entity_id
                  value: sensor.sm_a530f_battery_level
                - name: entity_id
                  value: sensor.tablette_battery_level
            collapse:
              - name: 'Thermostats SONOFF (Total : {count} / Mini. : {min} %)'
                secondary_info: 'Niveaux de batterie : {range} %'
                icon: mdi:thermometer
                icon_color: first
                entities:
                  - sensor.th_balcon_nord_battery
                  - sensor.th_salon_battery
                  - sensor.th_cellier_battery
                  - sensor.th_cuisine_battery
                  - sensor.th_bureau_battery
                  - sensor.th_salle_de_bain_battery
                  - sensor.th_chambre_battery
            sort:
              by: state
            bulk_rename:
              - from: ' Batterie'
              - from: ' Battery'
              - from: ' level'
              - from: ' (HUE)'
              - from: Hue Smart
              - from: button
                to: Bouton
              - from: Th
                to: Thermostat
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
  - title: Système Rpi
    path: systeme rpi
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: phu:intel-nuc
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: Mini - P.C.
          - type: vertical-stack
            cards:
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: picture
                    image: /local/images/mini pc.png
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                          }
                  - type: custom:stack-in-card
                    mode: horizontal
                    cards:
                      - type: custom:mushroom-template-card
                        primary: 'IP Int. / Ext.:'
                        secondary: ' '
                        icon: mdi:ip
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                      - type: custom:mushroom-template-card
                        primary: '{{ states(''sensor.local_ip'') }}'
                        secondary: ' '
                        icon: mdi:ip-network
                        icon_color: white
                        tap_action:
                          action: navigate
                          navigation_path: '#temp'
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                margin-left: -20px;
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                      - type: custom:mushroom-template-card
                        primary: '{{ states(''sensor.myip'') }}'
                        secondary: ''
                        icon: mdi:wan
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                margin-left: -20px;
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:stack-in-card
                    mode: horizontal
                    cards:
                      - type: custom:mushroom-template-card
                        primary: 'Uptime:'
                        secondary: ' '
                        icon: mdi:clock-outline
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                      - type: custom:mushroom-template-card
                        primary: >-
                          {% set uptime = (now()|as_timestamp -
                          states('sensor.system_monitor_dernier_demarrage')|as_timestamp)
                          %} {% set jours = (uptime / 86400) | int(0) %} {%- if
                          jours > 0 -%} {{ jours }}d {{ (uptime - (jours *
                          86400)) | int(0) | timestamp_custom('%Hh %Mm', false)
                          }} {%- else -%} {{ uptime | int(0) |
                          timestamp_custom('%Hh %Mm', false) }} {%- endif -%}
                        secondary: ''
                        icon: mdi:clock-start
                        icon_color: white
                        tap_action:
                          action: none
                        card_mod:
                          style:
                            mushroom-shape-icon$: |
                              .shape {
                                border: 2px rgba(255,255,255,0.5) outset;
                                --shape-color: rgba(0,0,0,1.0) !important;
                                --icon-size: 30px;
                              }
                            .: |
                              ha-card {
                                margin-left: -100px;
                                background: none !important;
                                box-shadow: none !important;
                                border: none !important;
                              }
                    card_mod:
                      style: |
                        ha-card {
                          margin-top: -15px;
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -15px;
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_utilisation_du_processeur
                            name: CPU USED
                            icon: mdi:cpu-64-bit
                            color: rgb(68, 115, 158)
                            height: 40px
                            min: 0
                            max: 100
                            target: 82
                        animation:
                          state: 'off'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: rgb(68, 115, 158)
                            from: 0
                            to: 74
                          - color: orange
                            from: 75
                            to: 79
                          - color: red
                            from: 90
                            to: 100
                        tap_action:
                          action: none
                        hold_action:
                          action: none
                        double_tap_action:
                          action: none
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_temperature_du_processeur
                            name: CPU Temp.
                            icon: mdi:thermometer
                            color: darkorange
                            height: 40px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkorange
                            from: 0
                            to: 64
                          - color: darkred
                            from: 65
                            to: 74
                          - color: red
                            from: 75
                            to: 100
                        tap_action:
                          action: none
                        hold_action:
                          action: none
                        double_tap_action:
                          action: none
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {  
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;  
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_charge_1m
                            name: Charge 1m
                            color: darkgreen
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 2
                          - color: orange
                            from: 2
                            to: 3
                          - color: red
                            from: 3
                            to: 6
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_charge_5m
                            name: Charge 5m
                            color: darkgreen
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 2
                          - color: orange
                            from: 2
                            to: 3
                          - color: red
                            from: 3
                            to: 6
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: sensor.system_monitor_charge_15m
                            name: Charge 15m
                            color: darkgreen
                            height: 25px
                            min: 0
                            max: 100
                            target: 75
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 2
                          - color: orange
                            from: 2
                            to: 3
                          - color: red
                            from: 3
                            to: 6
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      box-shadow: none !important;
                      background: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#memory'
                        double_tap_action:
                          action: none
                        hold_action:
                          action: none
                        entities:
                          - entity: sensor.system_monitor_utilisation_de_la_memoire
                            name: Mem.
                            icon: mdi:memory
                            color: darkgreen
                            height: 40px
                            min: 0
                            max: 100
                            target: 65
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 74
                          - color: orange
                            from: 75
                            to: 79
                          - color: red
                            from: 80
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              background: none !important;
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#memory'
                        double_tap_action:
                          action: none
                        hold_action:
                          action: none
                        entities:
                          - entity: sensor.system_monitor_memoire_utilisee
                            name: USED
                            color: darkred
                            height: 40px
                            min: 0
                            max: 16384
                            target: 7500
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;;
                              background: none !important;
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#memory'
                        double_tap_action:
                          action: none
                        hold_action:
                          action: none
                        entities:
                          - entity: sensor.system_monitor_memoire_libre
                            name: FREE
                            color: rgb(31, 111, 235)
                            height: 40px
                            min: 0
                            max: 16384
                            target: 7500
                        animation:
                          state: 'on'
                        positions:
                          icon: 'off'
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              background: none !important;
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#disk'
                        entities:
                          - entity: sensor.system_monitor_utilisation_du_disque
                            name: SSD MVMe 512Go
                            icon: mdi:harddisk
                            color: grey
                            height: 40px
                            min: 0
                            max: 524
                            target: 470
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        entities:
                          - entity: >-
                              sensor.system_monitor_debit_du_reseau_entrant_via_enp1s0
                            name: Download
                            icon: mdi:download
                            color: green
                            height: 40px
                            min: 0
                            max: 130
                            target: 20
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                      - type: custom:bar-card
                        entities:
                          - entity: >-
                              sensor.system_monitor_debit_du_reseau_sortant_via_enp1s0
                            name: Upload
                            icon: mdi:upload
                            color: red
                            height: 40px
                            min: 0
                            max: 130
                            target: 20
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 12px;
                              font-weight: bold;
                              --mdc-icon-size: 30px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: horizontal-stack
                cards:
                  - type: gauge
                    entity: sensor.system_monitor_utilisation_du_processeur
                    min: 0
                    max: 100
                    needle: true
                    name: Utilisation CPU
                    layout_options:
                      grid_columns: 2
                      grid_rows: 3
                    severity:
                      green: 0
                      yellow: 75
                      red: 90
                    tap_action:
                      action: navigate
                      navigation_path: '#speed'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:mini-graph-card
                    tap_action:
                      action: navigate
                      navigation_path: '#speed'
                    entities:
                      - entity: sensor.system_monitor_utilisation_du_processeur
                        color: turquoise
                        name: CPU Use
                    show:
                      labels: true
                      legend: true
                      icon: true
                      name: true
                      fill: true
                      animate: true
                      points: false
                    height: 150
                    align_state: none
                    align_header: none
                    font_size: 70
                    hours_to_show: 24
                    decimals: 0
                    hour24: true
                    line_width: 3
                    points_per_hour: 6
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        ha-icon {
                          color: turquoise !important;
                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#speed'
                        entities:
                          - entity: sensor.cpu_speed
                            name: CPU SPEED
                            icon: mdi:waveform
                            color: green
                            height: 20px
                            min: 0
                            max: 3.6
                            target: 3.125
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 2.9
                          - color: orange
                            from: 3
                            to: 3.3
                          - color: red
                            from: 3.4
                            to: 4
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: horizontal-stack
                cards:
                  - type: gauge
                    entity: sensor.system_monitor_temperature_du_processeur
                    min: 0
                    max: 100
                    severity:
                      green: 0
                      yellow: 65
                      red: 75
                    layout_options:
                      grid_columns: 2
                      grid_rows: 3
                    name: Température CPU
                    needle: true
                    tap_action:
                      action: navigate
                      navigation_path: '#temp'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.system_monitor_temperature_du_processeur
                        color: '#df6366'
                        name: Temp. CPU
                    show:
                      labels: true
                      legend: true
                      icon: true
                      name: true
                      fill: true
                      animate: true
                      points: false
                    height: 150
                    align_state: none
                    align_header: none
                    font_size: 70
                    hours_to_show: 24
                    decimals: 0
                    hour24: true
                    line_width: 3
                    points_per_hour: 6
                    tap_action:
                      action: navigate
                      navigation_path: '#temp'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        ha-icon {
                          color: #df6366 !important;
                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#temp'
                        entities:
                          - entity: sensor.system_monitor_temperature_du_processeur
                            name: Temp. CPU
                            icon: mdi:thermometer
                            color: green
                            height: 20px
                            min: 0
                            max: 100
                            target: 88
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 64
                          - color: orange
                            from: 65
                            to: 74
                          - color: red
                            from: 75
                            to: 100
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: horizontal-stack
                cards:
                  - type: gauge
                    entity: sensor.prise_mini_pc_ikea_power
                    min: 0
                    max: 25
                    severity:
                      green: 0
                      yellow: 15
                      red: 19
                    layout_options:
                      grid_columns: 2
                      grid_rows: 3
                    name: Conso. CPU
                    needle: true
                    tap_action:
                      action: navigate
                      navigation_path: '#conso'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.prise_mini_pc_ikea_power
                        color: gainsboro
                        name: Conso. CPU
                    show:
                      labels: true
                      legend: true
                      icon: true
                      name: true
                      fill: true
                      animate: true
                      points: false
                    height: 150
                    align_state: none
                    align_header: none
                    font_size: 70
                    hours_to_show: 24
                    decimals: 0
                    hour24: true
                    line_width: 3
                    points_per_hour: 6
                    tap_action:
                      action: navigate
                      navigation_path: '#conso'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                        ha-icon {
                          color: gainsboro !important;
                        }
              - type: custom:stack-in-card
                mode: vertical
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:bar-card
                        tap_action:
                          action: navigate
                          navigation_path: '#conso'
                        entities:
                          - entity: sensor.prise_mini_pc_ikea_power
                            name: POWER
                            icon: mdi:lightning-bolt-outline
                            color: green
                            height: 20px
                            min: 0
                            max: 25
                            target: 22
                        animation:
                          state: 'on'
                        positions:
                          icon: inside
                          indicator: inside
                        entity_row: true
                        severity:
                          - color: darkgreen
                            from: 0
                            to: 14
                          - color: orange
                            from: 15
                            to: 18
                          - color: red
                            from: 19
                            to: 30
                        card_mod:
                          style: |
                            ha-card {
                              font-size: 11px;
                              font-weight: bold;
                              --mdc-icon-size: 15px;
                              --paper-item-icon-color: white;
                              border: none !important;
                              box-shadow: none !important;
                              background: none !important;
                            }
                            bar-card-currentbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                            bar-card-backgroundbar {
                              border: none !important;
                              box-shadow: none !important;
                            }
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            grid_options:
              columns: 12
              rows: auto
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#conso'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Consommation
                icon: mdi:lightning-bolt-circle
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                cache: false
                span:
                  offset: +15m
                apex_config:
                  chart:
                    height: 300px
                now:
                  show: true
                  color: darkred
                  label: Now
                header:
                  show: true
                  title: Mini. P.C.
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Watts
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 10
                all_series_config:
                  group_by:
                    func: last
                    duration: 1m
                  show:
                    legend_value: false
                    extremas: true
                  curve: stepline
                brush:
                  selection_span: 3h
                  apex_config: null
                series:
                  - entity: sensor.prise_mini_pc_ikea_power
                    name: Conso. Instantanée
                    yaxis_id: Watts
                    color: green
                    type: area
                    stroke_width: 0.01
                    fill_raw: last
                    color_threshold:
                      - value: 0
                        color: gainsboro
                      - value: 15
                        color: orange
                      - value: 18
                        color: red
                  - entity: sensor.prise_mini_pc_ikea_power
                    yaxis_id: Watts
                    type: line
                    stroke_dash: 8
                    color: red
                    unit: Wh
                    stroke_width: 0.01
                    name: Avg(24hrs)
                    group_by:
                      func: avg
                      duration: 24h
                  - entity: sensor.prise_mini_pc_ikea_power
                    color: green
                    stroke_width: 0.1
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:apexcharts-card
                graph_span: 730h
                cache: false
                span:
                  end: day
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: ' '
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Watts
                    min: ~0
                    max: auto
                    opposite: false
                    decimals: 0
                    apex_config:
                      tickAmount: 10
                  - id: Avg
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 1
                    apex_config:
                      tickAmount: 10
                all_series_config:
                  group_by:
                    func: diff
                    duration: 24h
                    start_with_last: true
                  show:
                    legend_value: true
                    extremas: true
                series:
                  - entity: sensor.prise_mini_pc_ikea_energy
                    transform: return x * 1000;
                    unit: Wh
                    name: Conso. par jours
                    yaxis_id: Watts
                    color: green
                    type: column
                  - entity: sensor.prise_mini_pc_ikea_energy
                    yaxis_id: Avg
                    type: line
                    stroke_dash: 8
                    color: red
                    unit: Wh
                    stroke_width: 0.1
                    name: Avg(730hrs)
                    group_by:
                      func: avg
                      duration: 730h
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#disk'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Espace disque utilisé (SSD Mvme)
                icon: mdi:harddisk
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                brush:
                  selection_span: 6h
                  apex_config: null
                header:
                  show: true
                  title: Disque (512Go)
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: disk
                    min: 0
                    max: auto
                    opposite: true
                    apex_config:
                      tickAmount: 10
                series:
                  - entity: sensor.system_monitor_espace_utilise
                    name: Espace disque utilisé
                    color: green
                    type: area
                    show:
                      legend_value: false
                      extremas: true
                    stroke_width: 1
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 7500
                        color: orange
                      - value: 10000
                        color: red
                  - entity: sensor.system_monitor_espace_utilise
                    color: green
                    stroke_width: 1
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#memory'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Mémoire utilisé
                icon: mdi:memory
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                brush:
                  selection_span: 3h
                  apex_config: null
                header:
                  show: true
                  title: MEMOIRE (16Go)
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: disk
                    min: 0
                    max: auto
                    opposite: true
                    apex_config:
                      tickAmount: 10
                series:
                  - entity: sensor.system_monitor_memoire_utilisee
                    name: Mémoire utilisé
                    color: green
                    type: area
                    stroke_width: 0.01
                    show:
                      legend_value: false
                      extremas: true
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 14000
                        color: orange
                      - value: 15000
                        color: red
                  - entity: sensor.system_monitor_memoire_utilisee
                    color: green
                    stroke_width: 0.01
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#temp'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Température du processeur
                icon: mdi:thermometer
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                cache: false
                span:
                  offset: +15m
                apex_config:
                  chart:
                    height: 300px
                now:
                  show: true
                  color: darkred
                  label: Now
                header:
                  show: true
                  title: Mini. P.C.
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Temp
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 10
                all_series_config:
                  group_by:
                    func: last
                    duration: 1m
                  show:
                    legend_value: false
                    extremas: true
                  curve: straight
                brush:
                  selection_span: 3h
                  apex_config: null
                series:
                  - entity: sensor.system_monitor_temperature_du_processeur
                    name: Température Instantanée
                    yaxis_id: Temp
                    color: green
                    type: area
                    stroke_width: 0.01
                    fill_raw: last
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 65
                        color: orange
                      - value: 75
                        color: red
                  - entity: sensor.system_monitor_temperature_du_processeur
                    yaxis_id: Watts
                    type: line
                    stroke_dash: 8
                    color: red
                    stroke_width: 0.01
                    name: Avg(24hrs)
                    group_by:
                      func: avg
                      duration: 24h
                  - entity: sensor.system_monitor_temperature_du_processeur
                    color: green
                    stroke_width: 2
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#speed'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: CPU Speed
                icon: mdi:waveform
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:apexcharts-card
                experimental:
                  color_threshold: true
                  brush: true
                graph_span: 24h
                cache: false
                span:
                  offset: +15m
                apex_config:
                  chart:
                    height: 300px
                now:
                  show: true
                  color: darkred
                  label: Now
                header:
                  show: true
                  title: CPU Speed
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: Temp
                    min: ~0
                    max: auto
                    opposite: true
                    decimals: 0
                    apex_config:
                      tickAmount: 10
                all_series_config:
                  group_by:
                    func: last
                    duration: 1m
                  show:
                    legend_value: false
                    extremas: true
                  curve: straight
                brush:
                  selection_span: 3h
                  apex_config: null
                series:
                  - entity: sensor.cpu_speed
                    name: Température Instantanée
                    yaxis_id: Temp
                    color: green
                    type: area
                    stroke_width: 0.01
                    fill_raw: last
                    color_threshold:
                      - value: 0
                        color: green
                      - value: 65
                        color: orange
                      - value: 75
                        color: red
                  - entity: sensor.cpu_speed
                    yaxis_id: Watts
                    type: line
                    stroke_dash: 8
                    color: red
                    stroke_width: 0.01
                    name: Avg(24hrs)
                    group_by:
                      func: avg
                      duration: 24h
                  - entity: sensor.system_monitor_temperature_du_processeur
                    color: green
                    stroke_width: 2
                    float_precision: 0
                    show:
                      in_brush: true
                      in_chart: false
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
    badges: []
    cards: []
  - path: systeme freebox
    type: sections
    max_columns: 1
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:server-network
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: FREEBOX
          - type: custom:bubble-card
            card_type: separator
            name: Speedtest
            icon: phu:speedtest
            card_layout: normal
            rows: 1
            styles: |-
              .bubble-line {
                background: var(--primary-text-color);
                opacity: 1;
              }
              ha-card {
                border-radius: 0px !important;
                padding-top: 10px !important;
                padding-bottom: 20px !important;
                bottom: 0 !important;
              }
            sub_button:
              - entity: sensor.speedtest_cli_data
                icon: mdi:clock-time-four-outline
                show_last_changed: true
                tap_action:
                  action: none
                show_icon: true
                show_background: true
                show_attribute: false
          - type: custom:bubble-card
            card_type: button
            button_type: name
            name: Démarrer Speedtest
            icon: phu:speedtest
            show_last_changed: true
            show_attribute: false
            double_tap_action:
              action: none
            hold_action:
              action: none
            card_layout: normal
            tap_action:
              action: perform-action
              target:
                entity_id: sensor.speedtest_cli_data
              perform_action: homeassistant.update_entity
              data:
                entity_id:
                  - sensor.speedtest_cli_data
            button_action:
              tap_action:
                action: call-service
                service: homeassistant.update_entity
                service_data:
                  entity_id: sensor.speedtest_cli_data
                target: {}
            sub_button:
              - icon: mdi:play
                show_background: false
                show_last_changed: false
                show_attribute: false
                tap_action:
                  action: perform-action
                  target:
                    entity_id: sensor.speedtest_cli_data
                  perform_action: homeassistant.update_entity
                  data:
                    entity_id:
                      - sensor.speedtest_cli_data
                show_name: false
                entity: sensor.speedtest_cli_data
            columns: 2
            styles: |-
              .bubble-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-icon-container{
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }

              .bubble-button-background {
                opacity: 0.75 !important;
                background-color: rgba(34, 163, 220) !important

              }


              .bubble-sub-button-1 > ha-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-sub-button-1 {
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }
          - type: custom:bubble-card
            card_type: button
            button_type: state
            name: Afficher Historique
            icon: mdi:chart-histogram
            entity: sensor.speedtest_cli_data
            show_state: false
            show_last_changed: false
            show_attribute: false
            tap_action:
              action: navigate
              navigation_path: '#speedtest_details'
            double_tap_action:
              action: none
            hold_action:
              action: none
            button_action:
              tap_action:
                action: navigate
                navigation_path: '#speedtest_details'
              double_tap_action:
                action: none
              hold_action:
                action: none
            columns: 2
            card_layout: normal
            styles: |-
              .bubble-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-icon-container{
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }

              .bubble-button-background {
                opacity: 0.75 !important;
                background-color: rgba(34, 163, 220) !important

              }


              .bubble-sub-button-1 > ha-icon {
                opacity: 1 !important;
                color: rgb(34, 163, 220) !important;
              }

              .bubble-sub-button-1 {
                opacity: 1 !important;
                background-color: rgb(16, 16, 28) !important;
              }
          - type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: true
              margin: true
              border_radius: true
              background: true
              outer_padding: false
            cards:
              - type: entities
                header:
                  type: picture
                  image: /local/images/free-1.jpeg
                entities:
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: 'External IPv4:'
                    icon: mdi:ip
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: IPv4
                        name: ' '
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: 'External IPv6:'
                    icon: mdi:ip
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: IPv6
                        name: ' '
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: Uptime
                    icon: mdi:web-clock
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: uptime
                        format: total
                  - entity: device_tracker.freebox_v8_r1
                    type: custom:multiple-entity-row
                    name: Connection
                    icon: mdi:wan
                    show_state: false
                    entities:
                      - entity: device_tracker.freebox_v8_r1
                        attribute: connection_type
                        name: Type
                      - entity: device_tracker.freebox_v8_r1
                        attribute: firmware_version
                        name: firmware
                  - entity: sensor.freebox_download_speed
                    name: Freebox download speed
                    icon: mdi:arrow-down-thick
                    show_state: true
                  - entity: sensor.freebox_upload_speed
                    name: Freebox upload speed
                    icon: mdi:arrow-up-thick
                    show_state: null
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
              - type: custom:apexcharts-card
                graph_span: 24h
                update_interval: 1m
                apex_config:
                  chart:
                    height: 250px
                header:
                  show: true
                  title: Température 1, 2 & CPU B
                  show_states: true
                  colorize_states: true
                yaxis:
                  - id: TH
                    min: auto
                    max: auto
                    opposite: true
                    decimals: 2
                    apex_config:
                      tickAmount: 4
                all_series_config:
                  group_by:
                    func: last
                    duration: 1h
                  show:
                    legend_value: false
                    extremas: true
                series:
                  - entity: sensor.freebox_temperature_1
                    name: Température 1
                    yaxis_id: TH
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.freebox_temperature_1
                    name: Température 2
                    yaxis_id: TH
                    stroke_width: 2
                    fill_raw: last
                  - entity: sensor.freebox_temperature_cpu_b
                    name: Température CPU B
                    color: green
                    yaxis_id: TH
                    stroke_width: 2
                    fill_raw: last
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#speedtest_details'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Historique du Speedtest
                icon: phu:speedtest
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: true
                bg_opacity: 0
              - type: custom:bubble-card
                card_type: separator
                name: Historique des Speedtest
                icon: mdi:chart-histogram
                sub_button:
                  - entity: sensor.speedtest_cli_data
                    show_last_changed: true
                    show_icon: true
                    icon: mdi:clock-time-two-outline
                    show_background: true
                    show_state: false
                    show_attribute: false
                    name: Date du dernier test
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    entity: sensor.myip
                    icon: mdi:server-outline
                    icon_color: gainsboro
                    content: >-
                      {{ states("sensor.speedtest_isp") }} <-> Server: {{
                      states("sensor.speedtest_server_name") }}  / {{
                      states("sensor.speedtest_location") }}  / {{
                      states("sensor.speedtest_country") }}
                    tap_action:
                      action: more-info
                    card_mod:
                      style: |
                        ha-card {
                          margin-top: -8px;
                          box-shadow: 2px 2px 4px 0px rgba(0,0,0,0.5) !important;
                          border: 5px rgba(0,0,0,0.25) outset !important;
                          --chip-height: 35px;
                          --chip-icon-size: 20px;
                          --chip-font-size: 14px;
                        }
                alignment: left
              - type: vertical-stack
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.speedtest_cli_download
                    name: Download
                    icon: mdi:speedometer
                    show_last_changed: true
                    show_attribute: false
                    double_tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_layout: normal
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.speedtest_cli_download
                        name: Download
                    name: Download
                    decimals: '0'
                    more_info: true
                    line_width: 2
                    hours_to_show: 24
                    points_per_hour: 2
                    show:
                      fill: true
                      graph: line
                      icon: true
                      name: true
                      state: true
                      labels: true
                      extrema: true
                      average: true
                      icon_adaptive_color: true
                    color_thresholds:
                      - value: 100
                        color: '#ef1d0f'
                      - value: 200
                        color: '#ef5a0f'
                      - value: 400
                        color: '#f0da11'
                      - value: 600
                        color: '#11f13a'
                      - value: 800
                        color: '#1da4f2'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.speedtest_cli_upload
                    name: Upload
                    icon: mdi:speedometer
                    show_last_changed: true
                    show_attribute: false
                    double_tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_layout: normal
              - type: vertical-stack
                cards:
                  - type: custom:mini-graph-card
                    entities:
                      - entity: sensor.speedtest_cli_upload
                        name: Upload
                    name: Upload
                    decimals: '0'
                    more_info: true
                    line_width: 2
                    hours_to_show: 24
                    points_per_hour: 2
                    show:
                      fill: true
                      graph: line
                      icon: true
                      name: true
                      state: true
                      labels: true
                      extrema: true
                      average: true
                      icon_adaptive_color: true
                    color_thresholds:
                      - value: 50
                        color: '#ef1d0f'
                      - value: 100
                        color: '#ef5a0f'
                      - value: 200
                        color: '#f0da11'
                      - value: 400
                        color: '#11f13a'
                      - value: 600
                        color: '#1da4f2'
                    card_mod:
                      style: |
                        ha-card {
                          background: none !important;
                          box-shadow: none !important;
                          border: none !important;
                        }
              - type: horizontal-stack
                cards:
                  - type: custom:bubble-card
                    card_type: button
                    button_type: state
                    entity: sensor.speedtest_cli_ping
                    name: Ping
                    icon: mdi:speedometer
                    show_last_changed: true
                    show_attribute: false
                    double_tap_action:
                      action: none
                    hold_action:
                      action: none
                    card_layout: normal
              - type: custom:mini-graph-card
                decimals: 1
                hour24: true
                height: 79
                hours_to_show: 24
                points_per_hour: 1
                group_by: interval
                line_width: 2
                entities:
                  - entity: sensor.speedtest_cli_ping
                    name: Ping (24h)
                show:
                  fill: true
                  graph: line
                  icon: true
                  name: true
                  state: true
                  labels: true
                  extrema: true
                  average: true
                  icon_adaptive_color: true
                align_icon: right
                align_state: right
                font_size: 125
                animate: true
                color_thresholds:
                  - value: 40
                    color: '#ef1d0f'
                  - value: 35
                    color: '#ef5a0f'
                  - value: 30
                    color: '#f0da11'
                  - value: 25
                    color: '#11f13a'
                  - value: 20
                    color: '#1da4f2'
                card_mod:
                  style: |
                    ha-card {
                      background: none !important;
                      box-shadow: none !important;
                      border: none !important;
                    }
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  box-shadow: none !important;
                  border: none !important;
                }
    title: Systemes freebox
    cards: []
  - title: MàJ
    path: maj
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-assistant
            heading: H.A. SERVER
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;background: transparent !important;
                      box-shadow: transparent !important;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3" '
                    - grid-template-columns: 1fr 0.69fr 0.05fr
                    - grid-template-rows: 0fr 0fr
                  card:
                    - margin-top: 1.5rem
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1: null
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: Home Assistant Server
                      subtitle: >
                        Core v{{ state_attr('update.home_assistant_core_update',
                        'installed_version') }} - OS v{{
                          state_attr('update.home_assistant_operating_system_update',
                        'installed_version') }} - Supervisor v{{
                        state_attr('update.home_assistant_supervisor_update',
                        'installed_version') }}
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          ha-card {
                              margin-right: -15rem;
                           }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        maj=integration_entities('hassio')|select('search','update.home')|select('is_state','on')|list|count|int(2)
                        %}  {% set
                        total=integration_entities('hassio')|select('search','update.home')|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}}  MàJ
                         sur {{total}}" > {% elif maj == 1 %} <ha-alert
                        alert-type="warning" title="{{maj}} MàJ sur {{total}}" >
                        {% elif maj > 1 %} <ha-alert alert-type="warning"
                        title="{{maj}} mises a jour sur {{total}}" ></ha-alert>
                        {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-border-color: transparent !important;
                            --card-background-color: transparent !important;
                          }
                          ha-markdown.no-header {
                            margin: 0px !important;
                          }
                          ha-card {
                            margin-top: -1rem;
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: vertical-stack
                cards:
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-update-card
                        entity: update.home_assistant_core_update
                        name: HA Core
                        show_buttons_control: true
                        icon_type: entity-picture
                        fill_container: false
                      - type: custom:mushroom-template-card
                        primary: Version Information
                        secondary: >-
                          Installed v{{
                          state_attr('update.home_assistant_core_update',
                          'installed_version')}}

                          Latest v{{
                          state_attr('update.home_assistant_core_update',
                          'latest_version')}}
                        icon: mdi:package-variant-closed
                        multiline_secondary: true
                        fill_container: true
                        entity: update.home_assistant_core_update
                        tap_action:
                          action: more-info
                        icon_color: >-
                          {% if is_state('update.home_assistant_core_update',
                          'on') %}
                            orange
                          {% else %}
                            green
                          {% endif %}
                        badge_color: >-
                          {% if is_state('update.home_assistant_core_update',
                          'on') %}
                            red
                          {% else %}
                            blue
                          {% endif %}
                        badge_icon: >-
                          {% if is_state('update.home_assistant_core_update',
                          'on') %}
                            mdi:help
                          {% else %}
                            mdi:check-bold
                          {% endif %}
                        card_mod:
                          style: |
                            ha-card {
                              pointer-events: none;
                            }
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-update-card
                        entity: update.home_assistant_operating_system_update
                        name: HA OS
                        show_buttons_control: true
                        icon_type: entity-picture
                      - type: custom:mushroom-template-card
                        primary: Version Information
                        secondary: >-
                          Installed v{{
                          state_attr('update.home_assistant_operating_system_update',
                          'installed_version')}}

                          Latest v{{
                          state_attr('update.home_assistant_operating_system_update',
                          'latest_version')}}
                        icon: mdi:package-variant-closed
                        multiline_secondary: true
                        fill_container: true
                        entity: update.home_assistant_operating_system_update
                        tap_action:
                          action: more-info
                        icon_color: >-
                          {% if
                          is_state('update.home_assistant_operating_system_update',
                          'on') %}
                            orange
                          {% else %}
                            green
                          {% endif %}
                        badge_color: >-
                          {% if
                          is_state('update.home_assistant_operating_system_update',
                          'on') %}
                            red
                          {% else %}
                            blue
                          {% endif %}
                        badge_icon: >-
                          {% if
                          is_state('update.home_assistant_operating_system_update',
                          'on') %}
                            mdi:help
                          {% else %}
                            mdi:check-bold
                          {% endif %}
                        card_mod:
                          style: |
                            ha-card {
                              pointer-events: none;
                            }
                  - type: horizontal-stack
                    cards:
                      - type: custom:mushroom-update-card
                        entity: update.home_assistant_supervisor_update
                        name: HA Supervisor
                        show_buttons_control: true
                        icon_type: entity-picture
                      - type: custom:mushroom-template-card
                        primary: Version Information
                        secondary: >-
                          Installed v{{
                          state_attr('update.home_assistant_supervisor_update',
                          'installed_version')}}

                          Latest v{{
                          state_attr('update.home_assistant_supervisor_update',
                          'latest_version')}}
                        icon: mdi:package-variant-closed
                        multiline_secondary: true
                        fill_container: true
                        entity: update.home_assistant_core_update
                        tap_action:
                          action: more-info
                        icon_color: >-
                          {% if
                          is_state('update.home_assistant_supervisor_update',
                          'on') %}
                            orange
                          {% else %}
                            green
                          {% endif %}
                        badge_color: >-
                          {% if
                          is_state('update.home_assistant_supervisor_update',
                          'on') %}
                            red
                          {% else %}
                            blue
                          {% endif %}
                        badge_icon: >-
                          {% if
                          is_state('update.home_assistant_supervisor_update',
                          'on') %}
                            mdi:help
                          {% else %}
                            mdi:check-bold
                          {% endif %}
                        card_mod:
                          style: |
                            ha-card {
                              pointer-events: none;
                            }
              - type: vertical-stack
                cards:
                  - type: custom:button-card
                    show_name: false
                    show_icon: false
                    show_state: false
                    card_mod:
                      style: |
                        ha-card {
                          pointer-events: none;
                        }
                    styles:
                      grid:
                        - grid-template-areas: '"card1 card2 card3" '
                        - grid-template-columns: 1fr 0.69fr 0.05fr
                        - grid-template-rows: 0fr 0fr
                      card:
                        - padding: 5px 0px 5px 10px
                        - background: rgba(0,0,0,0)
                      custom_fields:
                        card1: null
                        card2:
                          - align-self: top
                          - height: 100%
                    custom_fields:
                      card1:
                        card:
                          type: custom:mushroom-title-card
                          title: HACS
                          subtitle: >-
                            Installed v{{ state_attr('update.hacs_update',
                            'installed_version') }} - Latest v{{
                            state_attr('update.hacs_update', 'latest_version')
                            }}
                          alignment: start
                          card_mod:
                            style: |
                              .header {
                                padding: 0px !important;
                              }
                              ha-card {
                                  margin-right: -15rem;
                               }
                      card2:
                        card:
                          type: markdown
                          content: >-
                            {% set
                            need_update=integration_entities('hacs')|select('search','update.hacs_update')|select('is_state','of')|list|count|int(2)
                            %} {% if need_update == 0 %} <ha-alert
                            alert-type="success" title="HACS est à jour" > {%
                            else %} <ha-alert alert-type="error" title="1 mise a
                            jour de HASC est disponible" ></ha-alert> {% endif
                            %}
                          card_mod:
                            style: |
                              :host {
                                --ha-card-margin: 0px;
                                --ha-card-border-color: transparent !important;
                                --card-background-color: transparent !important;
                              }
                              ha-markdown.no-header {
                                margin: 0px !important;
                              }
                              ha-card {
                                margin-top: -1.3rem;
                                margin-bottom: -1.3rem;
                                margin-left: -1rem;
                                font-size: 1rem;
                                --mdc-icon-size: 1.3rem;
                               }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        icon: mdi:web
                        icon_color: blue
                        content: Release Changelog
                        tap_action:
                          action: url
                          url_path: https://github.com/hacs/integration/releases
                      - type: template
                        entity: update.hacs_update
                        content: >-
                          Installed v{{ state_attr('update.hacs_update',
                          'installed_version') }}
                        icon_color: green
                        icon: mdi:package-variant-closed
                        tap_action:
                          action: none
                      - type: template
                        entity: update.hacs_update
                        content: >-
                          Latest v{{ state_attr('update.hacs_update',
                          'latest_version') }}
                        icon_color: orange
                        icon: mdi:package-variant-closed
                        tap_action:
                          action: none
                    card_mod:
                      style:
                        mushroom-template-chip:nth-child(2):
                          $: |
                            mushroom-chip{
                            pointer-events: none;
                            }
                        mushroom-template-chip:nth-child(3):
                          $: |
                            mushroom-chip{
                            pointer-events: none;
                            }
                  - type: custom:auto-entities
                    card:
                      type: vertical-stack
                    card_param: cards
                    filter:
                      include:
                        - entity_id: update.hacs_update
                          state: 'on'
                          options:
                            type: custom:button-card
                            show_name: true
                            show_icon: true
                            show_state: true
                            show_entity_picture: true
                            variables:
                              url: |
                                [[[
                                  return entity.attributes.release_url
                                ]]]
                              sensor: |
                                [[[
                                  let name = Object.values(entity)
                                 return name[0]
                                  ]]]
                            name: |
                              [[[
                                return entity.attributes.friendly_name.replace('update','')
                              ]]]
                            state_display: >
                              [[[ 

                              if(entity.state== "on" &
                              entity.attributes.in_progress == false)
                                 return  entity.attributes.installed_version +' - ' + entity.attributes.latest_version
                              else if(entity.state== "off")
                               return helpers.localize(entity) +' - '+ entity.attributes.installed_version
                              else
                                return "instal - "+entity.attributes.in_progress+"%"
                              ]]]
                            styles:
                              grid:
                                - grid-template-areas: '"i n n cardupload" "i s cardurl cardupload"'
                                - grid-template-columns: 1fr 1fr 1fr 1.5fr;
                                - grid-template-rows: repeat(2, 50%);
                                - gap: 0px 0px;
                              card:
                                - padding: 0px
                                - height: 100%
                                - width: 100%
                              icon:
                                - align-self: center
                                - left: 25%
                                - width: 55%
                              name:
                                - justify-self: start
                                - font-size: 0.9em
                                - font-weight: 450
                                - padding-top: 8px
                              state:
                                - justify-self: start
                                - font-size: 0.75em
                                - padding-bottom: 0.7em
                                - padding-right: 8rem
                              custom_fields:
                                cardurl:
                                  - justify-self: center
                                  - margin-bottom: 0.7em
                                  - margin-left: 2rem
                                  - margin-right: '-2rem'
                            custom_fields:
                              cardurl:
                                card:
                                  type: custom:button-card
                                  show_icon: false
                                  name: |
                                    [[[
                                     if (variables.url == null)return ""
                                     else
                                      {return '<a style="color:white" href="'+[variables.url]+'">'+[variables.url.substr(8,18).toLowerCase()]+'</a>'}
                                     endif
                                    ]]]
                                  tap_action:
                                    action: url
                                    url_path: |
                                      [[[
                                       return variables.url
                                      ]]]
                                  styles:
                                    card:
                                      - background: rgba(100,150,255,0.5)
                                      - width: 13rem
                                      - box-sizing: border-box
                                      - padding: 0px
                                    name:
                                      - font-size: 1.2rem
                                      - font-weight: bold
                                      - font-style: italic
                              cardupload:
                                card:
                                  show_icon: true
                                  type: custom:button-card
                                  icon: |
                                    [[[
                                     if(entity.state == "off")
                                     return ""
                                     if(entity.attributes.in_progress == false)
                                     return 'mdi:upload-circle'
                                     else return 'mdi:rotate-right'
                                    ]]]
                                  styles:
                                    card:
                                      - background: none
                                      - border: none
                                    icon:
                                      - animation: |
                                          [[[
                                           if(entity.attributes.in_progress == false)
                                            return '' 
                                           else return 'rotating 1s linear infinite'
                                          ]]]
                                      - color: |
                                          [[[
                                           if(entity.state == 'on' & entity.attributes.in_progress != false)
                                           return 'green'
                                           else return 'rgba(85,252,252, 1)'
                                          ]]]
                                      - left: 18%
                                      - width: 40%
                                  tap_action:
                                    action: perform-action
                                    perform_action: update.install
                                    target:
                                      entity_id: '[[[return variables.sensor]]]'
                      exclude: []
                      card_param: cards
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-assistant
            heading: H.A. UPDATE
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3"'
                    - grid-template-columns: 1fr 0.63fr 0.1fr
                    - grid-template-rows: 1fr
                  card:
                    - margin-top: 1.5rem
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1:
                      - width: 90%
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: Addons updates
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          .header div {
                            margin: 0px !important
                          }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        rejet=['update.home_assistant_core_update','update.home_assistant_operating_system_update','update.home_assistant_supervisor_update']
                        %}  {% set
                        maj=integration_entities('hassio')|select('search','update.')|select('is_state','on')|reject('in',rejet)|list|count|int(2)
                        %}  {% set
                        total=integration_entities('hassio')|select('search','update.')|reject('in',rejet)|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}} MàJ sur {{total}}" > {% elif maj == 1 %}
                        <ha-alert alert-type="warning" title="{{maj}} MàJ sur
                        {{total}}" > {% elif maj > 1 %} <ha-alert
                        alert-type="warning" title="{{maj}} Màj sur {{total}}"
                        ></ha-alert> {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-background: #00000000 !important;
                            --ha-card-border-color: #00000000 !important;
                            }
                          ha-markdown.no-header {
                            padding: 0px !important;
                            margin: 0px !important;
                            margin-right: 3em !important;
                            margin-left: -3em !important;
                          }
                          ha-card {
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: custom:auto-entities
                card:
                  type: vertical-stack
                card_param: cards
                filter:
                  include:
                    - domain: update
                      state: 'on'
                      options:
                        type: custom:button-card
                        show_name: true
                        show_icon: true
                        show_state: true
                        show_entity_picture: true
                        variables:
                          sensor: |
                            [[[
                              let name = Object.values(entity)
                             return name[0]
                              ]]]
                        name: |
                          [[[
                            return entity.attributes.friendly_name.replace('Home Assistant','HA').replace('Update','')
                          ]]]
                        state_display: |
                          [[[ if(entity.state== "on")
                           return 'v' + entity.attributes.installed_version +' - v' + entity.attributes.latest_version
                          else if(entity.state== "off")
                           return helpers.localize(entity) +' - v'+ entity.attributes.installed_version
                          else
                           return "instal - "+entity.attributes.in_progress+"%"
                          ]]]
                        styles:
                          grid:
                            - grid-template-areas: '"i n n cardupload" "i s s cardupload"'
                            - grid-template-columns: 0.6fr 1fr 1.6fr 1fr;
                            - grid-template-rows: repeat(2, 50%);
                            - gap: 0px 0px;
                          card:
                            - padding: 0px
                            - height: 100%
                            - width: 100%
                          icon:
                            - align-self: center
                            - left: 25%
                            - width: 55%
                          name:
                            - justify-self: start
                            - font-size: 0.9em
                            - font-weight: 450
                            - padding-top: 8px
                          state:
                            - justify-self: start
                            - font-size: 0.75em
                            - padding-bottom: 0.7em
                        custom_fields:
                          cardupload:
                            card:
                              show_icon: true
                              type: custom:button-card
                              icon: |
                                [[[
                                 if(entity.state == "off")
                                 return ""
                                 if(entity.attributes.in_progress == false)
                                 return 'mdi:upload-circle'
                                 else return 'mdi:rotate-right'
                                ]]]
                              styles:
                                card:
                                  - background: none
                                  - border: none
                                icon:
                                  - animation: |
                                      [[[
                                       if(entity.attributes.in_progress == false)
                                        return '' 
                                       else return 'rotating 1s linear infinite'
                                      ]]]
                                  - color: |
                                      [[[
                                       if(entity.state == 'on' & entity.attributes.in_progress != false)
                                       return 'green'
                                       else return 'rgba(85,252,252, 1)'
                                      ]]]
                                  - left: 17%
                              tap_action:
                                action: perform-action
                                perform_action: update.install
                                target:
                                  entity_id: '[[[return variables.sensor]]]'
                  exclude:
                    - name: Home*
                    - integration: hacs
                    - integration: mqtt
                  card_param: cards
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3"'
                    - grid-template-columns: 1fr 0.63fr 0.1fr
                    - grid-template-rows: 1fr
                  card:
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1:
                      - width: 90%
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: HACS updates
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          .header div {
                            margin: 0px !important
                          }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        maj=integration_entities('hacs')|select('search','update.')|select('is_state','on')|reject('in','update.hacs_update')|list|count|int(2)
                        %}  {% set
                        total=integration_entities('hacs')|select('search','update.')|reject('in','update.hacs_update')|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}} MàJ sur {{total}}" > {% elif maj == 1 %}
                        <ha-alert alert-type="warning" title="{{maj}} MàJ sur
                        {{total}}" > {% elif maj > 1 %} <ha-alert
                        alert-type="warning" title="{{maj}}  màj sur {{total}}"
                        ></ha-alert> {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-background: #00000000 !important;
                            --ha-card-border-color: #00000000 !important;
                            }
                          ha-markdown.no-header {
                            padding: 0px !important;
                            margin: 0px !important;
                            margin-right: 3em !important;
                            margin-left: -3em !important;
                          }
                          ha-card {
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: markdown
                content: >-
                  {% set maj = states.update |
                  selectattr('attributes.release_summary','defined') |
                  selectattr('attributes.release_summary','eq','<ha-alert
                  alert-type=\'error\'>Restart of Home Assistant
                  required</ha-alert>') |map(attribute='name') |list %}

                  {% set maj_count = maj|count|int(2) %}

                  {% if maj_count >= 1 %} <ha-alert alert-type="error"
                  title="{{maj_count}} intégrations nécessitent un redémarrage">

                  <hr>

                  <ul>{% for i in maj%}

                  <li>{{i}}</li>

                  {% endfor%}</ul>

                  {% else %}

                  {% endif %}</ha-alert>
                card_mod:
                  style: |
                    :host {
                      --ha-card-margin: 0px;
                      --ha-card-background: #00000000 !important;
                      --ha-card-border-color: #00000000 !important;
                      }
                    ha-markdown.no-header {
                      padding: 4rem !important;
                      padding-top: 0rem !important;
                      padding-bottom: 0rem !important;
                    }
              - type: custom:auto-entities
                card:
                  type: vertical-stack
                card_param: cards
                filter:
                  include:
                    - domain: update
                      state: 'on'
                      integration: hacs
                      options:
                        type: custom:button-card
                        show_name: true
                        show_icon: true
                        show_state: true
                        show_entity_picture: true
                        variables:
                          url: |
                            [[[
                              return entity.attributes.release_url
                            ]]]
                          sensor: |
                            [[[
                              let name = Object.values(entity)
                             return name[0]
                              ]]]
                        name: |
                          [[[
                            return entity.attributes.friendly_name.replace('update','')
                          ]]]
                        state_display: >
                          [[[ 

                          if(entity.state== "on" & entity.attributes.in_progress
                          == false)
                             return  entity.attributes.installed_version +' - ' + entity.attributes.latest_version
                          else if(entity.state== "off")
                           return helpers.localize(entity) +' - '+ entity.attributes.installed_version
                          else
                            return "instal - "+entity.attributes.in_progress+"%"
                          ]]]
                        styles:
                          grid:
                            - grid-template-areas: '"i n n cardupload" "i s cardurl cardupload"'
                            - grid-template-columns: 1fr 1fr 1fr 1.5fr;
                            - grid-template-rows: repeat(2, 50%);
                            - gap: 0px 0px;
                          card:
                            - padding: 0px
                            - height: 100%
                            - width: 100%
                          icon:
                            - align-self: center
                            - left: 25%
                            - width: 55%
                          name:
                            - justify-self: start
                            - font-size: 0.9em
                            - font-weight: 450
                            - padding-top: 8px
                          state:
                            - justify-self: start
                            - font-size: 0.75em
                            - padding-bottom: 0.7em
                            - padding-right: 8rem
                          custom_fields:
                            cardurl:
                              - justify-self: center
                              - margin-bottom: 0.7em
                              - margin-left: 2rem
                              - margin-right: '-2rem'
                        custom_fields:
                          cardurl:
                            card:
                              type: custom:button-card
                              show_icon: false
                              name: |
                                [[[
                                 if (variables.url == null)return ""
                                 else
                                  {return '<a style="color:white" href="'+[variables.url]+'">'+[variables.url.substr(8,18).toLowerCase()]+'</a>'}
                                 endif
                                ]]]
                              tap_action:
                                action: url
                                url_path: |
                                  [[[
                                   return variables.url
                                  ]]]
                              styles:
                                card:
                                  - background: rgba(100,150,255,0.5)
                                  - width: 13rem
                                  - box-sizing: border-box
                                  - padding: 0px
                                name:
                                  - font-size: 1.2rem
                                  - font-weight: bold
                                  - font-style: italic
                          cardupload:
                            card:
                              show_icon: true
                              type: custom:button-card
                              icon: |
                                [[[
                                 if(entity.state == "off")
                                 return ""
                                 if(entity.attributes.in_progress == false)
                                 return 'mdi:upload-circle'
                                 else return 'mdi:rotate-right'
                                ]]]
                              styles:
                                card:
                                  - background: none
                                  - border: none
                                icon:
                                  - animation: |
                                      [[[
                                       if(entity.attributes.in_progress == false)
                                        return '' 
                                       else return 'rotating 1s linear infinite'
                                      ]]]
                                  - color: |
                                      [[[
                                       if(entity.state == 'on' & entity.attributes.in_progress != false)
                                       return 'green'
                                       else return 'rgba(85,252,252, 1)'
                                      ]]]
                                  - left: 18%
                                  - width: 40%
                              tap_action:
                                action: perform-action
                                perform_action: update.install
                                target:
                                  entity_id: '[[[return variables.sensor]]]'
                  exclude:
                    - entity_id: update.hacs_update
                  card_param: cards
                sort:
                  method: friendly_name
              - type: custom:button-card
                show_name: false
                show_icon: false
                show_state: false
                card_mod:
                  style: |
                    ha-card {
                      pointer-events: none;
                    }
                styles:
                  grid:
                    - grid-template-areas: '"card1 card2 card3"'
                    - grid-template-columns: 1fr 0.63fr 0.1fr
                    - grid-template-rows: 1fr
                  card:
                    - padding: 5px 0px 5px 10px
                    - background: rgba(0,0,0,0)
                  custom_fields:
                    card1:
                      - width: 90%
                    card2:
                      - align-self: top
                      - height: 100%
                custom_fields:
                  card1:
                    card:
                      type: custom:mushroom-title-card
                      title: ZigBee2MQTT
                      alignment: start
                      card_mod:
                        style: |
                          .header {
                            padding: 0px !important;
                          }
                          .header div {
                            margin: 0px !important
                          }
                  card2:
                    card:
                      type: markdown
                      content: >-
                        {% set
                        maj=integration_entities('mqtt')|select('search','update.')|select('is_state','on')|list|count|int(2)
                        %}  {% set
                        total=integration_entities('mqtt')|select('search','update.')|list|count|int(2)
                        %}  {% if maj == 0 %} <ha-alert alert-type="success"
                        title="{{maj}} MàJ sur {{total}}" > {% elif maj == 1 %}
                        <ha-alert alert-type="warning" title="{{maj}} Màj sur
                        {{total}}" > {% elif maj > 1 %} <ha-alert
                        alert-type="warning" title="{{maj}} mises a jour sur
                        {{total}}" ></ha-alert> {% else %} {% endif %}
                      card_mod:
                        style: |
                          :host {
                            --ha-card-margin: 0px;
                            --ha-card-background: #00000000 !important;
                            --ha-card-border-color: #00000000 !important;
                            }
                          ha-markdown.no-header {
                            padding: 0px !important;
                            margin: 0px !important;
                            margin-right: 3em !important;
                            margin-left: -3em !important;
                          }
                          ha-card {
                            font-size: 1rem;
                            --mdc-icon-size: 1.3rem;
                           }
              - type: custom:auto-entities
                card:
                  type: vertical-stack
                card_param: cards
                filter:
                  include:
                    - domain: update
                      state: 'on'
                      integration: mqtt
                      options:
                        type: custom:button-card
                        show_name: true
                        show_icon: true
                        show_state: true
                        show_entity_picture: true
                        variables:
                          sensor: |
                            [[[
                              let name = Object.values(entity)
                             return name[0]
                              ]]]
                        name: |
                          [[[
                            return entity.attributes.friendly_name.replace('Home Assistant','HA').replace('Update','')
                          ]]]
                        state_display: >
                          [[[ if(entity.state== "on" &
                          entity.attributes.in_progress == false)
                           return 'v' + entity.attributes.installed_version +' - v' + entity.attributes.latest_version
                          else if(entity.state== "off")
                           return helpers.localize(entity) +' - v'+ entity.attributes.installed_version
                          else
                           return "instal - "+entity.attributes.in_progress+"%"
                          ]]]
                        styles:
                          grid:
                            - grid-template-areas: '"i n n cardupload" "i s s cardupload"'
                            - grid-template-columns: 0.6fr 1fr 1.6fr 1fr;
                            - grid-template-rows: repeat(2, 50%);
                            - gap: 0px 0px;
                          card:
                            - padding: 0px
                            - height: 100%
                            - width: 100%
                          icon:
                            - align-self: center
                            - left: 25%
                            - width: 55%
                          name:
                            - justify-self: start
                            - font-size: 0.9em
                            - font-weight: 450
                            - padding-top: 8px
                          state:
                            - justify-self: start
                            - font-size: 0.75em
                            - padding-bottom: 0.7em
                        custom_fields:
                          cardupload:
                            card:
                              show_icon: true
                              type: custom:button-card
                              icon: |
                                [[[
                                 if(entity.state == "off")
                                 return ""
                                 if(entity.attributes.in_progress == false)
                                 return 'mdi:upload-circle'
                                 else return 'mdi:rotate-right'
                                ]]]
                              styles:
                                card:
                                  - background: none
                                  - border: none
                                icon:
                                  - animation: |
                                      [[[
                                       if(entity.attributes.in_progress == false)
                                        return '' 
                                       else return 'rotating 1s linear infinite'
                                      ]]]
                                  - color: |
                                      [[[
                                       if(entity.state == 'on' & entity.attributes.in_progress != false)
                                       return 'green'
                                       else return 'rgba(85,252,252, 1)' 
                                      ]]]
                                  - left: 17%
                              tap_action:
                                action: perform-action
                                perform_action: update.install
                                target:
                                  entity_id: '[[[return variables.sensor]]]'
                  exclude: []
                  card_param: cards
                sort:
                  method: friendly_name
          - type: heading
            icon: mdi:home-assistant
            heading: H.A. ADD-ON
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: vertical-stack
            cards:
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_core_update
                    show_buttons_control: false
                    icon_type: entity-picture
                    layout: horizontal
                    secondary_info: none
                    name: Home Assistant Core
                    card_mod:
                      style: |
                        ha-card {
                            --card-primary-line-height: 2.5rem;
                            --card-primary-font-size: 1.7rem;
                            --card-primary-font-weight: normal;
                            border: none !important;
                            box-shadow: none !important;
                            background: rgba(0,0,0,0);
                            margin-top: 1rem;
                         }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        icon: mdi:web
                        icon_color: blue
                        content: Release Changelog
                        tap_action:
                          action: url
                          url_path: https://www.home-assistant.io/latest-release-notes/
                      - type: entity
                        entity: sensor.home_assistant_core_cpu_percent
                        icon_color: blue
                      - type: entity
                        entity: sensor.home_assistant_core_memory_percent
                        icon_color: orange
              - type: vertical-stack
                cards:
                  - type: custom:mushroom-update-card
                    entity: update.home_assistant_supervisor_update
                    show_buttons_control: false
                    icon_type: entity-picture
                    layout: horizontal
                    secondary_info: none
                    name: Home Assistant Supervisor
                    card_mod:
                      style: |
                        ha-card {
                            --card-primary-line-height: 2.5rem;
                            --card-primary-font-size: 1.7rem;
                            --card-primary-font-weight: normal;
                            border: none !important;
                            box-shadow: none !important;
                            background: rgba(0,0,0,0);
                            margin-top: 1.2rem;
                         }
                  - type: custom:mushroom-chips-card
                    chips:
                      - type: template
                        icon: mdi:web
                        icon_color: blue
                        content: Release Changelog
                        tap_action:
                          action: url
                          url_path: >-
                            https://github.com/home-assistant/supervisor/releases/latest
                      - type: entity
                        entity: sensor.home_assistant_supervisor_cpu_percent
                        icon_color: blue
                      - type: entity
                        entity: sensor.home_assistant_supervisor_memory_percent
                        icon_color: orange
    cards: []
  - type: sections
    max_columns: 1
    path: air quality
    title: Air Quality
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:virus-outline
            heading: AIR QUALITY
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/0
            layout_options:
              grid_columns: full
              grid_rows: 1
          - type: heading
            icon: mdi:sofa
            heading_style: title
            badges: []
            layout_options:
              grid_columns: full
              grid_rows: 1
            heading: SALON
          - type: gauge
            entity: sensor.qualite_air_salon_ikea_pm25
            min: 0
            needle: true
            segments:
              - from: 0
                color: '#00FF00'
              - from: 3.89
                color: '#1CFF00'
              - from: 7.78
                color: '#38FF00'
              - from: 11.67
                color: '#55FF00'
              - from: 15.56
                color: '#71FF00'
              - from: 19.44
                color: '#8DFF00'
              - from: 23.33
                color: '#AAFF00'
              - from: 27.22
                color: '#C6FF00'
              - from: 31.11
                color: '#E2FF00'
              - from: 35
                color: '#FFFF00'
              - from: 42.22
                color: '#FFF000'
              - from: 49.44
                color: '#FFE200'
              - from: 56.67
                color: '#FFD400'
              - from: 63.89
                color: '#FFC600'
              - from: 71.11
                color: '#FFB800'
              - from: 78.33
                color: '#FFAA00'
              - from: 85.56
                color: '#FF9C00'
              - from: 92.78
                color: '#FF8E00'
              - from: 100
                color: '#FF8000'
              - from: 102.22
                color: '#FF7100'
              - from: 104.44
                color: '#FF6300'
              - from: 106.67
                color: '#FF5500'
              - from: 108.89
                color: '#FF4700'
              - from: 111.11
                color: '#FF3800'
              - from: 113.33
                color: '#FF2A00'
              - from: 115.56
                color: '#FF1C00'
              - from: 117.78
                color: '#FF0E00'
              - from: 120
                color: '#FF0000'
            max: 150
            name: PM2.5 du Salon
            tap_action:
              action: navigate
              navigation_path: '#pm25'
            grid_options:
              columns: 6
              rows: auto
            severity:
              green: 0
              yellow: 0
              red: 0
            card_mod:
              style:
                ha-gauge:
                  $:
                    svg.text: |
                      text.value-text {
                        font-size: 30px;
                        fill: white;
                      }
                  .: |
                    svg > .needle {
                      fill: black !important;
                    }
                .: |
                  ha-card div.name {
                    font-size: 15px;
                    color: white
                  }
                  ha-card {
                    background: transparent;
                    border: transparent;
                  }
          - type: gauge
            entity: sensor.qualite_air_salon_ikea_voc_index
            unit: ppb
            min: 0
            needle: true
            segments:
              - from: 0
                color: '#00C800'
              - from: 27.78
                color: '#00CE01'
              - from: 55.56
                color: '#00D402'
              - from: 83.33
                color: '#00DA03'
              - from: 111.11
                color: '#00E004'
              - from: 138.89
                color: '#00E605'
              - from: 166.67
                color: '#00EC06'
              - from: 194.44
                color: '#00F207'
              - from: 222.22
                color: '#00F808'
              - from: 250
                color: '#00FF09'
              - from: 275
                color: '#19FF08'
              - from: 300
                color: '#33FF07'
              - from: 325
                color: '#4CFF06'
              - from: 350
                color: '#66FF05'
              - from: 375
                color: '#7FFF04'
              - from: 400
                color: '#99FF03'
              - from: 425
                color: '#B2FF02'
              - from: 450
                color: '#CCFF01'
              - from: 475
                color: '#E5FF00'
              - from: 500
                color: '#FFFF00'
              - from: 550
                color: '#FFF200'
              - from: 600
                color: '#FFE500'
              - from: 650
                color: '#FFD800'
              - from: 700
                color: '#FFCC00'
              - from: 750
                color: '#FFBF00'
              - from: 800
                color: '#FFB200'
              - from: 850
                color: '#FFA600'
              - from: 900
                color: '#FF9900'
              - from: 950
                color: '#FF8C00'
              - from: 1000
                color: '#FF8000'
              - from: 1050
                color: '#FF7900'
              - from: 1100
                color: '#FF7300'
              - from: 1150
                color: '#FF6C00'
              - from: 1200
                color: '#FF6600'
              - from: 1250
                color: '#FF6000'
              - from: 1300
                color: '#FF5900'
              - from: 1350
                color: '#FF5300'
              - from: 1400
                color: '#FF4C00'
              - from: 1450
                color: '#FF4600'
              - from: 1500
                color: '#FF4000'
              - from: 1550
                color: '#FF3900'
              - from: 1600
                color: '#FF3300'
              - from: 1650
                color: '#FF2C00'
              - from: 1700
                color: '#FF2600'
              - from: 1750
                color: '#FF2000'
              - from: 1800
                color: '#FF1900'
              - from: 1850
                color: '#FF1300'
              - from: 1900
                color: '#FF0C00'
              - from: 1950
                color: '#FF0600'
              - from: 2000
                color: '#FF0000'
            max: 2000
            name: tCOV index Salon
            tap_action:
              action: navigate
              navigation_path: '#cov'
            card_mod:
              style:
                ha-gauge:
                  $:
                    svg.text: |
                      text.value-text {
                        font-size: 30px;
                        fill: white;
                      }
                  .: |
                    svg > .needle {
                      fill: black !important;
                    }
                .: |
                  ha-card div.name {
                    font-size: 15px;
                    color: white
                  }
                  ha-card {
                    background: transparent;
                    border: transparent;
                  }
            grid_options:
              columns: 6
              rows: auto
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#pm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality SALON
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: pm25
                variables:
                  entity_sensor: sensor.qualite_air_salon_ikea_pm25
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#cov'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality SALON
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: cov
                variables:
                  entity_sensor: sensor.qualite_air_salon_ikea_voc_index
          - type: heading
            icon: mdi:desktop-tower-monitor
            heading_style: title
            badges: []
            heading: BUREAU
          - type: gauge
            entity: sensor.qualite_air_bureau_ikea_pm25
            min: 0
            needle: true
            segments:
              - from: 0
                color: '#00FF00'
              - from: 3.89
                color: '#1CFF00'
              - from: 7.78
                color: '#38FF00'
              - from: 11.67
                color: '#55FF00'
              - from: 15.56
                color: '#71FF00'
              - from: 19.44
                color: '#8DFF00'
              - from: 23.33
                color: '#AAFF00'
              - from: 27.22
                color: '#C6FF00'
              - from: 31.11
                color: '#E2FF00'
              - from: 35
                color: '#FFFF00'
              - from: 42.22
                color: '#FFF000'
              - from: 49.44
                color: '#FFE200'
              - from: 56.67
                color: '#FFD400'
              - from: 63.89
                color: '#FFC600'
              - from: 71.11
                color: '#FFB800'
              - from: 78.33
                color: '#FFAA00'
              - from: 85.56
                color: '#FF9C00'
              - from: 92.78
                color: '#FF8E00'
              - from: 100
                color: '#FF8000'
              - from: 102.22
                color: '#FF7100'
              - from: 104.44
                color: '#FF6300'
              - from: 106.67
                color: '#FF5500'
              - from: 108.89
                color: '#FF4700'
              - from: 111.11
                color: '#FF3800'
              - from: 113.33
                color: '#FF2A00'
              - from: 115.56
                color: '#FF1C00'
              - from: 117.78
                color: '#FF0E00'
              - from: 120
                color: '#FF0000'
            max: 150
            name: PM2.5 du Bureau
            tap_action:
              action: navigate
              navigation_path: '#bpm25'
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style:
                ha-gauge:
                  $:
                    svg.text: |
                      text.value-text {
                        font-size: 30px;
                        fill: white;
                      }
                  .: |
                    svg > .needle {
                      fill: black !important;
                    }
                .: |
                  ha-card div.name {
                    font-size: 15px;
                    color: white
                  }
                  ha-card {
                    background: transparent;
                    border: transparent;
                  }
          - type: gauge
            entity: sensor.qualite_air_bureau_ikea_voc_index
            unit: ppb
            min: 0
            needle: true
            segments:
              - from: 0
                color: '#00C800'
              - from: 27.78
                color: '#00CE01'
              - from: 55.56
                color: '#00D402'
              - from: 83.33
                color: '#00DA03'
              - from: 111.11
                color: '#00E004'
              - from: 138.89
                color: '#00E605'
              - from: 166.67
                color: '#00EC06'
              - from: 194.44
                color: '#00F207'
              - from: 222.22
                color: '#00F808'
              - from: 250
                color: '#00FF09'
              - from: 275
                color: '#19FF08'
              - from: 300
                color: '#33FF07'
              - from: 325
                color: '#4CFF06'
              - from: 350
                color: '#66FF05'
              - from: 375
                color: '#7FFF04'
              - from: 400
                color: '#99FF03'
              - from: 425
                color: '#B2FF02'
              - from: 450
                color: '#CCFF01'
              - from: 475
                color: '#E5FF00'
              - from: 500
                color: '#FFFF00'
              - from: 550
                color: '#FFF200'
              - from: 600
                color: '#FFE500'
              - from: 650
                color: '#FFD800'
              - from: 700
                color: '#FFCC00'
              - from: 750
                color: '#FFBF00'
              - from: 800
                color: '#FFB200'
              - from: 850
                color: '#FFA600'
              - from: 900
                color: '#FF9900'
              - from: 950
                color: '#FF8C00'
              - from: 1000
                color: '#FF8000'
              - from: 1050
                color: '#FF7900'
              - from: 1100
                color: '#FF7300'
              - from: 1150
                color: '#FF6C00'
              - from: 1200
                color: '#FF6600'
              - from: 1250
                color: '#FF6000'
              - from: 1300
                color: '#FF5900'
              - from: 1350
                color: '#FF5300'
              - from: 1400
                color: '#FF4C00'
              - from: 1450
                color: '#FF4600'
              - from: 1500
                color: '#FF4000'
              - from: 1550
                color: '#FF3900'
              - from: 1600
                color: '#FF3300'
              - from: 1650
                color: '#FF2C00'
              - from: 1700
                color: '#FF2600'
              - from: 1750
                color: '#FF2000'
              - from: 1800
                color: '#FF1900'
              - from: 1850
                color: '#FF1300'
              - from: 1900
                color: '#FF0C00'
              - from: 1950
                color: '#FF0600'
              - from: 2000
                color: '#FF0000'
            max: 2000
            name: tCOV index Bureau
            tap_action:
              action: navigate
              navigation_path: '#bcov'
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style:
                ha-gauge:
                  $:
                    svg.text: |
                      text.value-text {
                        font-size: 30px;
                        fill: white;
                      }
                  .: |
                    svg > .needle {
                      fill: black !important;
                    }
                .: |
                  ha-card div.name {
                    font-size: 15px;
                    color: white
                  }
                  ha-card {
                    background: transparent;
                    border: transparent;
                  }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bpm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality BUREAU
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: pm25
                variables:
                  entity_sensor: sensor.qualite_air_bureau_ikea_pm25
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#bcov'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality BUREAU
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: cov
                variables:
                  entity_sensor: sensor.qualite_air_bureau_ikea_voc_index
          - type: heading
            icon: mdi:bed
            heading_style: title
            badges: []
            heading: CHAMBRE
          - type: gauge
            entity: sensor.qualite_air_chambre_ikea_pm25
            min: 0
            needle: true
            segments:
              - from: 0
                color: '#00FF00'
              - from: 3.89
                color: '#1CFF00'
              - from: 7.78
                color: '#38FF00'
              - from: 11.67
                color: '#55FF00'
              - from: 15.56
                color: '#71FF00'
              - from: 19.44
                color: '#8DFF00'
              - from: 23.33
                color: '#AAFF00'
              - from: 27.22
                color: '#C6FF00'
              - from: 31.11
                color: '#E2FF00'
              - from: 35
                color: '#FFFF00'
              - from: 42.22
                color: '#FFF000'
              - from: 49.44
                color: '#FFE200'
              - from: 56.67
                color: '#FFD400'
              - from: 63.89
                color: '#FFC600'
              - from: 71.11
                color: '#FFB800'
              - from: 78.33
                color: '#FFAA00'
              - from: 85.56
                color: '#FF9C00'
              - from: 92.78
                color: '#FF8E00'
              - from: 100
                color: '#FF8000'
              - from: 102.22
                color: '#FF7100'
              - from: 104.44
                color: '#FF6300'
              - from: 106.67
                color: '#FF5500'
              - from: 108.89
                color: '#FF4700'
              - from: 111.11
                color: '#FF3800'
              - from: 113.33
                color: '#FF2A00'
              - from: 115.56
                color: '#FF1C00'
              - from: 117.78
                color: '#FF0E00'
              - from: 120
                color: '#FF0000'
            max: 150
            name: PM2.5 de la Chambre
            tap_action:
              action: navigate
              navigation_path: '#cpm25'
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style:
                ha-gauge:
                  $:
                    svg.text: |
                      text.value-text {
                        font-size: 30px;
                        fill: white;
                      }
                  .: |
                    svg > .needle {
                      fill: black !important;
                    }
                .: |
                  ha-card div.name {
                    font-size: 15px;
                    color: white
                  }
                  ha-card {
                    background: transparent;
                    border: transparent;
                  }
          - type: gauge
            entity: sensor.qualite_air_chambre_ikea_voc_index
            unit: ppb
            min: 0
            needle: true
            segments:
              - from: 0
                color: '#00C800'
              - from: 27.78
                color: '#00CE01'
              - from: 55.56
                color: '#00D402'
              - from: 83.33
                color: '#00DA03'
              - from: 111.11
                color: '#00E004'
              - from: 138.89
                color: '#00E605'
              - from: 166.67
                color: '#00EC06'
              - from: 194.44
                color: '#00F207'
              - from: 222.22
                color: '#00F808'
              - from: 250
                color: '#00FF09'
              - from: 275
                color: '#19FF08'
              - from: 300
                color: '#33FF07'
              - from: 325
                color: '#4CFF06'
              - from: 350
                color: '#66FF05'
              - from: 375
                color: '#7FFF04'
              - from: 400
                color: '#99FF03'
              - from: 425
                color: '#B2FF02'
              - from: 450
                color: '#CCFF01'
              - from: 475
                color: '#E5FF00'
              - from: 500
                color: '#FFFF00'
              - from: 550
                color: '#FFF200'
              - from: 600
                color: '#FFE500'
              - from: 650
                color: '#FFD800'
              - from: 700
                color: '#FFCC00'
              - from: 750
                color: '#FFBF00'
              - from: 800
                color: '#FFB200'
              - from: 850
                color: '#FFA600'
              - from: 900
                color: '#FF9900'
              - from: 950
                color: '#FF8C00'
              - from: 1000
                color: '#FF8000'
              - from: 1050
                color: '#FF7900'
              - from: 1100
                color: '#FF7300'
              - from: 1150
                color: '#FF6C00'
              - from: 1200
                color: '#FF6600'
              - from: 1250
                color: '#FF6000'
              - from: 1300
                color: '#FF5900'
              - from: 1350
                color: '#FF5300'
              - from: 1400
                color: '#FF4C00'
              - from: 1450
                color: '#FF4600'
              - from: 1500
                color: '#FF4000'
              - from: 1550
                color: '#FF3900'
              - from: 1600
                color: '#FF3300'
              - from: 1650
                color: '#FF2C00'
              - from: 1700
                color: '#FF2600'
              - from: 1750
                color: '#FF2000'
              - from: 1800
                color: '#FF1900'
              - from: 1850
                color: '#FF1300'
              - from: 1900
                color: '#FF0C00'
              - from: 1950
                color: '#FF0600'
              - from: 2000
                color: '#FF0000'
            max: 2000
            name: tCOV index Chambre
            tap_action:
              action: navigate
              navigation_path: '#ccov'
            grid_options:
              columns: 6
              rows: auto
            card_mod:
              style:
                ha-gauge:
                  $:
                    svg.text: |
                      text.value-text {
                        font-size: 30px;
                        fill: white;
                      }
                  .: |
                    svg > .needle {
                      fill: black !important;
                    }
                .: |
                  ha-card div.name {
                    font-size: 15px;
                    color: white
                  }
                  ha-card {
                    background: transparent;
                    border: transparent;
                  }
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#cpm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality CHAMBRE
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: pm25
                variables:
                  entity_sensor: sensor.qualite_air_chambre_ikea_pm25
          - type: vertical-stack
            cards:
              - type: custom:bubble-card
                card_type: pop-up
                hash: '#cpm25'
                show_header: true
                force_icon: false
                show_state: false
                show_last_changed: false
                show_attribute: false
                button_type: name
                name: Air Quality CHAMBRE
                icon: mdi:virus-outline
                show_icon: true
                show_name: true
                card_layout: normal
                hide_backdrop: false
                close_on_click: false
                bg_opacity: '0'
              - type: custom:streamline-card
                template: cov
                variables:
                  entity_sensor: sensor.qualite_air_chambre_ikea_voc_index
    cards: []
  - type: sections
    max_columns: 1
    title: POLLEN - POLLUTION
    path: pollen pollution
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:decagram
            heading: POLLENS - POLUTION
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: POLLENS [ Atmo France - Vence ]
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: false
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-box-shadow: none !important;
                      --ha-card-border-color: transparent !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
                card:
                  type: horizontal-stack
                  cards:
                    - type: custom:button-card
                      entity: sensor.qualite_globale_pollen_vence
                      name: Risque sur Vence
                      icon: mdi:alert-decagram-outline
                      layout: icon_name_state
                      color_type: icon
                      show_name: true
                      show_state: false
                      state:
                        - value: nul
                          operator: '=='
                          color: grey
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: grey
                        - value: 1
                          operator: '=='
                          color: green
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: green
                        - value: 2
                          operator: '=='
                          color: lightgreen
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: lightgreen
                        - value: 3
                          operator: '=='
                          color: yellow
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: yellow
                        - value: 4
                          operator: '=='
                          color: orange
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: orange
                        - value: 5
                          operator: '=='
                          color: red
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: red
                        - value: 6
                          operator: '=='
                          color: darkred
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: darkred
                        - value: 7
                          operator: '=='
                          color: purple
                          icon: mdi:flower-pollen
                          styles:
                            state:
                              - color: purple
                      size: 50%
                      styles:
                        card:
                          - font-weight: bold
                          - '--mdc-ripple-color': rgb(68, 115, 158)
                          - '--mdc-ripple-press-opacity': 0.5
                        name:
                          - font-size: 15px
                        state:
                          - font-weight: bold
                          - font-size: 15px
                    - type: custom:bar-card
                      entities:
                        - entity: sensor.qualite_globale_pollen_vence
                          name: Niveau
                          icon: mdi:alert-circle
                          height: 32px
                          color: red
                          min: 0
                          max: 7
                          positions:
                            indicator: 'off'
                            icon: 'off'
                          severity:
                            - color: grey
                              from: 0
                              to: 0
                            - color: green
                              from: 1
                              to: 1
                            - color: lightgreen
                              from: 2
                              to: 2
                            - color: yellow
                              from: 3
                              to: 3
                            - color: orange
                              from: 4
                              to: 4
                            - color: red
                              from: 5
                              to: 5
                            - color: darkred
                              from: 6
                              to: 6
                            - color: purple
                              from: 7
                              to: 7
                      card_mod:
                        style: |
                          bar-card-currentbar,
                          bar-card-backgroundbar {
                            border-radius: 10px;
                          }
                          bar-card-contentbar > bar-card-name {
                            margin-left: 10px;
                            font-size: 15px;
                            font-weight: bold;
                            color: black;
                          }
                          bar-card-value {
                            margin-right: 10px;
                            font-weight: bold;
                            font-size: 15px;
                            color: white;
                          }
              - type: conditional
                conditions:
                  - entity: sensor.qualite_globale_pollen_vence
                    state_not: nul
                card:
                  type: custom:mod-card
                  card_mod:
                    style: |
                      ha-card {
                        margin: 7px 1px 5px 2px;
                      }
                  card:
                    type: custom:auto-entities
                    card:
                      type: grid
                      columns: 3
                      square: false
                    card_param: cards
                    filter:
                      include:
                        - entity_id: sensor.niveau_*_vence
                          options:
                            type: custom:button-card
                            color_type: icon
                            aspect_ratio: 1.4/1
                            show_name: true
                            show_state: false
                            show_label: true
                            name: |
                              [[[
                                var concentrationEntity = `sensor.concentration_${entity.entity_id.split('_')[1]}_vence`;
                                var friendlyName = states[concentrationEntity].attributes.friendly_name;
                                var name = friendlyName.replace("Concentration ", "").replace("-Vence", "");
                                var concentrationState = states[concentrationEntity].state;
                                return `${name} (${concentrationState} µg/m³)`;
                              ]]]
                            label: |
                              [[[
                                var level = entity.state;
                                var levelText = "";
                                if (level == "1") {
                                  levelText = "Très faible";
                                } else if (level == "2") {
                                  levelText = "Faible";
                                } else if (level == "3") {
                                  levelText = "Modéré";
                                } else if (level == "4") {
                                  levelText = "Élevé";
                                } else if (level == "5") {
                                  levelText = "Très élevé";
                                } else if (level == "6") {
                                  levelText = "Extrêmement élevé";
                                }
                                return levelText;
                              ]]]
                            icon: |
                              [[[
                                var concentrationEntity = `sensor.concentration_${entity.entity_id.split('_')[1]}_vence`;
                                return states[concentrationEntity].attributes.icon;
                              ]]]
                            styles:
                              card:
                                - '--mdc-ripple-color': rgb(68, 115, 158)
                                - '--mdc-ripple-press-opacity': 0.5
                                - border-radius: 10px
                              name:
                                - font-size: 12px
                                - font-weight: bold
                              label:
                                - font-size: 16px
                                - font-weight: bold
                              state:
                                - font-weight: bold
                                - font-size: 15px
                            state:
                              - value: 0
                                operator: '=='
                                color: grey
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px grey
                                  name:
                                    - color: grey
                                  label:
                                    - color: grey
                              - value: 1
                                operator: '=='
                                color: green
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px green
                                  label:
                                    - color: green
                              - value: 2
                                operator: '=='
                                color: lightgreen
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px lightgreen
                                  label:
                                    - color: lightgreen
                              - value: 3
                                operator: '=='
                                color: yellow
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px yellow
                                  label:
                                    - color: yellow
                              - value: 4
                                operator: '=='
                                color: orange
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px orange
                                  label:
                                    - color: orange
                              - value: 5
                                operator: '=='
                                color: red
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px red
                                  label:
                                    - color: red
                              - value: 6
                                operator: '=='
                                color: darkred
                                styles:
                                  card:
                                    - box-shadow: 0px 0px 0px 2px darkred
                                  label:
                                    - color: darkred
                            size: 50%
                            card_mod:
                              style: |
                                ha-card {
                                  background: none !important;
                                }
                    sort:
                      method: state
                      reverse: true
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: true
              margin: false
              border_radius: false
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: QUALITE DE L'AIR [ Atmo France - Vence ]
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-box-shadow: none !important;
                      --ha-card-border-color: transparent !important;
                      --card-background-color: none !important;
                    }
                card:
                  type: horizontal-stack
                  cards:
                    - type: custom:button-card
                      entity: sensor.qualite_globale_vence
                      name: Risque sur Vence
                      icon: mdi:face-mask
                      layout: icon_name_state
                      color_type: icon
                      show_name: true
                      show_state: false
                      show_label: true
                      state:
                        - value: null
                          operator: '=='
                          color: grey
                          styles:
                            state:
                              - color: grey
                        - value: 1
                          operator: '=='
                          color: green
                          styles:
                            state:
                              - color: green
                        - value: 2
                          operator: '=='
                          color: lightgreen
                          styles:
                            state:
                              - color: lightgreen
                        - value: 3
                          operator: '=='
                          color: gold
                          styles:
                            state:
                              - color: gold
                        - value: 4
                          operator: '=='
                          color: orange
                          styles:
                            state:
                              - color: orange
                        - value: 5
                          operator: '=='
                          color: red
                          styles:
                            state:
                              - color: red
                        - value: 6
                          operator: '=='
                          color: darkred
                          styles:
                            state:
                              - color: darkred
                        - value: 7
                          operator: '=='
                          color: purple
                          styles:
                            state:
                              - color: purple
                      size: 60%
                      styles:
                        card:
                          - '--mdc-ripple-color': rgb(68, 115, 158)
                          - '--mdc-ripple-press-opacity': 0.5
                        name:
                          - font-size: 15px
                          - font-weight: bold
                        state:
                          - font-size: 15px
                          - font-weight: bold
                    - type: custom:bar-card
                      entities:
                        - entity: sensor.qualite_globale_vence
                          name: Niveau
                          icon: mdi:alert-circle
                          height: 32px
                          color: red
                          min: 0
                          max: 7
                          positions:
                            indicator: 'off'
                            icon: 'off'
                          severity:
                            - color: grey
                              from: 0
                              to: 0
                            - color: green
                              from: 1
                              to: 1
                            - color: lightgreen
                              from: 2
                              to: 2
                            - color: gold
                              from: 3
                              to: 3
                            - color: orange
                              from: 4
                              to: 4
                            - color: red
                              from: 5
                              to: 5
                            - color: darkred
                              from: 6
                              to: 6
                            - color: purple
                              from: 7
                              to: 7
                      card_mod:
                        style: |
                          bar-card-currentbar, bar-card-backgroundbar {
                            border-radius: 10px;
                          }
                          bar-card-contentbar > bar-card-name {
                            margin-left: 10px;
                            font-size: 15px;
                            font-weight: bold;
                            color: white;
                          }
                          bar-card-value {
                            margin-right: 10px;
                            font-weight: bold;
                            font-size: 15px;
                            color: white;
                          }
              - type: vertical-stack
                cards:
                  - type: custom:mod-card
                    card_mod: null
                    style: |
                      ha-card {
                        margin: 7px 2px 5px 2px;
                      }
                    card:
                      type: grid
                      columns: 5
                      square: false
                      cards:
                        - type: custom:button-card
                          entity: sensor.dioxyde_d_azote_vence
                          color_type: icon
                          name: NO2
                          aspect_ratio: 1/1
                          show_state: true
                          show_icon: true
                          icon: mdi:molecule
                          size: 50%
                          styles:
                            icon:
                              - top: 0%
                            name:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 90%
                              - font-weight: bold
                            state:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 120%
                              - font-weight: bold
                          state:
                            - value: 1
                              operator: '=='
                              color: green
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px green
                                state:
                                  - color: green
                            - value: 2
                              operator: '=='
                              color: lightgreen
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px lightgreen
                                state:
                                  - color: lightgreen
                            - value: 3
                              operator: '=='
                              color: gold
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px gold
                                state:
                                  - color: gold
                            - value: 4
                              operator: '=='
                              color: orange
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px orange
                                state:
                                  - color: orange
                            - value: 5
                              operator: '=='
                              color: red
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px red
                                state:
                                  - color: red
                            - value: 6
                              operator: '=='
                              color: darkred
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px darkred
                                state:
                                  - color: darkred
                            - value: 7
                              operator: '=='
                              color: purple
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px purple
                                state:
                                  - color: purple
                          card_mod:
                            style: |
                              ha-card {
                                background: none !important;
                              }
                        - type: custom:button-card
                          entity: sensor.dioxyde_de_soufre_vence
                          color_type: icon
                          name: SO2
                          aspect_ratio: 1/1
                          show_state: true
                          show_icon: true
                          icon: mdi:molecule
                          size: 60%
                          styles:
                            icon:
                              - top: 0%
                            name:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 90%
                              - font-weight: bold
                            state:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 120%
                              - font-weight: bold
                          state:
                            - value: 1
                              operator: '=='
                              color: green
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px green
                                state:
                                  - color: green
                            - value: 2
                              operator: '=='
                              color: lightgreen
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px lightgreen
                                state:
                                  - color: lightgreen
                            - value: 3
                              operator: '=='
                              color: gold
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px gold
                                state:
                                  - color: gold
                            - value: 4
                              operator: '=='
                              color: orange
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px orange
                                state:
                                  - color: orange
                            - value: 5
                              operator: '=='
                              color: red
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px red
                                state:
                                  - color: red
                            - value: 6
                              operator: '=='
                              color: darkred
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px darkred
                                state:
                                  - color: darkred
                            - value: 7
                              operator: '=='
                              color: purple
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px purple
                                state:
                                  - color: purple
                          card_mod:
                            style: |
                              ha-card {
                                background: none !important;
                              }
                        - type: custom:button-card
                          entity: sensor.ozone_vence
                          color_type: icon
                          name: OZONE
                          aspect_ratio: 1/1
                          show_state: true
                          show_icon: true
                          icon: mdi:molecule
                          size: 60%
                          styles:
                            icon:
                              - top: 0%
                            name:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 90%
                              - font-weight: bold
                            state:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 120%
                              - font-weight: bold
                          state:
                            - value: 1
                              operator: '=='
                              color: green
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px green
                                state:
                                  - color: green
                            - value: 2
                              operator: '=='
                              color: lightgreen
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px lightgreen
                                state:
                                  - color: lightgreen
                            - value: 3
                              operator: '=='
                              color: gold
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px gold
                                state:
                                  - color: gold
                            - value: 4
                              operator: '=='
                              color: orange
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px orange
                                state:
                                  - color: orange
                            - value: 5
                              operator: '=='
                              color: red
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px red
                                state:
                                  - color: red
                            - value: 6
                              operator: '=='
                              color: darkred
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px darkred
                                state:
                                  - color: darkred
                            - value: 7
                              operator: '=='
                              color: purple
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px purple
                                state:
                                  - color: purple
                          card_mod:
                            style: |
                              ha-card {
                                background: none !important;
                              }
                        - type: custom:button-card
                          entity: sensor.pm10_vence
                          color_type: icon
                          name: PM10
                          aspect_ratio: 1/1
                          show_state: true
                          show_icon: true
                          icon: mdi:blur
                          size: 60%
                          styles:
                            icon:
                              - top: 0%
                            name:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 90%
                              - font-weight: bold
                            state:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 120%
                              - font-weight: bold
                          state:
                            - value: 1
                              operator: '=='
                              color: green
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px green
                                state:
                                  - color: green
                            - value: 2
                              operator: '=='
                              color: lightgreen
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px lightgreen
                                state:
                                  - color: lightgreen
                            - value: 3
                              operator: '=='
                              color: gold
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px gold
                                state:
                                  - color: gold
                            - value: 4
                              operator: '=='
                              color: orange
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px orange
                                state:
                                  - color: orange
                            - value: 5
                              operator: '=='
                              color: red
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px red
                                state:
                                  - color: red
                            - value: 6
                              operator: '=='
                              color: darkred
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px darkred
                                state:
                                  - color: darkred
                            - value: 7
                              operator: '=='
                              color: purple
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px purple
                                state:
                                  - color: purple
                          card_mod:
                            style: |
                              ha-card {
                                background: none !important;
                              }
                        - type: custom:button-card
                          entity: sensor.pm25_vence
                          color_type: icon
                          name: PM2.5
                          aspect_ratio: 1/1
                          show_state: true
                          show_icon: true
                          icon: mdi:blur
                          size: 60%
                          styles:
                            icon:
                              - top: 0%
                            name:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 90%
                              - font-weight: bold
                            state:
                              - color: white
                              - top: 0%
                              - left: 0%
                              - font-size: 120%
                              - font-weight: bold
                          state:
                            - value: 1
                              operator: '=='
                              color: green
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px green
                                state:
                                  - color: green
                            - value: 2
                              operator: '=='
                              color: lightgreen
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px lightgreen
                                state:
                                  - color: lightgreen
                            - value: 3
                              operator: '=='
                              color: gold
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px gold
                                state:
                                  - color: gold
                            - value: 4
                              operator: '=='
                              color: orange
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px orange
                                state:
                                  - color: orange
                            - value: 5
                              operator: '=='
                              color: red
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px red
                                state:
                                  - color: red
                            - value: 6
                              operator: '=='
                              color: darkred
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px darkred
                                state:
                                  - color: darkred
                            - value: 7
                              operator: '=='
                              color: purple
                              styles:
                                card:
                                  - box-shadow: 0px 0px 0px 2px purple
                                state:
                                  - color: purple
                          card_mod:
                            style: |
                              ha-card {
                                background: none !important;
                              }  
        column_span: 10
    cards: []
    header:
      layout: responsive
      badges_position: bottom
      badges_wrap: wrap
  - type: sections
    max_columns: 1
    title: VIGIEAU / VIGI - EAU
    path: vigieau
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:water
            heading: VIGIEAU / VIGI - EAU
            heading_style: title
            badges: []
            tap_action:
              action: navigate
              navigation_path: /dashboard-tablette/home
            layout_options:
              grid_columns: full
              grid_rows: 1
          - card_mod:
              style: |
                ha-card {
                  border: none !important;
                  box-shadow: none !important;
                  background: none !important;
                  margin: 0;
                  padding: 0;
                }
            type: custom:stack-in-card
            mode: vertical
            keep:
              box_shadow: true
              margin: false
              border_radius: true
              background: false
              outer_padding: false
            cards:
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --text-divider-color: white;
                      --text-divider-line-size: 1px;
                    }
                card:
                  type: custom:text-divider-row
                  text: SÉCHERESSE
              - type: custom:mod-card
                card_mod:
                  style: |
                    :host {
                      --ha-card-border-color: transparent !important;
                      --card-background-color: none !important;
                    }
                    ha-card {
                      margin: 0;
                    }
                card:
                  type: horizontal-stack
                  cards:
                    - type: custom:button-card
                      entity: sensor.alert_level_in_vence
                      name: 'Vigi - Eau Vence:'
                      layout: icon_name_state2nd
                      color_type: icon
                      show_name: true
                      show_state: true
                      state_display: |
                        [[[
                          if (entity.state === "vigilance (pas de restriction)") return "Aucune restriction";
                          if (entity.state === "alerte_renforcee") return "Alerte renforcée";
                          return entity.state;
                        ]]]
                      state:
                        - value: null
                          operator: '=='
                          color: grey
                          icon: mdi:water-off
                          styles:
                            state:
                              - color: grey
                        - value: vigilance (pas de restriction)
                          operator: '=='
                          color: rgb(232, 237, 255)
                          icon: mdi:water-check
                          styles:
                            state:
                              - color: rgb(232, 237, 255)
                        - value: vigilance
                          operator: '=='
                          color: rgb(255, 237, 160)
                          icon: mdi:water-minus
                          styles:
                            state:
                              - color: rgb(255, 237, 160)
                        - value: alerte
                          operator: '=='
                          color: rgb(254, 178, 76)
                          icon: mdi:water-alert
                          styles:
                            state:
                              - color: rgb(254, 178, 76)
                        - value: alerte_renforcee
                          operator: '=='
                          color: rgb(252, 78, 42)
                          icon: mdi:water-remove
                          styles:
                            state:
                              - color: rgb(252, 78, 42)
                        - value: crise
                          operator: '=='
                          color: rgb(177, 0, 38)
                          icon: mdi:water-off
                          styles:
                            state:
                              - color: rgb(177, 0, 38)
                      size: 50%
                      styles:
                        card:
                          - font-weight: bold
                          - '--mdc-ripple-color': rgb(68, 115, 158)
                          - '--mdc-ripple-press-opacity': 0.5
                        name:
                          - font-size: 15px
                        state:
                          - font-weight: bold
                          - font-size: 15px
                    - type: custom:bar-card
                      entities:
                        - entity: sensor.alert_level_in_vence_numeric
                          name: ' '
                          icon: |
                            [[[
                              var iconName = entity.attributes.icon || 'mdi:water-outline';
                              return iconName;
                            ]]]
                          height: 32px
                          color: |
                            [[[
                              var colorName = entity.attributes.Couleur || 'grey';
                              return colorName;
                            ]]]
                          min: 0
                          max: 4
                          target: 3.5
                          animation:
                            state: 'on'
                          positions:
                            indicator: inside
                            icon: inside
                          severity:
                            - color: rgb(232, 237, 255)
                              icon: mdi:water-check
                              from: 0
                              to: 0
                            - color: rgb(255, 237, 160)
                              icon: mdi:water-minus
                              from: 1
                              to: 1
                            - color: rgb(255, 237, 160)
                              icon: mdi:water-alert
                              from: 2
                              to: 2
                            - color: rgb(252, 78, 42)
                              icon: mdi:water-remove
                              from: 3
                              to: 3
                            - color: rgb(254, 178, 76)
                              from: 4
                              to: 4
                      card_mod:
                        style: |
                          bar-card-currentbar,
                          bar-card-backgroundbar {
                            border-radius: 10px;
                          }
                          bar-card-value {
                            margin-right: 25px;
                            font-weight: bold;
                            font-size: 15px;
                            color: white;
                          }
                          ha-icon{
                            color: black !important;
                          }
              - type: conditional
                conditions:
                  - entity: sensor.alert_level_in_vence
                    state_not: nul
                card:
                  type: custom:mod-card
                  card_mod:
                    style: |
                      ha-card {
                        margin: 7px 2px 5px 2px;
                      }
                  card:
                    type: custom:auto-entities
                    card:
                      type: grid
                      columns: 4
                      square: false
                    card_param: cards
                    filter:
                      include:
                        - entity_id: sensor.*_restrictions_vence
                          options:
                            type: custom:button-card
                            color_type: icon
                            aspect_ratio: 1/1
                            show_name: true
                            show_state: true
                            name: |
                              [[[ return entity.attributes.friendly_name; ]]]
                            color: |
                              [[[
                                const state = entity.state;
                                if (state.length > 30) return "rgb(255, 216, 148)";
                                if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                if (state === "Interdiction") return "rgb(252, 78, 42)";
                                if (state === "unknown") return "grey";
                                return "grey";
                              ]]]
                            tap_action:
                              action: fire-dom-event
                              browser_mod:
                                service: browser_mod.popup
                                data:
                                  title: >
                                    [[[ return entity.attributes.friendly_name;
                                    ]]]
                                  style: |
                                    --popup-min-width: 500px;
                                    --popup-max-width: 500px; 
                                  content:
                                    type: custom:button-card
                                    entity: |
                                      [[[ return entity.entity_id; ]]]
                                    show_name: true
                                    show_state: true
                                    show_icon: true
                                    name: >
                                      [[[ return
                                      entity.attributes.friendly_name; ]]]
                                    styles:
                                      card: null
                                      name:
                                        - font-size: 16px
                                      state:
                                        - font-size: 22px
                                        - white-space: normal
                                        - font-weight: bold
                                        - color: |
                                            [[[
                                              const state = entity.state;
                                              if (state.length > 30) return "rgb(255, 216, 148)";
                                              if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                              if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                              if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                              if (state === "Interdiction") return "rgb(252, 78, 42)";
                                              if (state === "unknown") return "grey";
                                              return "grey";
                                            ]]]
                                      icon:
                                        - color: |
                                            [[[
                                              const state = entity.state;
                                              if (state.length > 30) return "rgb(255, 216, 148)";
                                              if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                              if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                              if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                              if (state === "Interdiction") return "rgb(252, 78, 42)";
                                              if (state === "unknown") return "grey";
                                              return "grey";
                                            ]]]
                            styles:
                              card:
                                - '--mdc-ripple-color': rgb(68, 115, 158)
                                - '--mdc-ripple-press-opacity': 0.5
                                - border-radius: 8px
                                - background: transparent
                                - box-shadow: |
                                    [[[
                                      const state = entity.state;
                                      if (state.length > 30) return "0px 0px 0px 2px rgb(255, 216, 148)";
                                      if (state === "Aucune restriction") return "0px 0px 0px 2px rgb(232, 237, 255)";
                                      if (state === "Sensibilisation") return "0px 0px 0px 2px rgb(255, 237, 160)";
                                      if (state === "Interdiction sauf exception") return "0px 0px 0px 2px rgb(254, 178, 76)";
                                      if (state === "Interdiction") return "0px 0px 0px 2px rgb(252, 78, 42)";
                                      if (state === "unknown") return "0px 0px 0px 2px grey";
                                      return "0px 0px 0px 2px grey";
                                    ]]]
                              name:
                                - font-size: 12px
                                - white-space: normal
                              state:
                                - font-weight: bold
                                - font-size: 12px
                                - white-space: normal
                                - color: |
                                    [[[
                                      const state = entity.state;
                                      if (state.length > 30) return "rgb(255, 216, 148)";
                                      if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                      if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                      if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                      if (state === "Interdiction") return "rgb(252, 78, 42)";
                                      if (state === "unknown") return "grey";
                                      return "grey";
                                    ]]]
                              icon:
                                - color: |
                                    [[[
                                      const state = entity.state;
                                      if (state.length > 30) return "rgb(255, 216, 148)";
                                      if (state === "Aucune restriction") return "rgb(232, 237, 255)";
                                      if (state === "Sensibilisation") return "rgb(255, 237, 160)";
                                      if (state === "Interdiction sauf exception") return "rgb(254, 178, 76)";
                                      if (state === "Interdiction") return "rgb(252, 78, 42)";
                                      if (state === "unknown") return "grey";
                                      return "grey";
                                    ]]]
